/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/*!
 * @license
 * Copyright 2019 Alfresco Software, Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/* tslint:disable:no-input-rename  */
import { ContentService } from '@alfresco/adf-core';
import { Directive, EventEmitter, Input, Output } from '@angular/core';
import { ProcessService } from './../services/process.service';
/** @type {?} */
var JSON_FORMAT = 'json';
/** @type {?} */
var PDF_FORMAT = 'pdf';
var ProcessAuditDirective = /** @class */ (function () {
    /**
     *
     * @param translateService
     * @param processListService
     */
    function ProcessAuditDirective(contentService, processListService) {
        this.contentService = contentService;
        this.processListService = processListService;
        /**
         * Name of the file to download (for PDF downloads).
         */
        this.fileName = 'Audit';
        /**
         * Format for the audit information (can be "pdf" or "json").
         */
        this.format = 'pdf';
        /**
         * Enables downloading of the audit file on clicking.
         */
        this.download = true;
        /**
         * Emitted when the decorated element is clicked.
         */
        this.clicked = new EventEmitter();
        /**
         * Emitted when an error occurs.
         */
        this.error = new EventEmitter();
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ProcessAuditDirective.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        if (!this.isValidType()) {
            this.setDefaultFormatType();
        }
    };
    /**
     * @return {?}
     */
    ProcessAuditDirective.prototype.isValidType = /**
     * @return {?}
     */
    function () {
        if (this.format && (this.isJsonFormat() || this.isPdfFormat())) {
            return true;
        }
        return false;
    };
    /**
     * @return {?}
     */
    ProcessAuditDirective.prototype.setDefaultFormatType = /**
     * @return {?}
     */
    function () {
        this.format = PDF_FORMAT;
    };
    /**
     * fetch the audit information in the requested format
     */
    /**
     * fetch the audit information in the requested format
     * @return {?}
     */
    ProcessAuditDirective.prototype.fetchAuditInfo = /**
     * fetch the audit information in the requested format
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.isPdfFormat()) {
            this.processListService.fetchProcessAuditPdfById(this.processId).subscribe((/**
             * @param {?} blob
             * @return {?}
             */
            function (blob) {
                _this.audit = blob;
                if (_this.download) {
                    _this.contentService.downloadBlob(_this.audit, _this.fileName + '.pdf');
                }
                _this.clicked.emit({ format: _this.format, value: _this.audit, fileName: _this.fileName });
            }), (/**
             * @param {?} err
             * @return {?}
             */
            function (err) {
                _this.error.emit(err);
            }));
        }
        else {
            this.processListService.fetchProcessAuditJsonById(this.processId).subscribe((/**
             * @param {?} res
             * @return {?}
             */
            function (res) {
                _this.audit = res;
                _this.clicked.emit({ format: _this.format, value: _this.audit, fileName: _this.fileName });
            }), (/**
             * @param {?} err
             * @return {?}
             */
            function (err) {
                _this.error.emit(err);
            }));
        }
    };
    /**
     * @return {?}
     */
    ProcessAuditDirective.prototype.onClickAudit = /**
     * @return {?}
     */
    function () {
        this.fetchAuditInfo();
    };
    /**
     * @return {?}
     */
    ProcessAuditDirective.prototype.isJsonFormat = /**
     * @return {?}
     */
    function () {
        return this.format === JSON_FORMAT;
    };
    /**
     * @return {?}
     */
    ProcessAuditDirective.prototype.isPdfFormat = /**
     * @return {?}
     */
    function () {
        return this.format === PDF_FORMAT;
    };
    ProcessAuditDirective.decorators = [
        { type: Directive, args: [{
                    selector: 'button[adf-process-audit]',
                    host: {
                        'role': 'button',
                        '(click)': 'onClickAudit()'
                    }
                },] }
    ];
    /** @nocollapse */
    ProcessAuditDirective.ctorParameters = function () { return [
        { type: ContentService },
        { type: ProcessService }
    ]; };
    ProcessAuditDirective.propDecorators = {
        processId: [{ type: Input, args: ['process-id',] }],
        fileName: [{ type: Input }],
        format: [{ type: Input }],
        download: [{ type: Input }],
        clicked: [{ type: Output }],
        error: [{ type: Output }]
    };
    return ProcessAuditDirective;
}());
export { ProcessAuditDirective };
if (false) {
    /**
     * ID of the process.
     * @type {?}
     */
    ProcessAuditDirective.prototype.processId;
    /**
     * Name of the file to download (for PDF downloads).
     * @type {?}
     */
    ProcessAuditDirective.prototype.fileName;
    /**
     * Format for the audit information (can be "pdf" or "json").
     * @type {?}
     */
    ProcessAuditDirective.prototype.format;
    /**
     * Enables downloading of the audit file on clicking.
     * @type {?}
     */
    ProcessAuditDirective.prototype.download;
    /**
     * Emitted when the decorated element is clicked.
     * @type {?}
     */
    ProcessAuditDirective.prototype.clicked;
    /**
     * Emitted when an error occurs.
     * @type {?}
     */
    ProcessAuditDirective.prototype.error;
    /** @type {?} */
    ProcessAuditDirective.prototype.audit;
    /**
     * @type {?}
     * @private
     */
    ProcessAuditDirective.prototype.contentService;
    /**
     * @type {?}
     * @private
     */
    ProcessAuditDirective.prototype.processListService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvY2Vzcy1hdWRpdC5kaXJlY3RpdmUuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AYWxmcmVzY28vYWRmLXByb2Nlc3Mtc2VydmljZXMvIiwic291cmNlcyI6WyJwcm9jZXNzLWxpc3QvY29tcG9uZW50cy9wcm9jZXNzLWF1ZGl0LmRpcmVjdGl2ZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFtQkEsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLG9CQUFvQixDQUFDO0FBQ3BELE9BQU8sRUFBRSxTQUFTLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBYSxNQUFNLEVBQWlCLE1BQU0sZUFBZSxDQUFDO0FBQ2pHLE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSwrQkFBK0IsQ0FBQzs7SUFFekQsV0FBVyxHQUFXLE1BQU07O0lBQzVCLFVBQVUsR0FBVyxLQUFLO0FBRWhDO0lBbUNJOzs7O09BSUc7SUFDSCwrQkFBb0IsY0FBOEIsRUFDOUIsa0JBQWtDO1FBRGxDLG1CQUFjLEdBQWQsY0FBYyxDQUFnQjtRQUM5Qix1QkFBa0IsR0FBbEIsa0JBQWtCLENBQWdCOzs7O1FBMUJ0RCxhQUFRLEdBQVcsT0FBTyxDQUFDOzs7O1FBSTNCLFdBQU0sR0FBVyxLQUFLLENBQUM7Ozs7UUFJdkIsYUFBUSxHQUFZLElBQUksQ0FBQzs7OztRQUl6QixZQUFPLEdBQXNCLElBQUksWUFBWSxFQUFPLENBQUM7Ozs7UUFJckQsVUFBSyxHQUFzQixJQUFJLFlBQVksRUFBTyxDQUFDO0lBV25ELENBQUM7Ozs7O0lBRUQsMkNBQVc7Ozs7SUFBWCxVQUFZLE9BQXNCO1FBQzlCLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFLEVBQUU7WUFDckIsSUFBSSxDQUFDLG9CQUFvQixFQUFFLENBQUM7U0FDL0I7SUFDTCxDQUFDOzs7O0lBRUQsMkNBQVc7OztJQUFYO1FBQ0ksSUFBSSxJQUFJLENBQUMsTUFBTSxJQUFJLENBQUMsSUFBSSxDQUFDLFlBQVksRUFB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aWdodCAyMDE5IEFsZnJlc2NvIFNvZnR3YXJlLCBMdGQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qIHRzbGludDpkaXNhYmxlOm5vLWlucHV0LXJlbmFtZSAgKi9cblxuaW1wb3J0IHsgQ29udGVudFNlcnZpY2UgfSBmcm9tICdAYWxmcmVzY28vYWRmLWNvcmUnO1xuaW1wb3J0IHsgRGlyZWN0aXZlLCBFdmVudEVtaXR0ZXIsIElucHV0LCBPbkNoYW5nZXMsIE91dHB1dCwgU2ltcGxlQ2hhbmdlcyB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgUHJvY2Vzc1NlcnZpY2UgfSBmcm9tICcuLy4uL3NlcnZpY2VzL3Byb2Nlc3Muc2VydmljZSc7XG5cbmNvbnN0IEpTT05fRk9STUFUOiBzdHJpbmcgPSAnanNvbic7XG5jb25zdCBQREZfRk9STUFUOiBzdHJpbmcgPSAncGRmJztcblxuQERpcmVjdGl2ZSh7XG4gICAgc2VsZWN0b3I6ICdidXR0b25bYWRmLXByb2Nlc3MtYXVkaXRdJyxcbiAgICBob3N0OiB7XG4gICAgICAgICdyb2xlJzogJ2J1dHRvbicsXG4gICAgICAgICcoY2xpY2spJzogJ29uQ2xpY2tBdWRpdCgpJ1xuICAgIH1cbn0pXG5leHBvcnQgY2xhc3MgUHJvY2Vzc0F1ZGl0RGlyZWN0aXZlIGltcGxlbWVudHMgT25DaGFuZ2VzIHtcblxuICAgIC8qKiBJRCBvZiB0aGUgcHJvY2Vzcy4gKi9cbiAgICBASW5wdXQoJ3Byb2Nlc3MtaWQnKVxuICAgIHByb2Nlc3NJZDogc3RyaW5nO1xuXG4gICAgLyoqIE5hbWUgb2YgdGhlIGZpbGUgdG8gZG93bmxvYWQgKGZvciBQREYgZG93bmxvYWRzKS4gKi9cbiAgICBASW5wdXQoKVxuICAgIGZpbGVOYW1lOiBzdHJpbmcgPSAnQXVkaXQnO1xuXG4gICAgLyoqIEZvcm1hdCBmb3IgdGhlIGF1ZGl0IGluZm9ybWF0aW9uIChjYW4gYmUgXCJwZGZcIiBvciBcImpzb25cIikuICovXG4gICAgQElucHV0KClcbiAgICBmb3JtYXQ6IHN0cmluZyA9ICdwZGYnO1xuXG4gICAgLyoqIEVuYWJsZXMgZG93bmxvYWRpbmcgb2YgdGhlIGF1ZGl0IGZpbGUgb24gY2xpY2tpbmcuICovXG4gICAgQElucHV0KClcbiAgICBkb3dubG9hZDogYm9vbGVhbiA9IHRydWU7XG5cbiAgICAvKiogRW1pdHRlZCB3aGVuIHRoZSBkZWNvcmF0ZWQgZWxlbWVudCBpcyBjbGlja2VkLiAqL1xuICAgIEBPdXRwdXQoKVxuICAgIGNsaWNrZWQ6IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG5cbiAgICAvKiogRW1pdHRlZCB3aGVuIGFuIGVycm9yIG9jY3Vycy4gKi9cbiAgICBAT3V0cHV0KClcbiAgICBlcnJvcjogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcblxuICAgIHB1YmxpYyBhdWRpdDogYW55O1xuXG4gICAgLyoqXG4gICAgICpcbiAgICAgKiBAcGFyYW0gdHJhbnNsYXRlU2VydmljZVxuICAgICAqIEBwYXJhbSBwcm9jZXNzTGlzdFNlcnZpY2VcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGNvbnRlbnRTZXJ2aWNlOiBDb250ZW50U2VydmljZSxcbiAgICAgICAgICAgICAgICBwcml2YXRlIHByb2Nlc3NMaXN0U2VydmljZTogUHJvY2Vzc1NlcnZpY2UpIHtcbiAgICB9XG5cbiAgICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKTogdm9pZCB7XG4gICAgICAgIGlmICghdGhpcy5pc1ZhbGlkVHlwZSgpKSB7XG4gICAgICAgICAgICB0aGlzLnNldERlZmF1bHRGb3JtYXRUeXBlKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpc1ZhbGlkVHlwZSgpIHtcbiAgICAgICAgaWYgKHRoaXMuZm9ybWF0ICYmICh0aGlzLmlzSnNvbkZvcm1hdCgpIHx8IHRoaXMuaXNQZGZGb3JtYXQoKSkpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBzZXREZWZhdWx0Rm9ybWF0VHlwZSgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5mb3JtYXQgPSBQREZfRk9STUFUO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGZldGNoIHRoZSBhdWRpdCBpbmZvcm1hdGlvbiBpbiB0aGUgcmVxdWVzdGVkIGZvcm1hdFxuICAgICAqL1xuICAgIGZldGNoQXVkaXRJbmZvKCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5pc1BkZkZvcm1hdCgpKSB7XG4gICAgICAgICAgICB0aGlzLnByb2Nlc3NMaXN0U2VydmljZS5mZXRjaFByb2Nlc3NBdWRpdFBkZkJ5SWQodGhpcy5wcm9jZXNzSWQpLnN1YnNjcmliZShcbiAgICAgICAgICAgICAgICAoYmxvYjogQmxvYikgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmF1ZGl0ID0gYmxvYjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZG93bmxvYWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29udGVudFNlcnZpY2UuZG93bmxvYWRCbG9iKHRoaXMuYXVkaXQsIHRoaXMuZmlsZU5hbWUgKyAnLnBkZicpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xpY2tlZC5lbWl0KHsgZm9ybWF0OiB0aGlzLmZvcm1hdCwgdmFsdWU6IHRoaXMuYXVkaXQsIGZpbGVOYW1lOiB0aGlzLmZpbGVOYW1lIH0pO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgKGVycikgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmVycm9yLmVtaXQoZXJyKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucHJvY2Vzc0xpc3RTZXJ2aWNlLmZldGNoUHJvY2Vzc0F1ZGl0SnNvbkJ5SWQodGhpcy5wcm9jZXNzSWQpLnN1YnNjcmliZShcbiAgICAgICAgICAgICAgICAocmVzKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYXVkaXQgPSByZXM7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xpY2tlZC5lbWl0KHsgZm9ybWF0OiB0aGlzLmZvcm1hdCwgdmFsdWU6IHRoaXMuYXVkaXQsIGZpbGVOYW1lOiB0aGlzLmZpbGVOYW1lIH0pO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgKGVycikgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmVycm9yLmVtaXQoZXJyKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG9uQ2xpY2tBdWRpdCgpIHtcbiAgICAgICAgdGhpcy5mZXRjaEF1ZGl0SW5mbygpO1xuICAgIH1cblxuICAgIGlzSnNvbkZvcm1hdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZm9ybWF0ID09PSBKU09OX0ZPUk1BVDtcbiAgICB9XG5cbiAgICBpc1BkZkZvcm1hdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZm9ybWF0ID09PSBQREZfRk9STUFUO1xuICAgIH1cblxufVxuIl19