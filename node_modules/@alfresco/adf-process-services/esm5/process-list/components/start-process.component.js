/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/*!
 * @license
 * Copyright 2019 Alfresco Software, Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
import { Component, EventEmitter, Input, Output, ViewChild, ViewEncapsulation } from '@angular/core';
import { ActivitiContentService, AppConfigService, AppConfigValues } from '@alfresco/adf-core';
import { ProcessDefinitionRepresentation } from './../models/process-definition.model';
import { ProcessService } from './../services/process.service';
import { FormControl, Validators } from '@angular/forms';
import { map } from 'rxjs/operators';
import { MatAutocompleteTrigger } from '@angular/material';
import { StartFormComponent } from '../../form';
var StartProcessInstanceComponent = /** @class */ (function () {
    function StartProcessInstanceComponent(activitiProcess, activitiContentService, appConfig) {
        this.activitiProcess = activitiProcess;
        this.activitiContentService = activitiContentService;
        this.appConfig = appConfig;
        this.MAX_LENGTH = 255;
        /**
         * (optional) Name to assign to the current process.
         */
        this.name = '';
        /**
         * Hide or show the process selection dropdown.
         */
        this.showSelectProcessDropdown = true;
        /**
         * (optional) Parameter to enable selection of process when filtering.
         */
        this.processFilterSelector = true;
        /**
         * Emitted when the process starts.
         */
        this.start = new EventEmitter();
        /**
         * Emitted when the process is canceled.
         */
        this.cancel = new EventEmitter();
        /**
         * Emitted when an error occurs.
         */
        this.error = new EventEmitter();
        this.processDefinitions = [];
        this.selectedProcessDef = new ProcessDefinitionRepresentation();
        this.errorMessageId = '';
        this.maxProcessNameLength = this.MAX_LENGTH;
    }
    /**
     * @return {?}
     */
    StartProcessInstanceComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.processNameInput = new FormControl(this.name, [Validators.required, Validators.maxLength(this.maxProcessNameLength)]);
        this.processDefinitionInput = new FormControl();
        this.loadStartProcess();
        this.processNameInput.valueChanges.subscribe((/**
         * @param {?} name
         * @return {?}
         */
        function (name) { return _this.name = name; }));
        this.filteredProcesses = this.processDefinitionInput.valueChanges
            .pipe(map((/**
         * @param {?} value
         * @return {?}
         */
        function (value) { return _this._filter(value); })));
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    StartProcessInstanceComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        if (changes['values'] && changes['values'].currentValue) {
            this.moveNodeFromCStoPS();
        }
        if (changes['appId'] && changes['appId'].currentValue) {
            this.appId = changes['appId'].currentValue;
        }
        this.loadStartProcess();
    };
    /**
     * @private
     * @param {?} value
     * @return {?}
     */
    StartProcessInstanceComponent.prototype._filter = /**
     * @private
     * @param {?} value
     * @return {?}
     */
    function (value) {
        if (value !== null && value !== undefined) {
            /** @type {?} */
            var filterValue_1 = value.toLowerCase();
            /** @type {?} */
            var filteredProcess = this.processDefinitions.filter((/**
             * @param {?} option
             * @return {?}
             */
            function (option) { return option.name.toLowerCase().includes(filterValue_1); }));
            if (this.processFilterSelector) {
                this.selectedProcessDef = this.getSelectedProcess(filterValue_1);
            }
            return filteredProcess;
        }
    };
    /**
     * @param {?} selectedProcess
     * @return {?}
     */
    StartProcessInstanceComponent.prototype.getSelectedProcess = /**
     * @param {?} selectedProcess
     * @return {?}
     */
    function (selectedProcess) {
        /** @type {?} */
        var processSelected = this.processDefinitions.find((/**
         * @param {?} process
         * @return {?}
         */
        function (process) { return process.name.toLowerCase() === selectedProcess; }));
        if (!processSelected) {
            processSelected = new ProcessDefinitionRepresentation();
        }
        return processSelected;
    };
    /**
     * @return {?}
     */
    StartProcessInstanceComponent.prototype.loadStartProcess = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.resetSelectedProcessDefinition();
        this.resetErrorMessage();
        this.activitiProcess.getProcessDefinitions(this.appId).subscribe((/**
         * @param {?} processDefinitionRepresentations
         * @return {?}
         */
        function (processDefinitionRepresentations) {
            _this.processDefinitions = processDefinitionRepresentations;
            if (!_this.isProcessDefinitionsEmpty()) {
                if (_this.processDefinitions.length === 1) {
                    _this.selectedProcessDef = _this.processDefinitions[0];
                }
                if (_this.processDefinitionName) {
                    /** @type {?} */
                    var selectedProcess = _this.processDefinitions.find((/**
                     * @param {?} currentProcessDefinition
                     * @return {?}
                     */
                    function (currentProcessDefinition) {
                        return currentProcessDefinition.name === _this.processDefinitionName;
                    }));
                    if (selectedProcess) {
                        _this.selectedProcessDef = selectedProcess;
                    }
                }
                _this.processDefinitionInput.setValue(_this.selectedProcessDef.name);
            }
        }), (/**
         * @return {?}
         */
        function () {
            _this.errorMessageId = 'ADF_PROCESS_LIST.START_PROCESS.ERROR.LOAD_PROCESS_DEFS';
        }));
    };
    /**
     * @return {?}
     */
    StartProcessInstanceComponent.prototype.isProcessDefinitionsEmpty = /**
     * @return {?}
     */
    function () {
        return this.processDefinitions.length === 0;
    };
    /**
     * @return {?}
     */
    StartProcessInstanceComponent.prototype.getAlfrescoRepositoryName = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var alfrescoRepositoryName = this.appConfig.get(AppConfigValues.ALFRESCO_REPOSITORY_NAME);
        if (!alfrescoRepositoryName) {
            alfrescoRepositoryName = 'alfresco-1';
        }
        return alfrescoRepositoryName + 'Alfresco';
    };
    /**
     * @return {?}
     */
    StartProcessInstanceComponent.prototype.moveNodeFromCStoPS = /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var accountIdentifier = this.getAlfrescoRepositoryName();
        var _loop_1 = function (key) {
            if (this_1.values.hasOwnProperty(key)) {
                /** @type {?} */
                var currentValue = this_1.values[key];
                if (currentValue.isFile) {
                    this_1.activitiContentService.applyAlfrescoNode(currentValue, null, accountIdentifier).subscribe((/**
                     * @param {?} res
                     * @return {?}
                     */
                    function (res) {
                        _this.values[key] = [res];
                    }));
                }
            }
        };
        var this_1 = this;
        for (var key in this.values) {
            _loop_1(key);
        }
    };
    /**
     * @param {?=} outcome
     * @return {?}
     */
    StartProcessInstanceComponent.prototype.startProcess = /**
     * @param {?=} outcome
     * @return {?}
     */
    function (outcome) {
        var _this = this;
        if (this.selectedProcessDef && this.selectedProcessDef.id && this.name) {
            this.resetErrorMessage();
            /** @type {?} */
            var formValues = this.startForm ? this.startForm.form.values : undefined;
            this.activitiProcess.startProcess(this.selectedProcessDef.id, this.name, outcome, formValues, this.variables).subscribe((/**
             * @param {?} res
             * @return {?}
             */
            function (res) {
                _this.name = '';
                _this.start.emit(res);
            }), (/**
             * @param {?} err
             * @return {?}
             */
            function (err) {
                _this.errorMessageId = 'ADF_PROCESS_LIST.START_PROCESS.ERROR.START';
                _this.error.error(err);
            }));
        }
    };
    /**
     * @return {?}
     */
    StartProcessInstanceComponent.prototype.cancelStartProcess = /**
     * @return {?}
     */
    function () {
        this.cancel.emit();
    };
    /**
     * @return {?}
     */
    StartProcessInstanceComponent.prototype.hasStartForm = /**
     * @return {?}
     */
    function () {
        return this.selectedProcessDef && this.selectedProcessDef.hasStartForm;
    };
    /**
     * @return {?}
     */
    StartProcessInstanceComponent.prototype.isProcessDefinitionEmpty = /**
     * @return {?}
     */
    function () {
        return this.processDefinitions ? (this.processDefinitions.length > 0 || this.errorMessageId) : this.errorMessageId;
    };
    /**
     * @return {?}
     */
    StartProcessInstanceComponent.prototype.isStartFormMissingOrValid = /**
     * @return {?}
     */
    function () {
        if (this.startForm) {
            return this.startForm.form && this.startForm.form.isValid;
        }
        else {
            return true;
        }
    };
    /**
     * @return {?}
     */
    StartProcessInstanceComponent.prototype.validateForm = /**
     * @return {?}
     */
    function () {
        return this.selectedProcessDef && this.selectedProcessDef.id && this.processNameInput.valid && this.isStartFormMissingOrValid();
    };
    /**
     * @private
     * @return {?}
     */
    StartProcessInstanceComponent.prototype.resetSelectedProcessDefinition = /**
     * @private
     * @return {?}
     */
    function () {
        this.selectedProcessDef = new ProcessDefinitionRepresentation();
    };
    /**
     * @private
     * @return {?}
     */
    StartProcessInstanceComponent.prototype.resetErrorMessage = /**
     * @private
     * @return {?}
     */
    function () {
        this.errorMessageId = '';
    };
    /**
     * @return {?}
     */
    StartProcessInstanceComponent.prototype.hasErrorMessage = /**
     * @return {?}
     */
    function () {
        return this.processDefinitions.length === 0 && !this.errorMessageId;
    };
    /**
     * @param {?} outcome
     * @return {?}
     */
    StartProcessInstanceComponent.prototype.onOutcomeClick = /**
     * @param {?} outcome
     * @return {?}
     */
    function (outcome) {
        this.startProcess(outcome);
    };
    /**
     * @return {?}
     */
    StartProcessInstanceComponent.prototype.reset = /**
     * @return {?}
     */
    function () {
        this.resetSelectedProcessDefinition();
        this.name = '';
        if (this.startForm) {
            this.startForm.data = {};
        }
        this.resetErrorMessage();
    };
    /**
     * @return {?}
     */
    StartProcessInstanceComponent.prototype.hasProcessName = /**
     * @return {?}
     */
    function () {
        return this.name ? true : false;
    };
    /**
     * @param {?} process
     * @return {?}
     */
    StartProcessInstanceComponent.prototype.displayFn = /**
     * @param {?} process
     * @return {?}
     */
    function (process) {
        if (process) {
            /** @type {?} */
            var processName = process;
            if (typeof process !== 'string') {
                processName = process.name;
            }
            return processName;
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    StartProcessInstanceComponent.prototype.displayDropdown = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        event.stopPropagation();
        if (!this.inputAutocomplete.panelOpen) {
            this.processDefinitionInput.setValue('');
            this.inputAutocomplete.openPanel();
        }
        else {
            this.inputAutocomplete.closePanel();
        }
    };
    Object.defineProperty(StartProcessInstanceComponent.prototype, "nameController", {
        get: /**
         * @return {?}
         */
        function () {
            return this.processNameInput;
        },
        enumerable: true,
        configurable: true
    });
    StartProcessInstanceComponent.decorators = [
        { type: Component, args: [{
                    selector: 'adf-start-process',
                    template: "<mat-card class=\"adf-start-process\">\n    <mat-card-title>{{'ADF_PROCESS_LIST.START_PROCESS.FORM.TITLE' | translate}}\n    </mat-card-title>\n    <mat-card-content *ngIf=\"isProcessDefinitionEmpty()\">\n        <mat-card-subtitle id=\"error-message\" *ngIf=\"errorMessageId\">\n            {{errorMessageId|translate}}\n        </mat-card-subtitle>\n        <mat-form-field class=\"adf-process-input-container\">\n            <input\n                matInput\n                placeholder=\"{{'ADF_PROCESS_LIST.START_PROCESS.FORM.LABEL.NAME' | translate}}\"\n                [formControl]=\"processNameInput\"\n                id=\"processName\"\n                required/>\n                <mat-error *ngIf=\"nameController.hasError('maxlength')\">\n                    {{ 'ADF_PROCESS_LIST.START_PROCESS.ERROR.MAXIMUM_LENGTH' | translate : { characters : maxProcessNameLength } }}\n                </mat-error>\n        </mat-form-field>\n        <mat-form-field class=\"adf-process-input-container\">\n            <input\n                type=\"text\"\n                placeholder=\"{{'ADF_PROCESS_LIST.START_PROCESS.FORM.LABEL.TYPE'|translate}}\"\n                matInput\n                [formControl]=\"processDefinitionInput\"\n                [matAutocomplete]=\"auto\"\n                id=\"processDefinitionName\"\n                #inputAutocomplete>\n            <div class=\"adf-process-input-autocomplete\">\n                <mat-autocomplete\n                    #auto=\"matAutocomplete\"\n                    id=\"processDefinitionOptions\"\n                    [displayWith]=\"displayFn\">\n                    <mat-option *ngFor=\"let processDef of filteredProcesses | async\" [value]=\"processDef.name\">\n                        {{ processDef.name }}\n                    </mat-option>\n                </mat-autocomplete>\n                <button\n                    id=\"adf-select-process-dropdown\"\n                    *ngIf=\"showSelectProcessDropdown\"\n                    mat-icon-button\n                    (click)=\"displayDropdown($event)\">\n                    <mat-icon>arrow_drop_down</mat-icon>\n                </button>\n            </div>\n        </mat-form-field>\n\n        <adf-start-form\n            #startForm\n            *ngIf=\"hasStartForm()\"\n            [data]=\"values\"\n            [disableStartProcessButton]=\"!hasProcessName()\"\n            [processDefinitionId]=\"selectedProcessDef.id\"\n            (outcomeClick)=\"onOutcomeClick($event)\"\n            [showRefreshButton]=\"false\">\n            <button\n                adf-form-custom-button\n                mat-button\n                (click)=\"cancelStartProcess()\"\n                id=\"cancel_process\">\n                {{'ADF_PROCESS_LIST.START_PROCESS.FORM.ACTION.CANCEL'| translate | uppercase}}\n            </button>\n        </adf-start-form>\n    </mat-card-content>\n    <mat-card-content *ngIf=\"hasErrorMessage()\">\n        <mat-card-subtitle class=\"error-message\" id=\"no-process-message\">\n            {{'ADF_PROCESS_LIST.START_PROCESS.NO_PROCESS_DEFINITIONS' | translate | uppercase}}\n        </mat-card-subtitle>\n    </mat-card-content>\n    <mat-card-actions *ngIf=\"!hasStartForm()\">\n        <button\n            mat-button\n            *ngIf=\"!hasStartForm()\"\n            (click)=\"cancelStartProcess()\"\n            id=\"cancel_process\">\n            {{'ADF_PROCESS_LIST.START_PROCESS.FORM.ACTION.CANCEL'| translate | uppercase}}\n        </button>\n        <button\n            color=\"primary\"\n            mat-button\n            *ngIf=\"!hasStartForm()\"\n            [disabled]=\"!validateForm()\"\n            (click)=\"startProcess()\"\n            data-automation-id=\"btn-start\"\n            id=\"button-start\"\n            class=\"btn-start\">\n            {{'ADF_PROCESS_LIST.START_PROCESS.FORM.ACTION.START' | translate | uppercase}}\n        </button>\n    </mat-card-actions>\n</mat-card>\n",
                    encapsulation: ViewEncapsulation.None,
                    styles: [".adf-start-process{width:66%;margin-left:auto;margin-right:auto;margin-top:10px}.adf-start-process .mat-select-trigger{font-size:14px!important}.adf-start-process mat-form-field{width:100%}.adf-start-process mat-select{width:100%;padding:16px 0 0}.adf-start-process mat-card-actions{text-align:right}.adf-start-process mat-card-actions .mat-button{text-transform:uppercase!important}.adf-process-input-container mat-form-field{width:100%}.adf-process-input-autocomplete{display:flex}.adf-process-input-autocomplete button{position:absolute;right:-14px;top:0}.adf-start-form-container .mat-card{box-shadow:none!important;padding:0!important}.adf-start-form-actions{text-align:right!important}@media (max-width:600px){.adf-start-process{width:90%;margin-left:auto;margin-right:auto}}"]
                }] }
    ];
    /** @nocollapse */
    StartProcessInstanceComponent.ctorParameters = function () { return [
        { type: ProcessService },
        { type: ActivitiContentService },
        { type: AppConfigService }
    ]; };
    StartProcessInstanceComponent.propDecorators = {
        appId: [{ type: Input }],
        processDefinitionName: [{ type: Input }],
        variables: [{ type: Input }],
        values: [{ type: Input }],
        name: [{ type: Input }],
        showSelectProcessDropdown: [{ type: Input }],
        processFilterSelector: [{ type: Input }],
        start: [{ type: Output }],
        cancel: [{ type: Output }],
        error: [{ type: Output }],
        startForm: [{ type: ViewChild, args: ['startForm',] }],
        inputAutocomplete: [{ type: ViewChild, args: [MatAutocompleteTrigger,] }]
    };
    return StartProcessInstanceComponent;
}());
export { StartProcessInstanceComponent };
if (false) {
    /** @type {?} */
    StartProcessInstanceComponent.prototype.MAX_LENGTH;
    /**
     * (optional) Limit the list of processes that can be started to those
     * contained in the specified app.
     * @type {?}
     */
    StartProcessInstanceComponent.prototype.appId;
    /**
     * (optional) Definition name of the process to start.
     * @type {?}
     */
    StartProcessInstanceComponent.prototype.processDefinitionName;
    /**
     * Variables in the input to the process
     * [RestVariable](https://github.com/Alfresco/alfresco-js-api/tree/master/src/alfresco-activiti-rest-api/docs/RestVariable.md).
     * @type {?}
     */
    StartProcessInstanceComponent.prototype.variables;
    /**
     * Parameter to pass form field values in the start form if one is associated.
     * @type {?}
     */
    StartProcessInstanceComponent.prototype.values;
    /**
     * (optional) Name to assign to the current process.
     * @type {?}
     */
    StartProcessInstanceComponent.prototype.name;
    /**
     * Hide or show the process selection dropdown.
     * @type {?}
     */
    StartProcessInstanceComponent.prototype.showSelectProcessDropdown;
    /**
     * (optional) Parameter to enable selection of process when filtering.
     * @type {?}
     */
    StartProcessInstanceComponent.prototype.processFilterSelector;
    /**
     * Emitted when the process starts.
     * @type {?}
     */
    StartProcessInstanceComponent.prototype.start;
    /**
     * Emitted when the process is canceled.
     * @type {?}
     */
    StartProcessInstanceComponent.prototype.cancel;
    /**
     * Emitted when an error occurs.
     * @type {?}
     */
    StartProcessInstanceComponent.prototype.error;
    /** @type {?} */
    StartProcessInstanceComponent.prototype.startForm;
    /** @type {?} */
    StartProcessInstanceComponent.prototype.inputAutocomplete;
    /** @type {?} */
    StartProcessInstanceComponent.prototype.processDefinitions;
    /** @type {?} */
    StartProcessInstanceComponent.prototype.selectedProcessDef;
    /** @type {?} */
    StartProcessInstanceComponent.prototype.errorMessageId;
    /** @type {?} */
    StartProcessInstanceComponent.prototype.processNameInput;
    /** @type {?} */
    StartProcessInstanceComponent.prototype.processDefinitionInput;
    /** @type {?} */
    StartProcessInstanceComponent.prototype.filteredProcesses;
    /** @type {?} */
    StartProcessInstanceComponent.prototype.maxProcessNameLength;
    /**
     * @type {?}
     * @private
     */
    StartProcessInstanceComponent.prototype.activitiProcess;
    /**
     * @type {?}
     * @private
     */
    StartProcessInstanceComponent.prototype.activitiContentService;
    /**
     * @type {?}
     * @private
     */
    StartProcessInstanceComponent.prototype.appConfig;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RhcnQtcHJvY2Vzcy5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AYWxmcmVzY28vYWRmLXByb2Nlc3Mtc2VydmljZXMvIiwic291cmNlcyI6WyJwcm9jZXNzLWxpc3QvY29tcG9uZW50cy9zdGFydC1wcm9jZXNzLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQWlCQSxPQUFPLEVBQ0gsU0FBUyxFQUFFLFlBQVksRUFBRSxLQUFLLEVBQzlCLE1BQU0sRUFBaUIsU0FBUyxFQUFFLGlCQUFpQixFQUN0RCxNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQ0gsc0JBQXNCLEVBQUUsZ0JBQWdCLEVBQUUsZUFBZSxFQUU1RCxNQUFNLG9CQUFvQixDQUFDO0FBRTVCLE9BQU8sRUFBRSwrQkFBK0IsRUFBRSxNQUFNLHNDQUFzQyxDQUFDO0FBRXZGLE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSwrQkFBK0IsQ0FBQztBQUMvRCxPQUFPLEVBQUUsV0FBVyxFQUFFLFVBQVUsRUFBbUIsTUFBTSxnQkFBZ0IsQ0FBQztBQUUxRSxPQUFPLEVBQUUsR0FBRyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDckMsT0FBTyxFQUFFLHNCQUFzQixFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDM0QsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0sWUFBWSxDQUFDO0FBRWhEO0lBb0VJLHVDQUFvQixlQUErQixFQUMvQixzQkFBOEMsRUFDOUMsU0FBMkI7UUFGM0Isb0JBQWUsR0FBZixlQUFlLENBQWdCO1FBQy9CLDJCQUFzQixHQUF0QixzQkFBc0IsQ0FBd0I7UUFDOUMsY0FBUyxHQUFULFNBQVMsQ0FBa0I7UUE5RC9DLGVBQVUsR0FBVyxHQUFHLENBQUM7Ozs7UUF3QnpCLFNBQUksR0FBVyxFQUFFLENBQUM7Ozs7UUFJbEIsOEJBQXlCLEdBQVksSUFBSSxDQUFDOzs7O1FBSTFDLDBCQUFxQixHQUFZLElBQUksQ0FB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OztJQUV0QyxtREFBeUI7Ozs7OztJQUt6Qiw4Q0FDYzs7Ozs7SUFHZCw4REFDOEI7Ozs7OztJQUs5QixrREFDcUM7Ozs7O0lBR3JDLCtDQUNtQjs7Ozs7SUFHbkIsNkNBQ2tCOzs7OztJQUdsQixrRUFDMEM7Ozs7O0lBRzFDLDhEQUNzQzs7Ozs7SUFHdEMsOENBQzJFOzs7OztJQUczRSwrQ0FDNEU7Ozs7O0lBRzVFLDhDQUMyRTs7SUFFM0Usa0RBQzhCOztJQUU5QiwwREFDMEM7O0lBRTFDLDJEQUEyRDs7SUFDM0QsMkRBQTRGOztJQUM1Rix1REFBNEI7O0lBQzVCLHlEQUE4Qjs7SUFDOUIsK0RBQW9DOztJQUNwQywwREFBaUU7O0lBQ2pFLDZEQUErQzs7Ozs7SUFFbkMsd0RBQXVDOzs7OztJQUN2QywrREFBc0Q7Ozs7O0lBQ3RELGtEQUFtQyIsInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEFsZnJlc2NvIFNvZnR3YXJlLCBMdGQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7XG4gICAgQ29tcG9uZW50LCBFdmVudEVtaXR0ZXIsIElucHV0LCBPbkNoYW5nZXMsIE9uSW5pdCxcbiAgICBPdXRwdXQsIFNpbXBsZUNoYW5nZXMsIFZpZXdDaGlsZCwgVmlld0VuY2Fwc3VsYXRpb25cbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge1xuICAgIEFjdGl2aXRpQ29udGVudFNlcnZpY2UsIEFwcENvbmZpZ1NlcnZpY2UsIEFwcENvbmZpZ1ZhbHVlcyxcbiAgICBGb3JtVmFsdWVzXG59IGZyb20gJ0BhbGZyZXNjby9hZGYtY29yZSc7XG5pbXBvcnQgeyBQcm9jZXNzSW5zdGFuY2VWYXJpYWJsZSB9IGZyb20gJy4uL21vZGVscy9wcm9jZXNzLWluc3RhbmNlLXZhcmlhYmxlLm1vZGVsJztcbmltcG9ydCB7IFByb2Nlc3NEZWZpbml0aW9uUmVwcmVzZW50YXRpb24gfSBmcm9tICcuLy4uL21vZGVscy9wcm9jZXNzLWRlZmluaXRpb24ubW9kZWwnO1xuaW1wb3J0IHsgUHJvY2Vzc0luc3RhbmNlIH0gZnJvbSAnLi8uLi9tb2RlbHMvcHJvY2Vzcy1pbnN0YW5jZS5tb2RlbCc7XG5pbXBvcnQgeyBQcm9jZXNzU2VydmljZSB9IGZyb20gJy4vLi4vc2VydmljZXMvcHJvY2Vzcy5zZXJ2aWNlJztcbmltcG9ydCB7IEZvcm1Db250cm9sLCBWYWxpZGF0b3JzLCBBYnN0cmFjdENvbnRyb2wgfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBtYXAgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5pbXBvcnQgeyBNYXRBdXRvY29tcGxldGVUcmlnZ2VyIH0gZnJvbSAnQGFuZ3VsYXIvbWF0ZXJpYWwnO1xuaW1wb3J0IHsgU3RhcnRGb3JtQ29tcG9uZW50IH0gZnJvbSAnLi4vLi4vZm9ybSc7XG5cbkBDb21wb25lbnQoe1xuICAgIHNlbGVjdG9yOiAnYWRmLXN0YXJ0LXByb2Nlc3MnLFxuICAgIHRlbXBsYXRlVXJsOiAnLi9zdGFydC1wcm9jZXNzLmNvbXBvbmVudC5odG1sJyxcbiAgICBzdHlsZVVybHM6IFsnLi9zdGFydC1wcm9jZXNzLmNvbXBvbmVudC5zY3NzJ10sXG4gICAgZW5jYXBzdWxhdGlvbjogVmlld0VuY2Fwc3VsYXRpb24uTm9uZVxufSlcbmV4cG9ydCBjbGFzcyBTdGFydFByb2Nlc3NJbnN0YW5jZUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uQ2hhbmdlcywgT25Jbml0IHtcblxuICAgIE1BWF9MRU5HVEg6IG51bWJlciA9IDI1NTtcblxuICAgIC8qKiAob3B0aW9uYWwpIExpbWl0IHRoZSBsaXN0IG9mIHByb2Nlc3NlcyB0aGF0IGNhbiBiZSBzdGFydGVkIHRvIHRob3NlXG4gICAgICogY29udGFpbmVkIGluIHRoZSBzcGVjaWZpZWQgYXBwLlxuICAgICAqL1xuICAgIEBJbnB1dCgpXG4gICAgYXBwSWQ6IG51bWJlcjtcblxuICAgIC8qKiAob3B0aW9uYWwpIERlZmluaXRpb24gbmFtZSBvZiB0aGUgcHJvY2VzcyB0byBzdGFydC4gKi9cbiAgICBASW5wdXQoKVxuICAgIHByb2Nlc3NEZWZpbml0aW9uTmFtZTogc3RyaW5nO1xuXG4gICAgLyoqIFZhcmlhYmxlcyBpbiB0aGUgaW5wdXQgdG8gdGhlIHByb2Nlc3NcbiAgICAgKiBbUmVzdFZhcmlhYmxlXShodHRwczovL2dpdGh1Yi5jb20vQWxmcmVzY28vYWxmcmVzY28tanMtYXBpL3RyZWUvbWFzdGVyL3NyYy9hbGZyZXNjby1hY3Rpdml0aS1yZXN0LWFwaS9kb2NzL1Jlc3RWYXJpYWJsZS5tZCkuXG4gICAgICovXG4gICAgQElucHV0KClcbiAgICB2YXJpYWJsZXM6IFByb2Nlc3NJbnN0YW5jZVZhcmlhYmxlW107XG5cbiAgICAvKiogUGFyYW1ldGVyIHRvIHBhc3MgZm9ybSBmaWVsZCB2YWx1ZXMgaW4gdGhlIHN0YXJ0IGZvcm0gaWYgb25lIGlzIGFzc29jaWF0ZWQuICovXG4gICAgQElucHV0KClcbiAgICB2YWx1ZXM6IEZvcm1WYWx1ZXM7XG5cbiAgICAvKiogKG9wdGlvbmFsKSBOYW1lIHRvIGFzc2lnbiB0byB0aGUgY3VycmVudCBwcm9jZXNzLiAqL1xuICAgIEBJbnB1dCgpXG4gICAgbmFtZTogc3RyaW5nID0gJyc7XG5cbiAgICAvKiogSGlkZSBvciBzaG93IHRoZSBwcm9jZXNzIHNlbGVjdGlvbiBkcm9wZG93bi4gKi9cbiAgICBASW5wdXQoKVxuICAgIHNob3dTZWxlY3RQcm9jZXNzRHJvcGRvd246IGJvb2xlYW4gPSB0cnVlO1xuXG4gICAgLyoqIChvcHRpb25hbCkgUGFyYW1ldGVyIHRvIGVuYWJsZSBzZWxlY3Rpb24gb2YgcHJvY2VzcyB3aGVuIGZpbHRlcmluZy4gKi9cbiAgICBASW5wdXQoKVxuICAgIHByb2Nlc3NGaWx0ZXJTZWxlY3RvcjogYm9vbGVhbiA9IHRydWU7XG5cbiAgICAvKiogRW1pdHRlZCB3aGVuIHRoZSBwcm9jZXNzIHN0YXJ0cy4gKi9cbiAgICBAT3V0cHV0KClcbiAgICBzdGFydDogRXZlbnRFbWl0dGVyPFByb2Nlc3NJbnN0YW5jZT4gPSBuZXcgRXZlbnRFbWl0dGVyPFByb2Nlc3NJbnN0YW5jZT4oKTtcblxuICAgIC8qKiBFbWl0dGVkIHdoZW4gdGhlIHByb2Nlc3MgaXMgY2FuY2VsZWQuICovXG4gICAgQE91dHB1dCgpXG4gICAgY2FuY2VsOiBFdmVudEVtaXR0ZXI8UHJvY2Vzc0luc3RhbmNlPiA9IG5ldyBFdmVudEVtaXR0ZXI8UHJvY2Vzc0luc3RhbmNlPigpO1xuXG4gICAgLyoqIEVtaXR0ZWQgd2hlbiBhbiBlcnJvciBvY2N1cnMuICovXG4gICAgQE91dHB1dCgpXG4gICAgZXJyb3I6IEV2ZW50RW1pdHRlcjxQcm9jZXNzSW5zdGFuY2U+ID0gbmV3IEV2ZW50RW1pdHRlcjxQcm9jZXNzSW5zdGFuY2U+KCk7XG5cbiAgICBAVmlld0NoaWxkKCdzdGFydEZvcm0nKVxuICAgIHN0YXJ0Rm9ybTogU3RhcnRGb3JtQ29tcG9uZW50O1xuXG4gICAgQFZpZXdDaGlsZChNYXRBdXRvY29tcGxldGVUcmlnZ2VyKVxuICAgIGlucHV0QXV0b2NvbXBsZXRlOiBNYXRBdXRvY29tcGxldGVUcmlnZ2VyO1xuXG4gICAgcHJvY2Vzc0RlZmluaXRpb25zOiBQcm9jZXNzRGVmaW5pdGlvblJlcHJlc2VudGF0aW9uW10gPSBbXTtcbiAgICBzZWxlY3RlZFByb2Nlc3NEZWY6IFByb2Nlc3NEZWZpbml0aW9uUmVwcmVzZW50YXRpb24gPSBuZXcgUHJvY2Vzc0RlZmluaXRpb25SZXByZXNlbnRhdGlvbigpO1xuICAgIGVycm9yTWVzc2FnZUlkOiBzdHJpbmcgPSAnJztcbiAgICBwcm9jZXNzTmFtZUlucHV0OiBGb3JtQ29udHJvbDtcbiAgICBwcm9jZXNzRGVmaW5pdGlvbklucHV0OiBGb3JtQ29udHJvbDtcbiAgICBmaWx0ZXJlZFByb2Nlc3NlczogT2JzZXJ2YWJsZTxQcm9jZXNzRGVmaW5pdGlvblJlcHJlc2VudGF0aW9uW10+O1xuICAgIG1heFByb2Nlc3NOYW1lTGVuZ3RoOiBudW1iZXIgPSB0aGlzLk1BWF9MRU5HVEg7XG5cbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGFjdGl2aXRpUHJvY2VzczogUHJvY2Vzc1NlcnZpY2UsXG4gICAgICAgICAgICAgICAgcHJpdmF0ZSBhY3Rpdml0aUNvbnRlbnRTZXJ2aWNlOiBBY3Rpdml0aUNvbnRlbnRTZXJ2aWNlLFxuICAgICAgICAgICAgICAgIHByaXZhdGUgYXBwQ29uZmlnOiBBcHBDb25maWdTZXJ2aWNlKSB7XG4gICAgICAgIH1cblxuICAgIG5nT25Jbml0KCkge1xuICAgICAgICB0aGlzLnByb2Nlc3NOYW1lSW5wdXQgPSBuZXcgRm9ybUNvbnRyb2wodGhpcy5uYW1lLCBbVmFsaWRhdG9ycy5yZXF1aXJlZCwgVmFsaWRhdG9ycy5tYXhMZW5ndGgodGhpcy5tYXhQcm9jZXNzTmFtZUxlbmd0aCldKTtcbiAgICAgICAgdGhpcy5wcm9jZXNzRGVmaW5pdGlvbklucHV0ID0gbmV3IEZvcm1Db250cm9sKCk7XG5cbiAgICAgICAgdGhpcy5sb2FkU3RhcnRQcm9jZXNzKCk7XG5cbiAgICAgICAgdGhpcy5wcm9jZXNzTmFtZUlucHV0LnZhbHVlQ2hhbmdlcy5zdWJzY3JpYmUoKG5hbWUpID0+IHRoaXMubmFtZSA9IG5hbWUpO1xuICAgICAgICB0aGlzLmZpbHRlcmVkUHJvY2Vzc2VzID0gdGhpcy5wcm9jZXNzRGVmaW5pdGlvbklucHV0LnZhbHVlQ2hhbmdlc1xuICAgICAgICAgICAgLnBpcGUoXG4gICAgICAgICAgICAgICAgbWFwKCh2YWx1ZSkgPT4gdGhpcy5fZmlsdGVyKHZhbHVlKSlcbiAgICAgICAgICAgICk7XG4gICAgfVxuXG4gICAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcykge1xuICAgICAgICBpZiAoY2hhbmdlc1sndmFsdWVzJ10gJiYgY2hhbmdlc1sndmFsdWVzJ10uY3VycmVudFZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLm1vdmVOb2RlRnJvbUNTdG9QUygpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGNoYW5nZXNbJ2FwcElkJ10gJiYgY2hhbmdlc1snYXBwSWQnXS5jdXJyZW50VmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuYXBwSWQgPSBjaGFuZ2VzWydhcHBJZCddLmN1cnJlbnRWYWx1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMubG9hZFN0YXJ0UHJvY2VzcygpO1xuICAgIH1cblxuICAgIHByaXZhdGUgX2ZpbHRlcih2YWx1ZTogc3RyaW5nKTogUHJvY2Vzc0RlZmluaXRpb25SZXByZXNlbnRhdGlvbltdIHtcbiAgICAgICAgaWYgKHZhbHVlICE9PSBudWxsICYmIHZhbHVlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGNvbnN0IGZpbHRlclZhbHVlID0gdmFsdWUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgIGNvbnN0IGZpbHRlcmVkUHJvY2VzcyA9IHRoaXMucHJvY2Vzc0RlZmluaXRpb25zLmZpbHRlcigob3B0aW9uKSA9PiBvcHRpb24ubmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGZpbHRlclZhbHVlKSk7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLnByb2Nlc3NGaWx0ZXJTZWxlY3Rvcikge1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRQcm9jZXNzRGVmID0gdGhpcy5nZXRTZWxlY3RlZFByb2Nlc3MoZmlsdGVyVmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZpbHRlcmVkUHJvY2VzcztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldFNlbGVjdGVkUHJvY2VzcyhzZWxlY3RlZFByb2Nlc3MpIHtcbiAgICAgICAgbGV0IHByb2Nlc3NTZWxlY3RlZCA9IHRoaXMucHJvY2Vzc0RlZmluaXRpb25zLmZpbmQoKHByb2Nlc3MpID0+IHByb2Nlc3MubmFtZS50b0xvd2VyQ2FzZSgpID09PSBzZWxlY3RlZFByb2Nlc3MpO1xuXG4gICAgICAgIGlmICghcHJvY2Vzc1NlbGVjdGVkKSB7XG4gICAgICAgICAgICBwcm9jZXNzU2VsZWN0ZWQgPSBuZXcgUHJvY2Vzc0RlZmluaXRpb25SZXByZXNlbnRhdGlvbigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwcm9jZXNzU2VsZWN0ZWQ7XG4gICAgfVxuXG4gICAgcHVibGljIGxvYWRTdGFydFByb2Nlc3MoKSB7XG4gICAgICAgIHRoaXMucmVzZXRTZWxlY3RlZFByb2Nlc3NEZWZpbml0aW9uKCk7XG4gICAgICAgIHRoaXMucmVzZXRFcnJvck1lc3NhZ2UoKTtcblxuICAgICAgICB0aGlzLmFjdGl2aXRpUHJvY2Vzcy5nZXRQcm9jZXNzRGVmaW5pdGlvbnModGhpcy5hcHBJZCkuc3Vic2NyaWJlKFxuICAgICAgICAgICAgKHByb2Nlc3NEZWZpbml0aW9uUmVwcmVzZW50YXRpb25zOiBQcm9jZXNzRGVmaW5pdGlvblJlcHJlc2VudGF0aW9uW10pID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnByb2Nlc3NEZWZpbml0aW9ucyA9IHByb2Nlc3NEZWZpbml0aW9uUmVwcmVzZW50YXRpb25zO1xuXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmlzUHJvY2Vzc0RlZmluaXRpb25zRW1wdHkoKSkge1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnByb2Nlc3NEZWZpbml0aW9ucy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRQcm9jZXNzRGVmID0gdGhpcy5wcm9jZXNzRGVmaW5pdGlvbnNbMF07XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5wcm9jZXNzRGVmaW5pdGlvbk5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkUHJvY2VzcyA9IHRoaXMucHJvY2Vzc0RlZmluaXRpb25zLmZpbmQoKGN1cnJlbnRQcm9jZXNzRGVmaW5pdGlvbikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjdXJyZW50UHJvY2Vzc0RlZmluaXRpb24ubmFtZSA9PT0gdGhpcy5wcm9jZXNzRGVmaW5pdGlvbk5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWxlY3RlZFByb2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkUHJvY2Vzc0RlZiA9IHNlbGVjdGVkUHJvY2VzcztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJvY2Vzc0RlZmluaXRpb25JbnB1dC5zZXRWYWx1ZSh0aGlzLnNlbGVjdGVkUHJvY2Vzc0RlZi5uYW1lKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuZXJyb3JNZXNzYWdlSWQgPSAnQURGX1BST0NFU1NfTElTVC5TVEFSVF9QUk9DRVNTLkVSUk9SLkxPQURfUFJPQ0VTU19ERUZTJztcbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIGlzUHJvY2Vzc0RlZmluaXRpb25zRW1wdHkoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLnByb2Nlc3NEZWZpbml0aW9ucy5sZW5ndGggPT09IDA7XG4gICAgfVxuXG4gICAgZ2V0QWxmcmVzY29SZXBvc2l0b3J5TmFtZSgpOiBzdHJpbmcge1xuICAgICAgICBsZXQgYWxmcmVzY29SZXBvc2l0b3J5TmFtZSA9IHRoaXMuYXBwQ29uZmlnLmdldDxzdHJpbmc+KEFwcENvbmZpZ1ZhbHVlcy5BTEZSRVNDT19SRVBPU0lUT1JZX05BTUUpO1xuICAgICAgICBpZiAoIWFsZnJlc2NvUmVwb3NpdG9yeU5hbWUpIHtcbiAgICAgICAgICAgIGFsZnJlc2NvUmVwb3NpdG9yeU5hbWUgPSAnYWxmcmVzY28tMSc7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFsZnJlc2NvUmVwb3NpdG9yeU5hbWUgKyAnQWxmcmVzY28nO1xuICAgIH1cblxuICAgIG1vdmVOb2RlRnJvbUNTdG9QUygpIHtcbiAgICAgICAgY29uc3QgYWNjb3VudElkZW50aWZpZXIgPSB0aGlzLmdldEFsZnJlc2NvUmVwb3NpdG9yeU5hbWUoKTtcblxuICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiB0aGlzLnZhbHVlcykge1xuICAgICAgICAgICAgaWYgKHRoaXMudmFsdWVzLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50VmFsdWUgPSB0aGlzLnZhbHVlc1trZXldO1xuXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRWYWx1ZS5pc0ZpbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hY3Rpdml0aUNvbnRlbnRTZXJ2aWNlLmFwcGx5QWxmcmVzY29Ob2RlKGN1cnJlbnRWYWx1ZSwgbnVsbCwgYWNjb3VudElkZW50aWZpZXIpLnN1YnNjcmliZSgocmVzKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZhbHVlc1trZXldID0gW3Jlc107XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBzdGFydFByb2Nlc3Mob3V0Y29tZT86IHN0cmluZykge1xuICAgICAgICBpZiAodGhpcy5zZWxlY3RlZFByb2Nlc3NEZWYgJiYgdGhpcy5zZWxlY3RlZFByb2Nlc3NEZWYuaWQgJiYgdGhpcy5uYW1lKSB7XG4gICAgICAgICAgICB0aGlzLnJlc2V0RXJyb3JNZXNzYWdlKCk7XG4gICAgICAgICAgICBjb25zdCBmb3JtVmFsdWVzID0gdGhpcy5zdGFydEZvcm0gPyB0aGlzLnN0YXJ0Rm9ybS5mb3JtLnZhbHVlcyA6IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIHRoaXMuYWN0aXZpdGlQcm9jZXNzLnN0YXJ0UHJvY2Vzcyh0aGlzLnNlbGVjdGVkUHJvY2Vzc0RlZi5pZCwgdGhpcy5uYW1lLCBvdXRjb21lLCBmb3JtVmFsdWVzLCB0aGlzLnZhcmlhYmxlcykuc3Vic2NyaWJlKFxuICAgICAgICAgICAgICAgIChyZXMpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5uYW1lID0gJyc7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhcnQuZW1pdChyZXMpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgKGVycikgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmVycm9yTWVzc2FnZUlkID0gJ0FERl9QUk9DRVNTX0xJU1QuU1RBUlRfUFJPQ0VTUy5FUlJPUi5TVEFSVCc7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZXJyb3IuZXJyb3IoZXJyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGNhbmNlbFN0YXJ0UHJvY2VzcygpIHtcbiAgICAgICAgdGhpcy5jYW5jZWwuZW1pdCgpO1xuICAgIH1cblxuICAgIGhhc1N0YXJ0Rm9ybSgpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2VsZWN0ZWRQcm9jZXNzRGVmICYmIHRoaXMuc2VsZWN0ZWRQcm9jZXNzRGVmLmhhc1N0YXJ0Rm9ybTtcbiAgICB9XG5cbiAgICBpc1Byb2Nlc3NEZWZpbml0aW9uRW1wdHkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByb2Nlc3NEZWZpbml0aW9ucyA/ICh0aGlzLnByb2Nlc3NEZWZpbml0aW9ucy5sZW5ndGggPiAwIHx8IHRoaXMuZXJyb3JNZXNzYWdlSWQpIDogdGhpcy5lcnJvck1lc3NhZ2VJZDtcbiAgICB9XG5cbiAgICBpc1N0YXJ0Rm9ybU1pc3NpbmdPclZhbGlkKCk6IGJvb2xlYW4ge1xuICAgICAgICBpZiAodGhpcy5zdGFydEZvcm0pIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0YXJ0Rm9ybS5mb3JtICYmIHRoaXMuc3RhcnRGb3JtLmZvcm0uaXNWYWxpZDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgdmFsaWRhdGVGb3JtKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy5zZWxlY3RlZFByb2Nlc3NEZWYgJiYgdGhpcy5zZWxlY3RlZFByb2Nlc3NEZWYuaWQgJiYgdGhpcy5wcm9jZXNzTmFtZUlucHV0LnZhbGlkICYmIHRoaXMuaXNTdGFydEZvcm1NaXNzaW5nT3JWYWxpZCgpO1xuICAgIH1cblxuICAgIHByaXZhdGUgcmVzZXRTZWxlY3RlZFByb2Nlc3NEZWZpbml0aW9uKCkge1xuICAgICAgICB0aGlzLnNlbGVjdGVkUHJvY2Vzc0RlZiA9IG5ldyBQcm9jZXNzRGVmaW5pdGlvblJlcHJlc2VudGF0aW9uKCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSByZXNldEVycm9yTWVzc2FnZSgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5lcnJvck1lc3NhZ2VJZCA9ICcnO1xuICAgIH1cblxuICAgIGhhc0Vycm9yTWVzc2FnZSgpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvY2Vzc0RlZmluaXRpb25zLmxlbmd0aCA9PT0gMCAmJiAhdGhpcy5lcnJvck1lc3NhZ2VJZDtcbiAgICB9XG5cbiAgICBwdWJsaWMgb25PdXRjb21lQ2xpY2sob3V0Y29tZTogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMuc3RhcnRQcm9jZXNzKG91dGNvbWUpO1xuICAgIH1cblxuICAgIHB1YmxpYyByZXNldCgpIHtcbiAgICAgICAgdGhpcy5yZXNldFNlbGVjdGVkUHJvY2Vzc0RlZmluaXRpb24oKTtcbiAgICAgICAgdGhpcy5uYW1lID0gJyc7XG4gICAgICAgIGlmICh0aGlzLnN0YXJ0Rm9ybSkge1xuICAgICAgICAgICAgdGhpcy5zdGFydEZvcm0uZGF0YSA9IHt9O1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVzZXRFcnJvck1lc3NhZ2UoKTtcbiAgICB9XG5cbiAgICBoYXNQcm9jZXNzTmFtZSgpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubmFtZSA/IHRydWUgOiBmYWxzZTtcbiAgICB9XG5cbiAgICBkaXNwbGF5Rm4ocHJvY2VzczogYW55KSB7XG4gICAgICAgIGlmIChwcm9jZXNzKSB7XG4gICAgICAgICAgICBsZXQgcHJvY2Vzc05hbWUgPSBwcm9jZXNzO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBwcm9jZXNzICE9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgIHByb2Nlc3NOYW1lID0gcHJvY2Vzcy5uYW1lO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHByb2Nlc3NOYW1lO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZGlzcGxheURyb3Bkb3duKGV2ZW50KSB7XG4gICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICBpZiAoIXRoaXMuaW5wdXRBdXRvY29tcGxldGUucGFuZWxPcGVuKSB7XG4gICAgICAgICAgICB0aGlzLnByb2Nlc3NEZWZpbml0aW9uSW5wdXQuc2V0VmFsdWUoJycpO1xuICAgICAgICAgICAgdGhpcy5pbnB1dEF1dG9jb21wbGV0ZS5vcGVuUGFuZWwoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuaW5wdXRBdXRvY29tcGxldGUuY2xvc2VQYW5lbCgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2V0IG5hbWVDb250cm9sbGVyKCk6IEFic3RyYWN0Q29udHJvbCB7XG4gICAgICAgIHJldHVybiB0aGlzLnByb2Nlc3NOYW1lSW5wdXQ7XG4gICAgfVxufVxuIl19