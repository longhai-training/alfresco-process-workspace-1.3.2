/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/*!
 * @license
 * Copyright 2019 Alfresco Software, Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/* tslint:disable:no-input-rename  */
import { ContentService } from '@alfresco/adf-core';
import { Directive, EventEmitter, Input, Output } from '@angular/core';
import { TaskListService } from './../services/tasklist.service';
/** @type {?} */
var JSON_FORMAT = 'json';
/** @type {?} */
var PDF_FORMAT = 'pdf';
var TaskAuditDirective = /** @class */ (function () {
    /**
     *
     * @param translateService
     * @param taskListService
     */
    function TaskAuditDirective(contentService, taskListService) {
        this.contentService = contentService;
        this.taskListService = taskListService;
        /**
         * Name of the downloaded file (for PDF downloads).
         */
        this.fileName = 'Audit';
        /**
         * Format of the audit information. Can be "pdf" or "json".
         */
        this.format = 'pdf';
        /**
         * Enables downloading of the audit when the decorated element is clicked.
         */
        this.download = true;
        /**
         * Emitted when the decorated element is clicked.
         */
        this.clicked = new EventEmitter();
        /**
         * Emitted when an error occurs.
         */
        this.error = new EventEmitter();
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    TaskAuditDirective.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        if (!this.isValidType()) {
            this.setDefaultFormatType();
        }
    };
    /**
     * @return {?}
     */
    TaskAuditDirective.prototype.isValidType = /**
     * @return {?}
     */
    function () {
        if (this.format && (this.isJsonFormat() || this.isPdfFormat())) {
            return true;
        }
        return false;
    };
    /**
     * @return {?}
     */
    TaskAuditDirective.prototype.setDefaultFormatType = /**
     * @return {?}
     */
    function () {
        this.format = PDF_FORMAT;
    };
    /**
     * fetch the audit information in the requested format
     */
    /**
     * fetch the audit information in the requested format
     * @return {?}
     */
    TaskAuditDirective.prototype.fetchAuditInfo = /**
     * fetch the audit information in the requested format
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.isPdfFormat()) {
            this.taskListService.fetchTaskAuditPdfById(this.taskId).subscribe((/**
             * @param {?} blob
             * @return {?}
             */
            function (blob) {
                _this.audit = blob;
                if (_this.download) {
                    _this.contentService.downloadBlob(_this.audit, _this.fileName + '.pdf');
                }
                _this.clicked.emit({ format: _this.format, value: _this.audit, fileName: _this.fileName });
            }), (/**
             * @param {?} err
             * @return {?}
             */
            function (err) {
                _this.error.emit(err);
            }));
        }
        else {
            this.taskListService.fetchTaskAuditJsonById(this.taskId).subscribe((/**
             * @param {?} res
             * @return {?}
             */
            function (res) {
                _this.audit = res;
                _this.clicked.emit({ format: _this.format, value: _this.audit, fileName: _this.fileName });
            }), (/**
             * @param {?} err
             * @return {?}
             */
            function (err) {
                _this.error.emit(err);
            }));
        }
    };
    /**
     * @return {?}
     */
    TaskAuditDirective.prototype.onClickAudit = /**
     * @return {?}
     */
    function () {
        this.fetchAuditInfo();
    };
    /**
     * @return {?}
     */
    TaskAuditDirective.prototype.isJsonFormat = /**
     * @return {?}
     */
    function () {
        return this.format === JSON_FORMAT;
    };
    /**
     * @return {?}
     */
    TaskAuditDirective.prototype.isPdfFormat = /**
     * @return {?}
     */
    function () {
        return this.format === PDF_FORMAT;
    };
    TaskAuditDirective.decorators = [
        { type: Directive, args: [{
                    selector: 'button[adf-task-audit]',
                    host: {
                        'role': 'button',
                        '(click)': 'onClickAudit()'
                    }
                },] }
    ];
    /** @nocollapse */
    TaskAuditDirective.ctorParameters = function () { return [
        { type: ContentService },
        { type: TaskListService }
    ]; };
    TaskAuditDirective.propDecorators = {
        taskId: [{ type: Input, args: ['task-id',] }],
        fileName: [{ type: Input }],
        format: [{ type: Input }],
        download: [{ type: Input }],
        clicked: [{ type: Output }],
        error: [{ type: Output }]
    };
    return TaskAuditDirective;
}());
export { TaskAuditDirective };
if (false) {
    /**
     * (**required**) The id of the task.
     * @type {?}
     */
    TaskAuditDirective.prototype.taskId;
    /**
     * Name of the downloaded file (for PDF downloads).
     * @type {?}
     */
    TaskAuditDirective.prototype.fileName;
    /**
     * Format of the audit information. Can be "pdf" or "json".
     * @type {?}
     */
    TaskAuditDirective.prototype.format;
    /**
     * Enables downloading of the audit when the decorated element is clicked.
     * @type {?}
     */
    TaskAuditDirective.prototype.download;
    /**
     * Emitted when the decorated element is clicked.
     * @type {?}
     */
    TaskAuditDirective.prototype.clicked;
    /**
     * Emitted when an error occurs.
     * @type {?}
     */
    TaskAuditDirective.prototype.error;
    /** @type {?} */
    TaskAuditDirective.prototype.audit;
    /**
     * @type {?}
     * @private
     */
    TaskAuditDirective.prototype.contentService;
    /**
     * @type {?}
     * @private
     */
    TaskAuditDirective.prototype.taskListService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGFzay1hdWRpdC5kaXJlY3RpdmUuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AYWxmcmVzY28vYWRmLXByb2Nlc3Mtc2VydmljZXMvIiwic291cmNlcyI6WyJ0YXNrLWxpc3QvY29tcG9uZW50cy90YXNrLWF1ZGl0LmRpcmVjdGl2ZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFtQkEsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLG9CQUFvQixDQUFDO0FBQ3BELE9BQU8sRUFBRSxTQUFTLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBYSxNQUFNLEVBQWlCLE1BQU0sZUFBZSxDQUFDO0FBQ2pHLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxnQ0FBZ0MsQ0FBQzs7SUFFM0QsV0FBVyxHQUFXLE1BQU07O0lBQzVCLFVBQVUsR0FBVyxLQUFLO0FBRWhDO0lBbUNJOzs7O09BSUc7SUFDSCw0QkFBb0IsY0FBOEIsRUFDOUIsZUFBZ0M7UUFEaEMsbUJBQWMsR0FBZCxjQUFjLENBQWdCO1FBQzlCLG9CQUFlLEdBQWYsZUFBZSxDQUFpQjs7OztRQTFCcEQsYUFBUSxHQUFXLE9BQU8sQ0FBQzs7OztRQUkzQixXQUFNLEdBQVcsS0FBSyxDQUFDOzs7O1FBSXZCLGFBQVEsR0FBWSxJQUFJLENBQUM7Ozs7UUFJekIsWUFBTyxHQUFzQixJQUFJLFlBQVksRUFBTyxDQUFDOzs7O1FBSXJELFVBQUssR0FBc0IsSUFBSSxZQUFZLEVBQU8sQ0FBQztJQVduRCxDQUFDOzs7OztJQUVELHdDQUFXOzs7O0lBQVgsVUFBWSxPQUFzQjtRQUM5QixJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxFQUFFO1lBQ3JCLElBQUksQ0FBQyxvQkFBb0IsRUFBRSxDQUFDO1NBQy9CO0lBQ0wsQ0FBQzs7OztJQUVELHdDQUFXOzs7SUFBWDtRQUNJLElBQUksSUFBSSxDQUFDLE1BQU0sSUFBSSxDQUFDLElBQUksQ0FBQyxZQUFZLEVBQUUsSUFBSSxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUMsRUFBRTtZQUM1RCxPQUFPLElBQUksQ0FBQztTQUNmO1FBQ0QsT0FBTyxLQUFLLENBQUM7SUFDakIsQ0FBQzs7OztJQUVELGlEQUFvQjs7O0lBQXBCO1FBQ0ksSUFBSSxDQUFDLE1BQU0sR0FBRyxVQUFVLENBQUM7SUFDN0IsQ0FBQztJQUVEOztPQUVHOzs7OztJQUNILDJDQUFjOzs7O0lBQWQ7UUFBQSxpQkF1QkM7UUF0QkcsSUFBSSxJQUFJLENBQUMsV0FBVyxFQUFFLEVBQUU7WUFDcEIsSUFBSSxDQUFDLGVBQWUsQ0FBQyxxQkFBcUIsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsU0FBUzs7OztZQUM3RCxVQUFDLElBQVU7Z0JBQ1AsS0FBSSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUM7Z0JBQ2xCLElBQUksS0FBSSxDQUFDLFFBQVEsRUFBRTtvQkFDZixLQUFJLENBQUMsY0FBYyxDQUFDLFlBQVksQ0FBQyxLQUFJLENBQUMsS0FBSyxFQUFFLEtBQUksQ0FBQyxRQUFRLEdBQUcsTUFBTSxDQUFDLENBQUM7aUJBQ3hFO2dCQUNELEtBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEVBQUUsTUFBTSxFQUFFLEtBQUksQ0FBQyxNQUFNLEVBQUUsS0FBSyxFQUFFLEtBQUksQ0FBQyxLQUFLLEVBQUUsUUFBUSxFQUFFLEtBQUksQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDO1lBQzNGLENBQUM7Ozs7WUFDRCxVQUFDLEdBQUc7Z0JBQ0EsS0FBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7WUFDekIsQ0FBQyxFQUFDLENBQUM7U0FDVjthQUFNO1lBQ0gsSUFBSSxDQUFDLGVBQWUsQ0FBQyxzQkFBc0IsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsU0FBUzs7OztZQUM5RCxVQUFDLEdBQUc7Z0JBQ0EsS0FBSSxDQUFDLEtBQUssR0FBRyxHQUFHLENBQUM7Z0JBQ2pCLEtBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEVBQUUsTUFBTSxFQUFFLEtBQUksQ0FBQyxNQUFNLEVBQUUsS0FBSyxFQUFFLEtBQUksQ0FBQyxLQUFLLEVBQUUsUUFBUSxFQUFFLEtBQUksQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDO1lBQzNGLENBQUM7Ozs7WUFDRCxVQUFDLEdBQUc7Z0JBQ0EsS0FBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7WUFDekIsQ0FBQyxFQUFDLENBQUM7U0FDVjtJQUNMLENBQUM7Ozs7SUFFRCx5Q0FBWTs7O0lBQVo7UUFDSSxJQUFJLENBQUMsY0FBYyxFQUFFLENBQUM7SUFDMUIsQ0FBQzs7OztJQUVELHlDQUFZOzs7SUFBWjtRQUNJLE9BQU8sSUFBSSxDQUFDLE1BQU0sS0FBSyxXQUFXLENBQUM7SUFDdkMsQ0FBQzs7OztJQUVELHdDQUFXOzs7SUFBWDtRQUNJLE9BQU8sSUFBSSxDQUFDLE1BQU0sS0FBSyxVQUFVLENBQUM7SUFDdEMsQ0FBQzs7Z0JBbkdKLFNBQVMsU0FBQztvQkFDUCxRQUFRLEVBQUUsd0JBQXdCO29CQUNsQyxJQUFJLEVBQUU7d0JBQ0YsTUFBTSxFQUFFLFFBQVE7d0JBQ2hCLFNBQVMsRUFBRSxnQkFBZ0I7cUJBQzlCO2lCQUNKOzs7O2dCQWJRLGNBQWM7Z0JBRWQsZUFBZTs7O3lCQWVuQixLQUFLLFNBQUMsU0FBUzsyQkFJZixLQUFLO3lCQUlMLEtBQUs7MkJBSUwsS0FBSzswQkFJTCxNQUFNO3dCQUlOLE1BQU07O0lBdUVYLHlCQUFDO0NBQUEsQUFyR0QsSUFxR0M7U0E5Rlksa0JBQWtCOzs7Ozs7SUFHM0Isb0NBQ2U7Ozs7O0lBR2Ysc0NBQzJCOzs7OztJQUczQixvQ0FDdUI7Ozs7O0lBR3ZCLHNDQUN5Qjs7Ozs7SUFHekIscUNBQ3FEOzs7OztJQUdyRCxtQ0FDbUQ7O0lBRW5ELG1DQUFrQjs7Ozs7SUFPTiw0Q0FBc0M7Ozs7O0lBQ3RDLDZDQUF3QyIsInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEFsZnJlc2NvIFNvZnR3YXJlLCBMdGQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qIHRzbGludDpkaXNhYmxlOm5vLWlucHV0LXJlbmFtZSAgKi9cblxuaW1wb3J0IHsgQ29udGVudFNlcnZpY2UgfSBmcm9tICdAYWxmcmVzY28vYWRmLWNvcmUnO1xuaW1wb3J0IHsgRGlyZWN0aXZlLCBFdmVudEVtaXR0ZXIsIElucHV0LCBPbkNoYW5nZXMsIE91dHB1dCwgU2ltcGxlQ2hhbmdlcyB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgVGFza0xpc3RTZXJ2aWNlIH0gZnJvbSAnLi8uLi9zZXJ2aWNlcy90YXNrbGlzdC5zZXJ2aWNlJztcblxuY29uc3QgSlNPTl9GT1JNQVQ6IHN0cmluZyA9ICdqc29uJztcbmNvbnN0IFBERl9GT1JNQVQ6IHN0cmluZyA9ICdwZGYnO1xuXG5ARGlyZWN0aXZlKHtcbiAgICBzZWxlY3RvcjogJ2J1dHRvblthZGYtdGFzay1hdWRpdF0nLFxuICAgIGhvc3Q6IHtcbiAgICAgICAgJ3JvbGUnOiAnYnV0dG9uJyxcbiAgICAgICAgJyhjbGljayknOiAnb25DbGlja0F1ZGl0KCknXG4gICAgfVxufSlcbmV4cG9ydCBjbGFzcyBUYXNrQXVkaXREaXJlY3RpdmUgaW1wbGVtZW50cyBPbkNoYW5nZXMge1xuXG4gICAgLyoqICgqKnJlcXVpcmVkKiopIFRoZSBpZCBvZiB0aGUgdGFzay4gKi9cbiAgICBASW5wdXQoJ3Rhc2staWQnKVxuICAgIHRhc2tJZDogc3RyaW5nO1xuXG4gICAgLyoqIE5hbWUgb2YgdGhlIGRvd25sb2FkZWQgZmlsZSAoZm9yIFBERiBkb3dubG9hZHMpLiAqL1xuICAgIEBJbnB1dCgpXG4gICAgZmlsZU5hbWU6IHN0cmluZyA9ICdBdWRpdCc7XG5cbiAgICAvKiogRm9ybWF0IG9mIHRoZSBhdWRpdCBpbmZvcm1hdGlvbi4gQ2FuIGJlIFwicGRmXCIgb3IgXCJqc29uXCIuICovXG4gICAgQElucHV0KClcbiAgICBmb3JtYXQ6IHN0cmluZyA9ICdwZGYnO1xuXG4gICAgLyoqIEVuYWJsZXMgZG93bmxvYWRpbmcgb2YgdGhlIGF1ZGl0IHdoZW4gdGhlIGRlY29yYXRlZCBlbGVtZW50IGlzIGNsaWNrZWQuICovXG4gICAgQElucHV0KClcbiAgICBkb3dubG9hZDogYm9vbGVhbiA9IHRydWU7XG5cbiAgICAvKiogRW1pdHRlZCB3aGVuIHRoZSBkZWNvcmF0ZWQgZWxlbWVudCBpcyBjbGlja2VkLiAqL1xuICAgIEBPdXRwdXQoKVxuICAgIGNsaWNrZWQ6IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG5cbiAgICAvKiogRW1pdHRlZCB3aGVuIGFuIGVycm9yIG9jY3Vycy4gKi9cbiAgICBAT3V0cHV0KClcbiAgICBlcnJvcjogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcblxuICAgIHB1YmxpYyBhdWRpdDogYW55O1xuXG4gICAgLyoqXG4gICAgICpcbiAgICAgKiBAcGFyYW0gdHJhbnNsYXRlU2VydmljZVxuICAgICAqIEBwYXJhbSB0YXNrTGlzdFNlcnZpY2VcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGNvbnRlbnRTZXJ2aWNlOiBDb250ZW50U2VydmljZSxcbiAgICAgICAgICAgICAgICBwcml2YXRlIHRhc2tMaXN0U2VydmljZTogVGFza0xpc3RTZXJ2aWNlKSB7XG4gICAgfVxuXG4gICAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcyk6IHZvaWQge1xuICAgICAgICBpZiAoIXRoaXMuaXNWYWxpZFR5cGUoKSkge1xuICAgICAgICAgICAgdGhpcy5zZXREZWZhdWx0Rm9ybWF0VHlwZSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaXNWYWxpZFR5cGUoKSB7XG4gICAgICAgIGlmICh0aGlzLmZvcm1hdCAmJiAodGhpcy5pc0pzb25Gb3JtYXQoKSB8fCB0aGlzLmlzUGRmRm9ybWF0KCkpKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgc2V0RGVmYXVsdEZvcm1hdFR5cGUoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuZm9ybWF0ID0gUERGX0ZPUk1BVDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBmZXRjaCB0aGUgYXVkaXQgaW5mb3JtYXRpb24gaW4gdGhlIHJlcXVlc3RlZCBmb3JtYXRcbiAgICAgKi9cbiAgICBmZXRjaEF1ZGl0SW5mbygpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuaXNQZGZGb3JtYXQoKSkge1xuICAgICAgICAgICAgdGhpcy50YXNrTGlzdFNlcnZpY2UuZmV0Y2hUYXNrQXVkaXRQZGZCeUlkKHRoaXMudGFza0lkKS5zdWJzY3JpYmUoXG4gICAgICAgICAgICAgICAgKGJsb2I6IEJsb2IpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hdWRpdCA9IGJsb2I7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmRvd25sb2FkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnRlbnRTZXJ2aWNlLmRvd25sb2FkQmxvYih0aGlzLmF1ZGl0LCB0aGlzLmZpbGVOYW1lICsgJy5wZGYnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNsaWNrZWQuZW1pdCh7IGZvcm1hdDogdGhpcy5mb3JtYXQsIHZhbHVlOiB0aGlzLmF1ZGl0LCBmaWxlTmFtZTogdGhpcy5maWxlTmFtZSB9KTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIChlcnIpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lcnJvci5lbWl0KGVycik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnRhc2tMaXN0U2VydmljZS5mZXRjaFRhc2tBdWRpdEpzb25CeUlkKHRoaXMudGFza0lkKS5zdWJzY3JpYmUoXG4gICAgICAgICAgICAgICAgKHJlcykgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmF1ZGl0ID0gcmVzO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNsaWNrZWQuZW1pdCh7IGZvcm1hdDogdGhpcy5mb3JtYXQsIHZhbHVlOiB0aGlzLmF1ZGl0LCBmaWxlTmFtZTogdGhpcy5maWxlTmFtZSB9KTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIChlcnIpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lcnJvci5lbWl0KGVycik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvbkNsaWNrQXVkaXQoKSB7XG4gICAgICAgIHRoaXMuZmV0Y2hBdWRpdEluZm8oKTtcbiAgICB9XG5cbiAgICBpc0pzb25Gb3JtYXQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZvcm1hdCA9PT0gSlNPTl9GT1JNQVQ7XG4gICAgfVxuXG4gICAgaXNQZGZGb3JtYXQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZvcm1hdCA9PT0gUERGX0ZPUk1BVDtcbiAgICB9XG5cbn1cbiJdfQ==