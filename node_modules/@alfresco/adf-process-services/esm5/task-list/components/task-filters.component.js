/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/*!
 * @license
 * Copyright 2019 Alfresco Software, Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
import { AppsProcessService } from '@alfresco/adf-core';
import { Component, EventEmitter, Input, Output } from '@angular/core';
import { FilterParamsModel } from '../models/filter.model';
import { TaskFilterService } from './../services/task-filter.service';
import { TaskListService } from './../services/tasklist.service';
import { IconModel } from '../../app-list/icon.model';
var TaskFiltersComponent = /** @class */ (function () {
    function TaskFiltersComponent(taskFilterService, taskListService, appsProcessService) {
        this.taskFilterService = taskFilterService;
        this.taskListService = taskListService;
        this.appsProcessService = appsProcessService;
        /**
         * Emitted when a filter in the list is clicked.
         */
        this.filterClick = new EventEmitter();
        /**
         * Emitted when the list is loaded.
         */
        this.success = new EventEmitter();
        /**
         * Emitted when an error occurs during loading.
         */
        this.error = new EventEmitter();
        this.filters = [];
    }
    /**
     * @return {?}
     */
    TaskFiltersComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.iconsMDL = new IconModel();
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    TaskFiltersComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        /** @type {?} */
        var appName = changes['appName'];
        /** @type {?} */
        var appId = changes['appId'];
        /** @type {?} */
        var filter = changes['filterParam'];
        if (appName && appName.currentValue) {
            this.getFiltersByAppName(appName.currentValue);
        }
        else if (appId && appId.currentValue !== appId.previousValue) {
            this.getFiltersByAppId(appId.currentValue);
        }
        else if (filter && filter.currentValue !== filter.previousValue) {
            this.selectFilter(filter.currentValue);
        }
    };
    /**
     * Return the task list filtered by appId or by appName
     * @param appId
     * @param appName
     */
    /**
     * Return the task list filtered by appId or by appName
     * @param {?=} appId
     * @param {?=} appName
     * @return {?}
     */
    TaskFiltersComponent.prototype.getFilters = /**
     * Return the task list filtered by appId or by appName
     * @param {?=} appId
     * @param {?=} appName
     * @return {?}
     */
    function (appId, appName) {
        appName ? this.getFiltersByAppName(appName) : this.getFiltersByAppId(appId);
    };
    /**
     * Return the filter list filtered by appId
     * @param appId - optional
     */
    /**
     * Return the filter list filtered by appId
     * @param {?=} appId - optional
     * @return {?}
     */
    TaskFiltersComponent.prototype.getFiltersByAppId = /**
     * Return the filter list filtered by appId
     * @param {?=} appId - optional
     * @return {?}
     */
    function (appId) {
        var _this = this;
        this.taskFilterService.getTaskListFilters(appId).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            if (res.length === 0 && _this.isFilterListEmpty()) {
                _this.createFiltersByAppId(appId);
            }
            else {
                _this.resetFilter();
                _this.filters = res;
                _this.selectFilter(_this.filterParam);
                _this.success.emit(res);
            }
        }), (/**
         * @param {?} err
         * @return {?}
         */
        function (err) {
            _this.error.emit(err);
        }));
    };
    /**
     * Return the filter list filtered by appName
     * @param appName
     */
    /**
     * Return the filter list filtered by appName
     * @param {?} appName
     * @return {?}
     */
    TaskFiltersComponent.prototype.getFiltersByAppName = /**
     * Return the filter list filtered by appName
     * @param {?} appName
     * @return {?}
     */
    function (appName) {
        var _this = this;
        this.appsProcessService.getDeployedApplicationsByName(appName).subscribe((/**
         * @param {?} application
         * @return {?}
         */
        function (application) {
            _this.getFiltersByAppId(application.id);
        }), (/**
         * @param {?} err
         * @return {?}
         */
        function (err) {
            _this.error.emit(err);
        }));
    };
    /**
     * Create default filters by appId
     * @param appId
     */
    /**
     * Create default filters by appId
     * @param {?=} appId
     * @return {?}
     */
    TaskFiltersComponent.prototype.createFiltersByAppId = /**
     * Create default filters by appId
     * @param {?=} appId
     * @return {?}
     */
    function (appId) {
        var _this = this;
        this.taskFilterService.createDefaultFilters(appId).subscribe((/**
         * @param {?} resDefault
         * @return {?}
         */
        function (resDefault) {
            _this.resetFilter();
            _this.filters = resDefault;
            _this.selectFilter(_this.filterParam);
            _this.success.emit(resDefault);
        }), (/**
         * @param {?} errDefault
         * @return {?}
         */
        function (errDefault) {
            _this.error.emit(errDefault);
        }));
    };
    /**
     * Pass the selected filter as next
     * @param filter
     */
    /**
     * Pass the selected filter as next
     * @param {?} newFilter
     * @return {?}
     */
    TaskFiltersComponent.prototype.selectFilter = /**
     * Pass the selected filter as next
     * @param {?} newFilter
     * @return {?}
     */
    function (newFilter) {
        if (newFilter) {
            this.currentFilter = this.filters.find((/**
             * @param {?} filter
             * @param {?} index
             * @return {?}
             */
            function (filter, index) {
                return newFilter.index === index ||
                    newFilter.id === filter.id ||
                    (newFilter.name &&
                        (newFilter.name.toLocaleLowerCase() === filter.name.toLocaleLowerCase()));
            }));
        }
        if (!this.currentFilter) {
            this.selectDefaultTaskFilter();
        }
    };
    /**
     * @param {?} newFilter
     * @return {?}
     */
    TaskFiltersComponent.prototype.selectFilterAndEmit = /**
     * @param {?} newFilter
     * @return {?}
     */
    function (newFilter) {
        this.selectFilter(newFilter);
        this.filterClick.emit(this.currentFilter);
    };
    /**
     * Select filter with task
     * @param taskId
     */
    /**
     * Select filter with task
     * @param {?} taskId
     * @return {?}
     */
    TaskFiltersComponent.prototype.selectFilterWithTask = /**
     * Select filter with task
     * @param {?} taskId
     * @return {?}
     */
    function (taskId) {
        var _this = this;
        /** @type {?} */
        var filteredFilterList = [];
        this.taskListService.getFilterForTaskById(taskId, this.filters).subscribe((/**
         * @param {?} filter
         * @return {?}
         */
        function (filter) {
            filteredFilterList.push(filter);
        }), (/**
         * @param {?} err
         * @return {?}
         */
        function (err) {
            _this.error.emit(err);
        }), (/**
         * @return {?}
         */
        function () {
            if (filteredFilterList.length > 0) {
                _this.selectFilter(filteredFilterList[0]);
                _this.filterClick.emit(_this.currentFilter);
            }
        }));
    };
    /**
     * Select as default task filter the first in the list
     * @param filteredFilterList
     */
    /**
     * Select as default task filter the first in the list
     * @return {?}
     */
    TaskFiltersComponent.prototype.selectDefaultTaskFilter = /**
     * Select as default task filter the first in the list
     * @return {?}
     */
    function () {
        if (!this.isFilterListEmpty()) {
            this.currentFilter = this.filters[0];
        }
    };
    /**
     * Return the current task
     */
    /**
     * Return the current task
     * @return {?}
     */
    TaskFiltersComponent.prototype.getCurrentFilter = /**
     * Return the current task
     * @return {?}
     */
    function () {
        return this.currentFilter;
    };
    /**
     * Check if the filter list is empty
     */
    /**
     * Check if the filter list is empty
     * @return {?}
     */
    TaskFiltersComponent.prototype.isFilterListEmpty = /**
     * Check if the filter list is empty
     * @return {?}
     */
    function () {
        return this.filters === undefined || (this.filters && this.filters.length === 0);
    };
    /**
     * Reset the filters properties
     */
    /**
     * Reset the filters properties
     * @private
     * @return {?}
     */
    TaskFiltersComponent.prototype.resetFilter = /**
     * Reset the filters properties
     * @private
     * @return {?}
     */
    function () {
        this.filters = [];
        this.currentFilter = undefined;
    };
    /**
     * Return current filter icon
     */
    /**
     * Return current filter icon
     * @param {?} icon
     * @return {?}
     */
    TaskFiltersComponent.prototype.getFilterIcon = /**
     * Return current filter icon
     * @param {?} icon
     * @return {?}
     */
    function (icon) {
        return this.iconsMDL.mapGlyphiconToMaterialDesignIcons(icon);
    };
    TaskFiltersComponent.decorators = [
        { type: Component, args: [{
                    selector: 'adf-task-filters',
                    template: "<div class=\"menu-container\">\n    <mat-list class=\"adf-menu-list\">\n        <mat-list-item (click)=\"selectFilterAndEmit(filter)\" *ngFor=\"let filter of filters\"\n                      class=\"adf-filters__entry\" [class.adf-active]=\"currentFilter === filter\">\n            <mat-icon *ngIf=\"showIcon\" matListIcon class=\"adf-filters__entry-icon\">{{getFilterIcon(filter.icon)}}</mat-icon>\n            <span matLine [attr.data-automation-id]=\"filter.name + '_filter'\">{{filter.name}}</span>\n        </mat-list-item>\n    </mat-list>\n</div>\n",
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    TaskFiltersComponent.ctorParameters = function () { return [
        { type: TaskFilterService },
        { type: TaskListService },
        { type: AppsProcessService }
    ]; };
    TaskFiltersComponent.propDecorators = {
        filterParam: [{ type: Input }],
        filterClick: [{ type: Output }],
        success: [{ type: Output }],
        error: [{ type: Output }],
        appId: [{ type: Input }],
        appName: [{ type: Input }],
        showIcon: [{ type: Input }]
    };
    return TaskFiltersComponent;
}());
export { TaskFiltersComponent };
if (false) {
    /**
     * Parameters to use for the task filter. If there is no match then
     * the default filter (the first one the list) is selected.
     * @type {?}
     */
    TaskFiltersComponent.prototype.filterParam;
    /**
     * Emitted when a filter in the list is clicked.
     * @type {?}
     */
    TaskFiltersComponent.prototype.filterClick;
    /**
     * Emitted when the list is loaded.
     * @type {?}
     */
    TaskFiltersComponent.prototype.success;
    /**
     * Emitted when an error occurs during loading.
     * @type {?}
     */
    TaskFiltersComponent.prototype.error;
    /**
     * Display filters available to the current user for the application with the specified ID.
     * @type {?}
     */
    TaskFiltersComponent.prototype.appId;
    /**
     * Display filters available to the current user for the application with the specified name.
     * @type {?}
     */
    TaskFiltersComponent.prototype.appName;
    /**
     * Toggles display of the filter's icon.
     * @type {?}
     */
    TaskFiltersComponent.prototype.showIcon;
    /** @type {?} */
    TaskFiltersComponent.prototype.filter$;
    /** @type {?} */
    TaskFiltersComponent.prototype.currentFilter;
    /** @type {?} */
    TaskFiltersComponent.prototype.filters;
    /**
     * @type {?}
     * @private
     */
    TaskFiltersComponent.prototype.iconsMDL;
    /**
     * @type {?}
     * @private
     */
    TaskFiltersComponent.prototype.taskFilterService;
    /**
     * @type {?}
     * @private
     */
    TaskFiltersComponent.prototype.taskListService;
    /**
     * @type {?}
     * @private
     */
    TaskFiltersComponent.prototype.appsProcessService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGFzay1maWx0ZXJzLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BhbGZyZXNjby9hZGYtcHJvY2Vzcy1zZXJ2aWNlcy8iLCJzb3VyY2VzIjpbInRhc2stbGlzdC9jb21wb25lbnRzL3Rhc2stZmlsdGVycy5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFpQkEsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFDeEQsT0FBTyxFQUFFLFNBQVMsRUFBRSxZQUFZLEVBQUUsS0FBSyxFQUFxQixNQUFNLEVBQWlCLE1BQU0sZUFBZSxDQUFDO0FBRXpHLE9BQU8sRUFBRSxpQkFBaUIsRUFBNkIsTUFBTSx3QkFBd0IsQ0FBQztBQUN0RixPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxtQ0FBbUMsQ0FBQztBQUN0RSxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sZ0NBQWdDLENBQUM7QUFDakUsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLDJCQUEyQixDQUFDO0FBRXREO0lBNkNJLDhCQUFvQixpQkFBb0MsRUFDcEMsZUFBZ0MsRUFDaEMsa0JBQXNDO1FBRnRDLHNCQUFpQixHQUFqQixpQkFBaUIsQ0FBbUI7UUFDcEMsb0JBQWUsR0FBZixlQUFlLENBQWlCO1FBQ2hDLHVCQUFrQixHQUFsQixrQkFBa0IsQ0FBb0I7Ozs7UUFoQzFELGdCQUFXLEdBQTRDLElBQUksWUFBWSxFQUE2QixDQUFDOzs7O1FBSXJHLFlBQU8sR0FBc0IsSUFBSSxZQUFZLEVBQU8sQ0FBQzs7OztRQUlyRCxVQUFLLEdBQXNCLElBQUksWUFBWSxFQUFPLENBQUM7UUFrQm5ELFlBQU8sR0FBaUMsRUFBRSxDQUFDO0lBTzNDLENBQUM7Ozs7SUFFRCx1Q0FBUTs7O0lBQVI7UUFDSSxJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksU0FBUyxFQUFFLENBQUM7SUFDcEMsQ0FBQzs7Ozs7SUFFRCwwQ0FBVzs7OztJ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QWIsVUFBYyxJQUFJO1FBQ2QsT0FBTyxJQUFJLENBQUMsUUFBUSxDQUFDLGlDQUFpQyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ2pFLENBQUM7O2dCQW5OSixTQUFTLFNBQUM7b0JBQ1AsUUFBUSxFQUFFLGtCQUFrQjtvQkFDNUIsdWpCQUE0Qzs7aUJBRS9DOzs7O2dCQVJRLGlCQUFpQjtnQkFDakIsZUFBZTtnQkFMZixrQkFBa0I7Ozs4QkFrQnRCLEtBQUs7OEJBSUwsTUFBTTswQkFJTixNQUFNO3dCQUlOLE1BQU07d0JBSU4sS0FBSzswQkFJTCxLQUFLOzJCQUlMLEtBQUs7O0lBa0xWLDJCQUFDO0NBQUEsQUFwTkQsSUFvTkM7U0EvTVksb0JBQW9COzs7Ozs7O0lBSzdCLDJDQUMrQjs7Ozs7SUFHL0IsMkNBQ3FHOzs7OztJQUdyRyx1Q0FDcUQ7Ozs7O0lBR3JELHFDQUNtRDs7Ozs7SUFHbkQscUNBQ2M7Ozs7O0lBR2QsdUNBQ2dCOzs7OztJQUdoQix3Q0FDa0I7O0lBRWxCLHVDQUErQzs7SUFFL0MsNkNBQXlDOztJQUV6Qyx1Q0FBMkM7Ozs7O0lBRTNDLHdDQUE0Qjs7Ozs7SUFFaEIsaURBQTRDOzs7OztJQUM1QywrQ0FBd0M7Ozs7O0lBQ3hDLGtEQUE4QyIsInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEFsZnJlc2NvIFNvZnR3YXJlLCBMdGQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IEFwcHNQcm9jZXNzU2VydmljZSB9IGZyb20gJ0BhbGZyZXNjby9hZGYtY29yZSc7XG5pbXBvcnQgeyBDb21wb25lbnQsIEV2ZW50RW1pdHRlciwgSW5wdXQsIE9uQ2hhbmdlcywgT25Jbml0LCBPdXRwdXQsIFNpbXBsZUNoYW5nZXMgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IEZpbHRlclBhcmFtc01vZGVsLCBGaWx0ZXJSZXByZXNlbnRhdGlvbk1vZGVsIH0gZnJvbSAnLi4vbW9kZWxzL2ZpbHRlci5tb2RlbCc7XG5pbXBvcnQgeyBUYXNrRmlsdGVyU2VydmljZSB9IGZyb20gJy4vLi4vc2VydmljZXMvdGFzay1maWx0ZXIuc2VydmljZSc7XG5pbXBvcnQgeyBUYXNrTGlzdFNlcnZpY2UgfSBmcm9tICcuLy4uL3NlcnZpY2VzL3Rhc2tsaXN0LnNlcnZpY2UnO1xuaW1wb3J0IHsgSWNvbk1vZGVsIH0gZnJvbSAnLi4vLi4vYXBwLWxpc3QvaWNvbi5tb2RlbCc7XG5cbkBDb21wb25lbnQoe1xuICAgIHNlbGVjdG9yOiAnYWRmLXRhc2stZmlsdGVycycsXG4gICAgdGVtcGxhdGVVcmw6ICcuL3Rhc2stZmlsdGVycy5jb21wb25lbnQuaHRtbCcsXG4gICAgc3R5bGVVcmxzOiBbJ3Rhc2stZmlsdGVycy5jb21wb25lbnQuc2NzcyddXG59KVxuZXhwb3J0IGNsYXNzIFRhc2tGaWx0ZXJzQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkNoYW5nZXMge1xuXG4gICAgLyoqIFBhcmFtZXRlcnMgdG8gdXNlIGZvciB0aGUgdGFzayBmaWx0ZXIuIElmIHRoZXJlIGlzIG5vIG1hdGNoIHRoZW5cbiAgICAgKiB0aGUgZGVmYXVsdCBmaWx0ZXIgKHRoZSBmaXJzdCBvbmUgdGhlIGxpc3QpIGlzIHNlbGVjdGVkLlxuICAgICAqL1xuICAgIEBJbnB1dCgpXG4gICAgZmlsdGVyUGFyYW06IEZpbHRlclBhcmFtc01vZGVsO1xuXG4gICAgLyoqIEVtaXR0ZWQgd2hlbiBhIGZpbHRlciBpbiB0aGUgbGlzdCBpcyBjbGlja2VkLiAqL1xuICAgIEBPdXRwdXQoKVxuICAgIGZpbHRlckNsaWNrOiBFdmVudEVtaXR0ZXI8RmlsdGVyUmVwcmVzZW50YXRpb25Nb2RlbD4gPSBuZXcgRXZlbnRFbWl0dGVyPEZpbHRlclJlcHJlc2VudGF0aW9uTW9kZWw+KCk7XG5cbiAgICAvKiogRW1pdHRlZCB3aGVuIHRoZSBsaXN0IGlzIGxvYWRlZC4gKi9cbiAgICBAT3V0cHV0KClcbiAgICBzdWNjZXNzOiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuXG4gICAgLyoqIEVtaXR0ZWQgd2hlbiBhbiBlcnJvciBvY2N1cnMgZHVyaW5nIGxvYWRpbmcuICovXG4gICAgQE91dHB1dCgpXG4gICAgZXJyb3I6IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG5cbiAgICAvKiogRGlzcGxheSBmaWx0ZXJzIGF2YWlsYWJsZSB0byB0aGUgY3VycmVudCB1c2VyIGZvciB0aGUgYXBwbGljYXRpb24gd2l0aCB0aGUgc3BlY2lmaWVkIElELiAqL1xuICAgIEBJbnB1dCgpXG4gICAgYXBwSWQ6IG51bWJlcjtcblxuICAgIC8qKiBEaXNwbGF5IGZpbHRlcnMgYXZhaWxhYmxlIHRvIHRoZSBjdXJyZW50IHVzZXIgZm9yIHRoZSBhcHBsaWNhdGlvbiB3aXRoIHRoZSBzcGVjaWZpZWQgbmFtZS4gKi9cbiAgICBASW5wdXQoKVxuICAgIGFwcE5hbWU6IHN0cmluZztcblxuICAgIC8qKiBUb2dnbGVzIGRpc3BsYXkgb2YgdGhlIGZpbHRlcidzIGljb24uICovXG4gICAgQElucHV0KClcbiAgICBzaG93SWNvbjogYm9vbGVhbjtcblxuICAgIGZpbHRlciQ6IE9ic2VydmFibGU8RmlsdGVyUmVwcmVzZW50YXRpb25Nb2RlbD47XG5cbiAgICBjdXJyZW50RmlsdGVyOiBGaWx0ZXJSZXByZXNlbnRhdGlvbk1vZGVsO1xuXG4gICAgZmlsdGVyczogRmlsdGVyUmVwcmVzZW50YXRpb25Nb2RlbCBbXSA9IFtdO1xuXG4gICAgcHJpdmF0ZSBpY29uc01ETDogSWNvbk1vZGVsO1xuXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSB0YXNrRmlsdGVyU2VydmljZTogVGFza0ZpbHRlclNlcnZpY2UsXG4gICAgICAgICAgICAgICAgcHJpdmF0ZSB0YXNrTGlzdFNlcnZpY2U6IFRhc2tMaXN0U2VydmljZSxcbiAgICAgICAgICAgICAgICBwcml2YXRlIGFwcHNQcm9jZXNzU2VydmljZTogQXBwc1Byb2Nlc3NTZXJ2aWNlKSB7XG4gICAgfVxuXG4gICAgbmdPbkluaXQoKSB7XG4gICAgICAgIHRoaXMuaWNvbnNNREwgPSBuZXcgSWNvbk1vZGVsKCk7XG4gICAgfVxuXG4gICAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcykge1xuICAgICAgICBjb25zdCBhcHBOYW1lID0gY2hhbmdlc1snYXBwTmFtZSddO1xuICAgICAgICBjb25zdCBhcHBJZCA9IGNoYW5nZXNbJ2FwcElkJ107XG4gICAgICAgIGNvbnN0IGZpbHRlciA9IGNoYW5nZXNbJ2ZpbHRlclBhcmFtJ107XG4gICAgICAgIGlmIChhcHBOYW1lICYmIGFwcE5hbWUuY3VycmVudFZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLmdldEZpbHRlcnNCeUFwcE5hbWUoYXBwTmFtZS5jdXJyZW50VmFsdWUpO1xuICAgICAgICB9IGVsc2UgaWYgKGFwcElkICYmIGFwcElkLmN1cnJlbnRWYWx1ZSAhPT0gYXBwSWQucHJldmlvdXNWYWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5nZXRGaWx0ZXJzQnlBcHBJZChhcHBJZC5jdXJyZW50VmFsdWUpO1xuICAgICAgICB9IGVsc2UgaWYgKGZpbHRlciAmJiBmaWx0ZXIuY3VycmVudFZhbHVlICE9PSBmaWx0ZXIucHJldmlvdXNWYWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RGaWx0ZXIoZmlsdGVyLmN1cnJlbnRWYWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIHRhc2sgbGlzdCBmaWx0ZXJlZCBieSBhcHBJZCBvciBieSBhcHBOYW1lXG4gICAgICogQHBhcmFtIGFwcElkXG4gICAgICogQHBhcmFtIGFwcE5hbWVcbiAgICAgKi9cbiAgICBnZXRGaWx0ZXJzKGFwcElkPzogbnVtYmVyLCBhcHBOYW1lPzogc3RyaW5nKSB7XG4gICAgICAgIGFwcE5hbWUgPyB0aGlzLmdldEZpbHRlcnNCeUFwcE5hbWUoYXBwTmFtZSkgOiB0aGlzLmdldEZpbHRlcnNCeUFwcElkKGFwcElkKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIGZpbHRlciBsaXN0IGZpbHRlcmVkIGJ5IGFwcElkXG4gICAgICogQHBhcmFtIGFwcElkIC0gb3B0aW9uYWxcbiAgICAgKi9cbiAgICBnZXRGaWx0ZXJzQnlBcHBJZChhcHBJZD86IG51bWJlcikge1xuICAgICAgICB0aGlzLnRhc2tGaWx0ZXJTZXJ2aWNlLmdldFRhc2tMaXN0RmlsdGVycyhhcHBJZCkuc3Vic2NyaWJlKFxuICAgICAgICAgICAgKHJlczogRmlsdGVyUmVwcmVzZW50YXRpb25Nb2RlbFtdKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHJlcy5sZW5ndGggPT09IDAgJiYgdGhpcy5pc0ZpbHRlckxpc3RFbXB0eSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3JlYXRlRmlsdGVyc0J5QXBwSWQoYXBwSWQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVzZXRGaWx0ZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maWx0ZXJzID0gcmVzO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdEZpbHRlcih0aGlzLmZpbHRlclBhcmFtKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdWNjZXNzLmVtaXQocmVzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgKGVycjogYW55KSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5lcnJvci5lbWl0KGVycik7XG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBmaWx0ZXIgbGlzdCBmaWx0ZXJlZCBieSBhcHBOYW1lXG4gICAgICogQHBhcmFtIGFwcE5hbWVcbiAgICAgKi9cbiAgICBnZXRGaWx0ZXJzQnlBcHBOYW1lKGFwcE5hbWU6IHN0cmluZykge1xuICAgICAgICB0aGlzLmFwcHNQcm9jZXNzU2VydmljZS5nZXREZXBsb3llZEFwcGxpY2F0aW9uc0J5TmFtZShhcHBOYW1lKS5zdWJzY3JpYmUoXG4gICAgICAgICAgICAoYXBwbGljYXRpb24pID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmdldEZpbHRlcnNCeUFwcElkKGFwcGxpY2F0aW9uLmlkKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAoZXJyKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5lcnJvci5lbWl0KGVycik7XG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgZGVmYXVsdCBmaWx0ZXJzIGJ5IGFwcElkXG4gICAgICogQHBhcmFtIGFwcElkXG4gICAgICovXG4gICAgY3JlYXRlRmlsdGVyc0J5QXBwSWQoYXBwSWQ/OiBudW1iZXIpIHtcbiAgICAgICAgdGhpcy50YXNrRmlsdGVyU2VydmljZS5jcmVhdGVEZWZhdWx0RmlsdGVycyhhcHBJZCkuc3Vic2NyaWJlKFxuICAgICAgICAgICAgKHJlc0RlZmF1bHQ6IEZpbHRlclJlcHJlc2VudGF0aW9uTW9kZWxbXSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMucmVzZXRGaWx0ZXIoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmZpbHRlcnMgPSByZXNEZWZhdWx0O1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0RmlsdGVyKHRoaXMuZmlsdGVyUGFyYW0pO1xuICAgICAgICAgICAgICAgIHRoaXMuc3VjY2Vzcy5lbWl0KHJlc0RlZmF1bHQpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIChlcnJEZWZhdWx0OiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmVycm9yLmVtaXQoZXJyRGVmYXVsdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUGFzcyB0aGUgc2VsZWN0ZWQgZmlsdGVyIGFzIG5leHRcbiAgICAgKiBAcGFyYW0gZmlsdGVyXG4gICAgICovXG4gICAgcHVibGljIHNlbGVjdEZpbHRlcihuZXdGaWx0ZXI6IEZpbHRlclBhcmFtc01vZGVsKSB7XG4gICAgICAgIGlmIChuZXdGaWx0ZXIpIHtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudEZpbHRlciA9IHRoaXMuZmlsdGVycy5maW5kKCAoZmlsdGVyLCBpbmRleCkgPT5cbiAgICAgICAgICAgICAgICBuZXdGaWx0ZXIuaW5kZXggPT09IGluZGV4IHx8XG4gICAgICAgICAgICAgICAgbmV3RmlsdGVyLmlkID09PSBmaWx0ZXIuaWQgfHxcbiAgICAgICAgICAgICAgICAobmV3RmlsdGVyLm5hbWUgJiZcbiAgICAgICAgICAgICAgICAgICAgKG5ld0ZpbHRlci5uYW1lLnRvTG9jYWxlTG93ZXJDYXNlKCkgPT09IGZpbHRlci5uYW1lLnRvTG9jYWxlTG93ZXJDYXNlKCkpXG4gICAgICAgICAgICAgICAgKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLmN1cnJlbnRGaWx0ZXIpIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0RGVmYXVsdFRhc2tGaWx0ZXIoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBzZWxlY3RGaWx0ZXJBbmRFbWl0KG5ld0ZpbHRlcjogRmlsdGVyUGFyYW1zTW9kZWwpIHtcbiAgICAgICAgdGhpcy5zZWxlY3RGaWx0ZXIobmV3RmlsdGVyKTtcbiAgICAgICAgdGhpcy5maWx0ZXJDbGljay5lbWl0KHRoaXMuY3VycmVudEZpbHRlcik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2VsZWN0IGZpbHRlciB3aXRoIHRhc2tcbiAgICAgKiBAcGFyYW0gdGFza0lkXG4gICAgICovXG4gICAgcHVibGljIHNlbGVjdEZpbHRlcldpdGhUYXNrKHRhc2tJZDogc3RyaW5nKSB7XG4gICAgICAgIGNvbnN0IGZpbHRlcmVkRmlsdGVyTGlzdDogRmlsdGVyUmVwcmVzZW50YXRpb25Nb2RlbFtdID0gW107XG4gICAgICAgIHRoaXMudGFza0xpc3RTZXJ2aWNlLmdldEZpbHRlckZvclRhc2tCeUlkKHRhc2tJZCwgdGhpcy5maWx0ZXJzKS5zdWJzY3JpYmUoXG4gICAgICAgICAgICAoZmlsdGVyOiBGaWx0ZXJSZXByZXNlbnRhdGlvbk1vZGVsKSA9PiB7XG4gICAgICAgICAgICAgICAgZmlsdGVyZWRGaWx0ZXJMaXN0LnB1c2goZmlsdGVyKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAoZXJyKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5lcnJvci5lbWl0KGVycik7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChmaWx0ZXJlZEZpbHRlckxpc3QubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdEZpbHRlcihmaWx0ZXJlZEZpbHRlckxpc3RbMF0pO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbHRlckNsaWNrLmVtaXQodGhpcy5jdXJyZW50RmlsdGVyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZWxlY3QgYXMgZGVmYXVsdCB0YXNrIGZpbHRlciB0aGUgZmlyc3QgaW4gdGhlIGxpc3RcbiAgICAgKiBAcGFyYW0gZmlsdGVyZWRGaWx0ZXJMaXN0XG4gICAgICovXG4gICAgcHVibGljIHNlbGVjdERlZmF1bHRUYXNrRmlsdGVyKCkge1xuICAgICAgICBpZiAoIXRoaXMuaXNGaWx0ZXJMaXN0RW1wdHkoKSkge1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50RmlsdGVyID0gdGhpcy5maWx0ZXJzWzBdO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBjdXJyZW50IHRhc2tcbiAgICAgKi9cbiAgICBnZXRDdXJyZW50RmlsdGVyKCk6IEZpbHRlclJlcHJlc2VudGF0aW9uTW9kZWwge1xuICAgICAgICByZXR1cm4gdGhpcy5jdXJyZW50RmlsdGVyO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrIGlmIHRoZSBmaWx0ZXIgbGlzdCBpcyBlbXB0eVxuICAgICAqL1xuICAgIGlzRmlsdGVyTGlzdEVtcHR5KCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy5maWx0ZXJzID09PSB1bmRlZmluZWQgfHwgKHRoaXMuZmlsdGVycyAmJiB0aGlzLmZpbHRlcnMubGVuZ3RoID09PSAwKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXNldCB0aGUgZmlsdGVycyBwcm9wZXJ0aWVzXG4gICAgICovXG4gICAgcHJpdmF0ZSByZXNldEZpbHRlcigpIHtcbiAgICAgICAgdGhpcy5maWx0ZXJzID0gW107XG4gICAgICAgIHRoaXMuY3VycmVudEZpbHRlciA9IHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gY3VycmVudCBmaWx0ZXIgaWNvblxuICAgICAqL1xuICAgIGdldEZpbHRlckljb24oaWNvbik6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLmljb25zTURMLm1hcEdseXBoaWNvblRvTWF0ZXJpYWxEZXNpZ25JY29ucyhpY29uKTtcbiAgICB9XG59XG4iXX0=