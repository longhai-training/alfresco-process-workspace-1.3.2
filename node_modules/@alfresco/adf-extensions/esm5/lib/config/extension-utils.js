/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/*!
 * @license
 * Copyright 2019 Alfresco Software, Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
import { ContentActionType } from './action.extensions';
/**
 * @param {?} target
 * @param {?} key
 * @return {?}
 */
export function getValue(target, key) {
    if (!target) {
        return undefined;
    }
    /** @type {?} */
    var keys = key.split('.');
    key = '';
    do {
        key += keys.shift();
        /** @type {?} */
        var value = target[key];
        if (value !== undefined &&
            (typeof value === 'object' || !keys.length)) {
            target = value;
            key = '';
        }
        else if (!keys.length) {
            target = undefined;
        }
        else {
            key += '.';
        }
    } while (keys.length);
    return target;
}
/**
 * @param {?} entry
 * @return {?}
 */
export function filterEnabled(entry) {
    return !entry.disabled;
}
/**
 * @param {?} a
 * @param {?} b
 * @return {?}
 */
export function sortByOrder(a, b) {
    /** @type {?} */
    var left = a.order === undefined ? Number.MAX_SAFE_INTEGER : a.order;
    /** @type {?} */
    var right = b.order === undefined ? Number.MAX_SAFE_INTEGER : b.order;
    return left - right;
}
/**
 * @param {?} acc
 * @param {?} el
 * @param {?} i
 * @param {?} arr
 * @return {?}
 */
export function reduceSeparators(acc, el, i, arr) {
    // remove leading separator
    if (i === 0) {
        if (arr[i].type === ContentActionType.separator) {
            return acc;
        }
    }
    // remove duplicate separators
    if (i > 0) {
        /** @type {?} */
        var prev = arr[i - 1];
        if (prev.type === ContentActionType.separator &&
            el.type === ContentActionType.separator) {
            return acc;
        }
        // remove trailing separator
        if (i === arr.length - 1) {
            if (el.type === ContentActionType.separator) {
                return acc;
            }
        }
    }
    return acc.concat(el);
}
/**
 * @param {?} acc
 * @param {?} el
 * @return {?}
 */
export function reduceEmptyMenus(acc, el) {
    if (el.type === ContentActionType.menu) {
        if ((el.children || []).length === 0) {
            return acc;
        }
    }
    return acc.concat(el);
}
/**
 * @param {...?} objects
 * @return {?}
 */
export function mergeObjects() {
    var objects = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        objects[_i] = arguments[_i];
    }
    /** @type {?} */
    var result = {};
    objects.forEach((/**
     * @param {?} source
     * @return {?}
     */
    function (source) {
        Object.keys(source).forEach((/**
         * @param {?} prop
         * @return {?}
         */
        function (prop) {
            if (!prop.startsWith('$')) {
                if (prop in result && Array.isArray(result[prop])) {
                    // result[prop] = result[prop].concat(source[prop]);
                    result[prop] = mergeArrays(result[prop], source[prop]);
                }
                else if (prop in result && typeof result[prop] === 'object') {
                    result[prop] = mergeObjects(result[prop], source[prop]);
                }
                else {
                    result[prop] = source[prop];
                }
            }
        }));
    }));
    return result;
}
/**
 * @param {?} left
 * @param {?} right
 * @return {?}
 */
export function mergeArrays(left, right) {
    /** @type {?} */
    var result = [];
    /** @type {?} */
    var map = {};
    (left || []).forEach((/**
     * @param {?} entry
     * @return {?}
     */
    function (entry) {
        /** @type {?} */
        var element = entry;
        if (element && element.hasOwnProperty('id')) {
            map[element.id] = element;
        }
        else {
            result.push(element);
        }
    }));
    (right || []).forEach((/**
     * @param {?} entry
     * @return {?}
     */
    function (entry) {
        /** @type {?} */
        var element = entry;
        if (element && element.hasOwnProperty('id') && map[element.id]) {
            /** @type {?} */
            var merged = mergeObjects(map[element.id], element);
            map[element.id] = merged;
        }
        else {
            result.push(element);
        }
    }));
    return Object.keys(map).map((/**
     * @param {?} key
     * @return {?}
     */
    function (key) { return map[key]; })).concat(result);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXh0ZW5zaW9uLXV0aWxzLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGFsZnJlc2NvL2FkZi1leHRlbnNpb25zLyIsInNvdXJjZXMiOlsibGliL2NvbmZpZy9leHRlbnNpb24tdXRpbHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFpQkEsT0FBTyxFQUFvQixpQkFBaUIsRUFBRSxNQUFNLHFCQUFxQixDQUFDOzs7Ozs7QUFFMUUsTUFBTSxVQUFVLFFBQVEsQ0FBQyxNQUFXLEVBQUUsR0FBVztJQUM3QyxJQUFJLENBQUMsTUFBTSxFQUFFO1FBQ1QsT0FBTyxTQUFTLENBQUM7S0FDcEI7O1FBRUssSUFBSSxHQUFHLEdBQUcsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDO0lBQzNCLEdBQUcsR0FBRyxFQUFFLENBQUM7SUFFVCxHQUFHO1FBQ0MsR0FBRyxJQUFJLElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQzs7WUFDZCxLQUFLLEdBQUcsTUFBTSxDQUFDLEdBQUcsQ0FBQztRQUN6QixJQUNJLEtBQUssS0FBSyxTQUFTO1lBQ25CLENBQUMsT0FBTyxLQUFLLEtBQUssUUFBUSxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxFQUM3QztZQUNFLE1BQU0sR0FBRyxLQUFLLENBQUM7WUFDZixHQUFHLEdBQUcsRUFBRSxDQUFDO1NBQ1o7YUFBTSxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRTtZQUNyQixNQUFNLEdBQUcsU0FBUyxDQUFDO1NBQ3RCO2FBQU07WUFDSCxHQUFHLElBQUksR0FBRyxDQUFDO1NBQ2Q7S0FDSixRQUFRLElBQUksQ0FBQyxNQUFNLEVBQUU7SUFFdEIsT0FBTyxNQUFNLENBQUM7QUFDbEIsQ0FBQzs7Ozs7QUFFRCxNQUFNLFVBQVUsYUFBYSxDQUFDLEtBQTZCO0lBQ3ZELE9BQU8sQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDO0FBQzNCLENBQUM7Ozs7OztBQUVELE1BQU0sVUFBVSxXQUFXLENBQ3ZC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LENBQUMsQ0FBQyxHQUFHOzs7O0lBQUMsVUFBQyxHQUFHLElBQUssT0FBQSxHQUFHLENBQUMsR0FBRyxDQUFDLEVBQVIsQ0FBUSxFQUFDLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0FBQ2xFLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOSBBbGZyZXNjbyBTb2Z0d2FyZSwgTHRkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBDb250ZW50QWN0aW9uUmVmLCBDb250ZW50QWN0aW9uVHlwZSB9IGZyb20gJy4vYWN0aW9uLmV4dGVuc2lvbnMnO1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0VmFsdWUodGFyZ2V0OiBhbnksIGtleTogc3RyaW5nKTogYW55IHtcbiAgICBpZiAoIXRhcmdldCkge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIGNvbnN0IGtleXMgPSBrZXkuc3BsaXQoJy4nKTtcbiAgICBrZXkgPSAnJztcblxuICAgIGRvIHtcbiAgICAgICAga2V5ICs9IGtleXMuc2hpZnQoKTtcbiAgICAgICAgY29uc3QgdmFsdWUgPSB0YXJnZXRba2V5XTtcbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgdmFsdWUgIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgKHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgfHwgIWtleXMubGVuZ3RoKVxuICAgICAgICApIHtcbiAgICAgICAgICAgIHRhcmdldCA9IHZhbHVlO1xuICAgICAgICAgICAga2V5ID0gJyc7XG4gICAgICAgIH0gZWxzZSBpZiAoIWtleXMubGVuZ3RoKSB7XG4gICAgICAgICAgICB0YXJnZXQgPSB1bmRlZmluZWQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBrZXkgKz0gJy4nO1xuICAgICAgICB9XG4gICAgfSB3aGlsZSAoa2V5cy5sZW5ndGgpO1xuXG4gICAgcmV0dXJuIHRhcmdldDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZpbHRlckVuYWJsZWQoZW50cnk6IHsgZGlzYWJsZWQ/OiBib29sZWFuIH0pOiBib29sZWFuIHtcbiAgICByZXR1cm4gIWVudHJ5LmRpc2FibGVkO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc29ydEJ5T3JkZXIoXG4gICAgYTogeyBvcmRlcj86IG51bWJlciB8IHVuZGVmaW5lZCB9LFxuICAgIGI6IHsgb3JkZXI/OiBudW1iZXIgfCB1bmRlZmluZWQgfVxuKSB7XG4gICAgY29uc3QgbGVmdCA9IGEub3JkZXIgPT09IHVuZGVmaW5lZCA/IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSIDogYS5vcmRlcjtcbiAgICBjb25zdCByaWdodCA9IGIub3JkZXIgPT09IHVuZGVmaW5lZCA/IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSIDogYi5vcmRlcjtcbiAgICByZXR1cm4gbGVmdCAtIHJpZ2h0O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVkdWNlU2VwYXJhdG9ycyhcbiAgICBhY2M6IENvbnRlbnRBY3Rpb25SZWZbXSxcbiAgICBlbDogQ29udGVudEFjdGlvblJlZixcbiAgICBpOiBudW1iZXIsXG4gICAgYXJyOiBDb250ZW50QWN0aW9uUmVmW11cbik6IENvbnRlbnRBY3Rpb25SZWZbXSB7XG4gICAgLy8gcmVtb3ZlIGxlYWRpbmcgc2VwYXJhdG9yXG4gICAgaWYgKGkgPT09IDApIHtcbiAgICAgICAgaWYgKGFycltpXS50eXBlID09PSBDb250ZW50QWN0aW9uVHlwZS5zZXBhcmF0b3IpIHtcbiAgICAgICAgICAgIHJldHVybiBhY2M7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy8gcmVtb3ZlIGR1cGxpY2F0ZSBzZXBhcmF0b3JzXG4gICAgaWYgKGkgPiAwKSB7XG4gICAgICAgIGNvbnN0IHByZXYgPSBhcnJbaSAtIDFdO1xuICAgICAgICBpZiAoXG4gICAgICAgICAgICBwcmV2LnR5cGUgPT09IENvbnRlbnRBY3Rpb25UeXBlLnNlcGFyYXRvciAmJlxuICAgICAgICAgICAgZWwudHlwZSA9PT0gQ29udGVudEFjdGlvblR5cGUuc2VwYXJhdG9yXG4gICAgICAgICkge1xuICAgICAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHJlbW92ZSB0cmFpbGluZyBzZXBhcmF0b3JcbiAgICAgICAgaWYgKGkgPT09IGFyci5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICBpZiAoZWwudHlwZSA9PT0gQ29udGVudEFjdGlvblR5cGUuc2VwYXJhdG9yKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBhY2MuY29uY2F0KGVsKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlZHVjZUVtcHR5TWVudXMoXG4gICAgYWNjOiBDb250ZW50QWN0aW9uUmVmW10sXG4gICAgZWw6IENvbnRlbnRBY3Rpb25SZWZcbik6IENvbnRlbnRBY3Rpb25SZWZbXSB7XG4gICAgaWYgKGVsLnR5cGUgPT09IENvbnRlbnRBY3Rpb25UeXBlLm1lbnUpIHtcbiAgICAgICAgaWYgKChlbC5jaGlsZHJlbiB8fCBbXSkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gYWNjO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBhY2MuY29uY2F0KGVsKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG1lcmdlT2JqZWN0cyguLi5vYmplY3RzKTogYW55IHtcbiAgICBjb25zdCByZXN1bHQgPSB7fTtcblxuICAgIG9iamVjdHMuZm9yRWFjaCgoc291cmNlKSA9PiB7XG4gICAgICAgIE9iamVjdC5rZXlzKHNvdXJjZSkuZm9yRWFjaCgocHJvcCkgPT4ge1xuICAgICAgICAgICAgaWYgKCFwcm9wLnN0YXJ0c1dpdGgoJyQnKSkge1xuICAgICAgICAgICAgICAgIGlmIChwcm9wIGluIHJlc3VsdCAmJiBBcnJheS5pc0FycmF5KHJlc3VsdFtwcm9wXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gcmVzdWx0W3Byb3BdID0gcmVzdWx0W3Byb3BdLmNvbmNhdChzb3VyY2VbcHJvcF0pO1xuICAgICAgICAgICAgICAgICAgICByZXN1bHRbcHJvcF0gPSBtZXJnZUFycmF5cyhyZXN1bHRbcHJvcF0sIHNvdXJjZVtwcm9wXSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChwcm9wIGluIHJlc3VsdCAmJiB0eXBlb2YgcmVzdWx0W3Byb3BdID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHRbcHJvcF0gPSBtZXJnZU9iamVjdHMocmVzdWx0W3Byb3BdLCBzb3VyY2VbcHJvcF0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFtwcm9wXSA9IHNvdXJjZVtwcm9wXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG1lcmdlQXJyYXlzKGxlZnQ6IGFueVtdLCByaWdodDogYW55W10pOiBhbnlbXSB7XG4gICAgY29uc3QgcmVzdWx0ID0gW107XG4gICAgY29uc3QgbWFwID0ge307XG5cbiAgICAobGVmdCB8fCBbXSkuZm9yRWFjaCgoZW50cnkpID0+IHtcbiAgICAgICAgY29uc3QgZWxlbWVudCA9IGVudHJ5O1xuICAgICAgICBpZiAoZWxlbWVudCAmJiBlbGVtZW50Lmhhc093blByb3BlcnR5KCdpZCcpKSB7XG4gICAgICAgICAgICBtYXBbZWxlbWVudC5pZF0gPSBlbGVtZW50O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVzdWx0LnB1c2goZWxlbWVudCk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIChyaWdodCB8fCBbXSkuZm9yRWFjaCgoZW50cnkpID0+IHtcbiAgICAgICAgY29uc3QgZWxlbWVudCA9IGVudHJ5O1xuICAgICAgICBpZiAoZWxlbWVudCAmJiBlbGVtZW50Lmhhc093blByb3BlcnR5KCdpZCcpICYmIG1hcFtlbGVtZW50LmlkXSkge1xuICAgICAgICAgICAgY29uc3QgbWVyZ2VkID0gbWVyZ2VPYmplY3RzKG1hcFtlbGVtZW50LmlkXSwgZWxlbWVudCk7XG4gICAgICAgICAgICBtYXBbZWxlbWVudC5pZF0gPSBtZXJnZWQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXN1bHQucHVzaChlbGVtZW50KTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKG1hcCkubWFwKChrZXkpID0+IG1hcFtrZXldKS5jb25jYXQocmVzdWx0KTtcbn1cbiJdfQ==