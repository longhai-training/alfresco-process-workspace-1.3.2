/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/*!
 * @license
 * Copyright 2019 Alfresco Software, Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
import { ContentService, LogService } from '@alfresco/adf-core';
import { Component, EventEmitter, Input, Output, ViewChild, ViewEncapsulation } from '@angular/core';
import { FormBuilder, FormControl, FormGroup, Validators } from '@angular/forms';
import { MatDialog } from '@angular/material';
import moment from 'moment-es6';
import { ReportQuery } from '../../diagram/models/report/reportQuery.model';
import { AnalyticsService } from '../services/analytics.service';
export class AnalyticsReportParametersComponent {
    /**
     * @param {?} analyticsService
     * @param {?} formBuilder
     * @param {?} logService
     * @param {?} contentService
     * @param {?} dialog
     */
    constructor(analyticsService, formBuilder, logService, contentService, dialog) {
        this.analyticsService = analyticsService;
        this.formBuilder = formBuilder;
        this.logService = logService;
        this.contentService = contentService;
        this.dialog = dialog;
        this.hideComponent = false;
        this.success = new EventEmitter();
        this.error = new EventEmitter();
        this.edit = new EventEmitter();
        this.formValueChanged = new EventEmitter();
        this.saveReportSuccess = new EventEmitter();
        this.deleteReportSuccess = new EventEmitter();
        this.onDropdownChanged = new EventEmitter();
        this.successReportParams = new EventEmitter();
        this.successParamOpt = new EventEmitter();
        this.isEditable = false;
        this.hideParameters = true;
        this.formValidState = false;
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.dropDownSub = this.onDropdownChanged.subscribe((/**
         * @param {?} field
         * @return {?}
         */
        (field) => {
            /** @type {?} */
            const paramDependOn = this.reportParameters.definition.parameters.find((/**
             * @param {?} p
             * @return {?}
             */
            (p) => p.dependsOn === field.id));
            if (paramDependOn) {
                this.retrieveParameterOptions(this.reportParameters.definition.parameters, this.appId, this.reportId, field.value);
            }
        }));
        this.paramOpts = this.successReportParams.subscribe((/**
         * @param {?} report
         * @return {?}
         */
        (report) => {
            if (report.hasParameters()) {
                this.retrieveParameterOptions(report.definition.parameters, this.appId);
                this.generateFormGroupFromParameter(report.definition.parameters);
            }
        }));
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
        this.isEditable = false;
        if (this.reportForm) {
            this.reportForm.reset();
        }
        /** @type {?} */
        const reportId = changes['reportId'];
        if (reportId && reportId.currentValue) {
            this.reportId = reportId.currentValue;
            this.getReportParams(reportId.currentValue);
        }
        /** @type {?} */
        const appId = changes['appId'];
        if (appId && (appId.currentValue || appId.currentValue === null)) {
            this.getReportParams(this.reportId);
        }
    }
    /**
     * @private
     * @param {?} parameters
     * @return {?}
     */
    generateFormGroupFromParameter(parameters) {
        /** @type {?} */
        const formBuilderGroup = {};
        parameters.forEach((/**
         * @param {?} param
         * @return {?}
         */
        (param) => {
            switch (param.type) {
                case 'dateRange':
                    formBuilderGroup.dateRange = new FormGroup({}, Validators.required);
                    break;
                case 'processDefinition':
                    formBuilderGroup.processDefGroup = new FormGroup({
                        processDefinitionId: new FormControl(null, Validators.required, null)
                    }, Validators.required);
                    break;
                case 'duration':
                    formBuilderGroup.durationGroup = new FormGroup({
                        duration: new FormControl(null, Validators.required, null)
                    }, Validators.required);
                    break;
                case 'dateInterval':
                    formBuilderGroup.dateIntervalGroup = new FormGroup({
                        dateRangeInterval: new FormControl(null, Validators.required, null)
                    }, Validators.required);
                    break;
                case 'boolean':
                    formBuilderGroup.typeFilteringGroup = new FormGroup({
                        typeFiltering: new FormControl(null, Validators.required, null)
                    }, Validators.required);
                    break;
                case 'task':
                    formBuilderGroup.taskGroup = new FormGroup({
                        taskName: new FormControl(null, Validators.required, null)
                    }, Validators.required);
                    break;
                case 'integer':
                    formBuilderGroup.processInstanceGroup = new FormGroup({
                        slowProcessInstanceInteger: new FormControl(null, Validators.required, null)
                    }, Validators.required);
                    break;
                case 'status':
                    formBuilderGroup.statusGroup = new FormGroup({
                        status: new FormControl(null, Validators.required, null)
                    }, Validators.required);
                    break;
                default:
                    return;
            }
        }));
        this.reportForm = this.formBuilder.group(formBuilderGroup);
        this.reportForm.valueChanges.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        (data) => this.onValueChanged(data)));
        this.reportForm.statusChanges.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        (data) => this.onStatusChanged(data)));
    }
    /**
     * @param {?} reportId
     * @return {?}
     */
    getReportParams(reportId) {
        this.reportParamsSub = this.analyticsService.getReportParams(reportId).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        (res) => {
            this.reportParameters = res;
            if (this.reportParameters.hasParameters()) {
                this.successReportParams.emit(res);
            }
            else {
                this.reportForm = this.formBuilder.group({});
                this.success.emit();
            }
        }), (/**
         * @param {?} err
         * @return {?}
         */
        (err) => {
            this.error.emit(err);
        }));
    }
    /**
     * @private
     * @param {?} parameters
     * @param {?} appId
     * @param {?=} reportId
     * @param {?=} processDefinitionId
     * @return {?}
     */
    retrieveParameterOptions(parameters, appId, reportId, processDefinitionId) {
        parameters.forEach((/**
         * @param {?} param
         * @return {?}
         */
        (param) => {
            this.analyticsService.getParamValuesByType(param.type, appId, reportId, processDefinitionId).subscribe((/**
             * @param {?} opts
             * @return {?}
             */
            (opts) => {
                param.options = opts;
                this.successParamOpt.emit(opts);
            }), (/**
             * @param {?} err
             * @return {?}
             */
            (err) => {
                this.error.emit(err);
            }));
        }));
    }
    /**
     * @param {?} field
     * @return {?}
     */
    onProcessDefinitionChanges(field) {
        if (field.value) {
            this.onDropdownChanged.emit(field);
        }
    }
    /**
     * @param {?} values
     * @return {?}
     */
    submit(values) {
        this.reportParamQuery = this.convertFormValuesToReportParamQuery(values);
        this.success.emit(this.reportParamQuery);
    }
    /**
     * @param {?} values
     * @return {?}
     */
    onValueChanged(values) {
        this.formValueChanged.emit(values);
        if (this.reportForm && this.reportForm.valid) {
            this.submit(values);
        }
    }
    /**
     * @param {?} status
     * @return {?}
     */
    onStatusChanged(status) {
        if (this.reportForm && !this.reportForm.pending && this.reportForm.dirty) {
            this.formValidState = this.reportForm.valid;
        }
    }
    /**
     * @param {?} date
     * @return {?}
     */
    convertMomentDate(date) {
        return moment(date, AnalyticsReportParametersComponent.FORMAT_DATE_ACTIVITI, true)
            .format(AnalyticsReportParametersComponent.FORMAT_DATE_ACTIVITI) + 'T00:00:00.000Z';
    }
    /**
     * @return {?}
     */
    getTodayDate() {
        return moment().format(AnalyticsReportParametersComponent.FORMAT_DATE_ACTIVITI);
    }
    /**
     * @param {?} value
     * @return {?}
     */
    convertNumber(value) {
        return value != null ? parseInt(value, 10) : 0;
    }
    /**
     * @param {?} values
     * @return {?}
     */
    convertFormValuesToReportParamQuery(values) {
        /** @type {?} */
        const reportParamQuery = new ReportQuery();
        if (values.dateRange) {
            reportParamQuery.dateRange.startDate = this.convertMomentDate(values.dateRange.startDate);
            reportParamQuery.dateRange.endDate = this.convertMomentDate(values.dateRange.endDate);
        }
        if (values.statusGroup) {
            reportParamQuery.status = values.statusGroup.status;
        }
        if (values.processDefGroup) {
            reportParamQuery.processDefinitionId = values.processDefGroup.processDefinitionId;
        }
        if (values.taskGroup) {
            reportParamQuery.taskName = values.taskGroup.taskName;
        }
        if (values.durationGroup) {
            reportParamQuery.duration = values.durationGroup.duration;
        }
        if (values.dateIntervalGroup) {
            reportParamQuery.dateRangeInterval = values.dateIntervalGroup.dateRangeInterval;
        }
        if (values.processInstanceGroup) {
            reportParamQuery.slowProcessInstanceInteger = this.convertNumber(values.processInstanceGroup.slowProcessInstanceInteger);
        }
        if (values.typeFilteringGroup) {
            reportParamQuery.typeFiltering = values.typeFilteringGroup.typeFiltering;
        }
        return reportParamQuery;
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        this.dropDownSub.unsubscribe();
        this.paramOpts.unsubscribe();
        if (this.reportParamsSub) {
            this.reportParamsSub.unsubscribe();
        }
    }
    /**
     * @return {?}
     */
    editEnable() {
        this.isEditable = true;
    }
    /**
     * @return {?}
     */
    editDisable() {
        this.isEditable = false;
    }
    /**
     * @return {?}
     */
    editTitle() {
        this.reportParamsSub = this.analyticsService.updateReport(this.reportParameters.id, this.reportParameters.name).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        (res) => {
            this.editDisable();
            this.edit.emit(this.reportParameters.name);
        }), (/**
         * @param {?} err
         * @return {?}
         */
        (err) => {
            this.error.emit(err);
        }));
    }
    /**
     * @param {?} event
     * @return {?}
     */
    showDialog(event) {
        this.dialog.open(this.reportNameDialog, { width: '500px' });
        this.action = event;
        this.reportName = this.reportParameters.name + ' ( ' + this.getTodayDate() + ' )';
    }
    /**
     * @return {?}
     */
    closeDialog() {
        this.dialog.closeAll();
    }
    /**
     * @param {?} action
     * @param {?} reportParamQuery
     * @return {?}
     */
    performAction(action, reportParamQuery) {
        reportParamQuery.reportName = this.reportName;
        this.closeDialog();
        if (action === 'Save') {
            this.doSave(reportParamQuery);
        }
        else if (action === 'Export') {
            this.doExport(reportParamQuery);
        }
        this.resetActions();
    }
    /**
     * @return {?}
     */
    resetActions() {
        this.action = '';
        this.reportName = '';
    }
    /**
     * @return {?}
     */
    isSaveAction() {
        return this.action === 'Save';
    }
    /**
     * @param {?} paramQuery
     * @return {?}
     */
    doExport(paramQuery) {
        this.analyticsService.exportReportToCsv(this.reportId, paramQuery).subscribe((/**
         * @param {?} data
         * @return {?}
         */
        (data) => {
            /** @type {?} */
            const blob = new Blob([data], { type: 'text/csv' });
            this.contentService.downloadBlob(blob, paramQuery.reportName + '.csv');
        }));
    }
    /**
     * @param {?} paramQuery
     * @return {?}
     */
    doSave(paramQuery) {
        this.analyticsService.saveReport(this.reportId, paramQuery).subscribe((/**
         * @return {?}
         */
        () => {
            this.saveReportSuccess.emit(this.reportId);
        }));
    }
    /**
     * @param {?} reportId
     * @return {?}
     */
    deleteReport(reportId) {
        this.analyticsService.deleteReport(reportId).subscribe((/**
         * @return {?}
         */
        () => {
            this.deleteReportSuccess.emit(reportId);
        }), (/**
         * @param {?} error
         * @return {?}
         */
        (error) => this.logService.error(error)));
    }
    /**
     * @return {?}
     */
    ngAfterContentChecked() {
        if (this.reportForm && this.reportForm.valid) {
            this.reportForm.markAsDirty();
        }
    }
    /**
     * @return {?}
     */
    toggleParameters() {
        this.hideParameters = !this.hideParameters;
    }
    /**
     * @return {?}
     */
    isParametersHide() {
        return this.hideParameters;
    }
    /**
     * @return {?}
     */
    isFormValid() {
        return this.reportForm && this.reportForm.dirty && this.reportForm.valid;
    }
}
AnalyticsReportParametersComponent.FORMAT_DATE_ACTIVITI = 'YYYY-MM-DD';
AnalyticsReportParametersComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-analytics-report-parameters',
                template: "<div [class.adf-hide]=\"hideComponent\">\n    <div class=\"adf-report-report-container\">\n        <div *ngIf=\"reportParameters\">\n            <form [formGroup]=\"reportForm\" novalidate>\n                <adf-toolbar>\n                    <adf-toolbar-title class=\"adf-report-title-container\">\n                        <div *ngIf=\"isEditable\">\n                            <mat-form-field class=\"adf-full-width-input\">\n                                <input\n                                    matInput\n                                    type=\"text\"\n                                    class=\"adf-edit-report-title\"\n                                    id=\"reportName\"\n                                    autofocus\n                                    data-automation-id=\"reportName\"\n                                    [value]=\"reportParameters.name\"\n                                    (input)=\"reportParameters.name=$event.target.value\"\n                                    (blur)=\"editTitle()\"\n                                    (keyup.enter)=\"editTitle()\"\n                                />\n                            </mat-form-field>\n                        </div>\n                        <div class=\"adf-report-title\" *ngIf=\"!isEditable\" (click)=\"editEnable()\">\n                            <mat-icon class=\"adf-report-icon\" >mode_edit</mat-icon>\n                            <h4>{{reportParameters.name}}</h4>\n                        </div>\n                    </adf-toolbar-title>\n                    <adf-buttons-action-menu *ngIf=\"!isEditable\">\n                        <button mat-menu-item (click)=\"toggleParameters()\" id=\"\">\n                            <mat-icon>settings</mat-icon><span>{{ 'ANALYTICS.MESSAGES.ICON-SETTING' | translate }}</span>\n                        </button>\n                        <button mat-menu-item (click)=\"deleteReport(reportId)\" id=\"delete-button\">\n                            <mat-icon>delete</mat-icon><span>{{ 'ANALYTICS.MESSAGES.ICON-DELETE' | translate }}</span>\n                        </button>\n                        <div *ngIf=\"isFormValid()\">\n                            <button mat-menu-item (click)=\"showDialog('Export')\" id=\"export-button\">\n                                <mat-icon>file_download</mat-icon><span>{{ 'ANALYTICS.MESSAGES.ICON-EXPORT-CSV' | translate }}</span>\n                            </button>\n                            <button mat-menu-item (click)=\"showDialog('Save')\" id=\"save-button\">\n                                <mat-icon>save</mat-icon><span>{{ 'ANALYTICS.MESSAGES.ICON-SAVE' | translate }}</span>\n                            </button>\n                        </div>\n                    </adf-buttons-action-menu>\n                </adf-toolbar>\n                <div *ngFor=\"let field of reportParameters.definition.parameters\"\n                        [class.adf-is-hide]=\"isParametersHide()\">\n                    <div [ngSwitch]=\"field.type\">\n                        <div *ngSwitchCase=\"'integer'\">\n                            <br>\n                            <analytics-number-widget [field]=\"field\" [group]=\"reportForm.controls.processInstanceGroup\"\n                                            [controllerName]=\"'slowProcessInstanceInteger'\"\n                                            [required]=\"true\"></analytics-number-widget>\n                        </div>\n                        <div *ngSwitchCase=\"'duration'\">\n                            <br>\n                            <duration-widget [field]=\"field\" [group]=\"reportForm.controls.durationGroup\"\n                                                [controllerName]=\"'duration'\"></duration-widget>\n                        </div>\n                        <div *ngSwitchCase=\"'boolean'\">\n                            <br>\n                            <analytics-checkbox-widget [field]=\"field\" [group]=\"reportForm.controls.typeFilteringGroup\"\n                                                [controllerName]=\"'typeFiltering'\"></analytics-checkbox-widget>\n                        </div>\n                        <div *ngSwitchCase=\"'status'\">\n                            <br>\n                            <analytics-dropdown-widget [field]=\"field\" [group]=\"reportForm.controls.statusGroup\"\n                                                [controllerName]=\"'status'\"\n                                                [required]=\"true\"></analytics-dropdown-widget>\n                        </div>\n                        <div *ngSwitchCase=\"'processDefinition'\">\n                            <br>\n                            <analytics-dropdown-widget [field]=\"field\" [group]=\"reportForm.controls.processDefGroup\"\n                                                [controllerName]=\"'processDefinitionId'\"\n                                                [required]=\"true\"\n                                                (fieldChanged)=\"onProcessDefinitionChanges(field)\"></analytics-dropdown-widget>\n                        </div>\n                        <div *ngSwitchCase=\"'task'\">\n                            <br>\n                            <analytics-dropdown-widget [field]=\"field\" [group]=\"reportForm.controls.taskGroup\"\n                                                [controllerName]=\"'taskName'\"\n                                                [required]=\"true\"></analytics-dropdown-widget>\n                        </div>\n                        <div *ngSwitchCase=\"'dateRange'\">\n                            <br>\n                            <adf-date-range-widget [field]=\"field\"\n                                                    [group]=\"reportForm.controls.dateRange\"></adf-date-range-widget>\n                        </div>\n                        <div *ngSwitchCase=\"'dateInterval'\">\n                            <br>\n                            <analytics-dropdown-widget [field]=\"field\" [group]=\"reportForm.controls.dateIntervalGroup\"\n                                                [controllerName]=\"'dateRangeInterval'\"\n                                                [required]=\"true\" [showDefaultOption]=\"false\"></analytics-dropdown-widget>\n                        </div>\n                        <div *ngSwitchDefault>\n                            <span>{{'ANALYTICS.MESSAGES.UNKNOWN-WIDGET-TYPE' | translate}}: {{field.type}}</span>\n                        </div>\n                    </div>\n                </div>\n                <ng-template #reportNameDialog>\n                    <div id=\"report-dialog\" class=\"adf-report-dialog\">\n                        <h5 matDialogTitle id=\"report-dialog-title\">{{action}} report</h5>\n                        <div mat-dialog-content>\n                            <div *ngIf=\"isSaveAction()\" id=\"save-title-submessage\" class=\"adf-export-message\">\n                                {{'DIALOG.SAVE_MESSAGE' | translate}}\n                            </div>\n                            <div class=\"adf-save-export-input\">\n                                <mat-form-field class=\"adf-example-full-width\" floatPlaceholder=\"always\">\n                                    <input matInput\n                                        type=\"text\"\n                                        id=\"repName\"\n                                        placeholder=\"Report Name\"\n                                        [value]=\"reportName\"\n                                        [(ngModel)]=\"reportName\"\n                                        [ngModelOptions]=\"{standalone: true}\">\n                                </mat-form-field>\n                            </div>\n                        </div>\n                        <div mat-dialog-actions>\n                            <button mat-button\n                                color=\"accent\"\n                                type=\"button\"\n                                id=\"close-dialog-button\"\n                                (click)=\"closeDialog()\">Close</button>\n                            <button mat-button\n                                color=\"primary\"\n                                type=\"button\"\n                                id=\"action-dialog-button\"\n                                (click)=\"performAction(action, reportParamQuery)\">{{action}}</button>\n                        </div>\n                    </div>\n                </ng-template>\n            </form>\n        </div>\n    </div>\n</div>\n",
                encapsulation: ViewEncapsulation.None,
                styles: [""]
            }] }
];
/** @nocollapse */
AnalyticsReportParametersComponent.ctorParameters = () => [
    { type: AnalyticsService },
    { type: FormBuilder },
    { type: LogService },
    { type: ContentService },
    { type: MatDialog }
];
AnalyticsReportParametersComponent.propDecorators = {
    appId: [{ type: Input }],
    reportId: [{ type: Input }],
    hideComponent: [{ type: Input }],
    success: [{ type: Output }],
    error: [{ type: Output }],
    edit: [{ type: Output }],
    formValueChanged: [{ type: Output }],
    saveReportSuccess: [{ type: Output }],
    deleteReportSuccess: [{ type: Output }],
    reportNameDialog: [{ type: ViewChild, args: ['reportNameDialog',] }]
};
if (false) {
    /** @type {?} */
    AnalyticsReportParametersComponent.FORMAT_DATE_ACTIVITI;
    /** @type {?} */
    AnalyticsReportParametersComponent.prototype.appId;
    /** @type {?} */
    AnalyticsReportParametersComponent.prototype.reportId;
    /** @type {?} */
    AnalyticsReportParametersComponent.prototype.hideComponent;
    /** @type {?} */
    AnalyticsReportParametersComponent.prototype.success;
    /** @type {?} */
    AnalyticsReportParametersComponent.prototype.error;
    /** @type {?} */
    AnalyticsReportParametersComponent.prototype.edit;
    /** @type {?} */
    AnalyticsReportParametersComponent.prototype.formValueChanged;
    /** @type {?} */
    AnalyticsReportParametersComponent.prototype.saveReportSuccess;
    /** @type {?} */
    AnalyticsReportParametersComponent.prototype.deleteReportSuccess;
    /** @type {?} */
    AnalyticsReportParametersComponent.prototype.reportNameDialog;
    /** @type {?} */
    AnalyticsReportParametersComponent.prototype.onDropdownChanged;
    /** @type {?} */
    AnalyticsReportParametersComponent.prototype.successReportParams;
    /** @type {?} */
    AnalyticsReportParametersComponent.prototype.successParamOpt;
    /** @type {?} */
    AnalyticsReportParametersComponent.prototype.reportParameters;
    /** @type {?} */
    AnalyticsReportParametersComponent.prototype.reportForm;
    /** @type {?} */
    AnalyticsReportParametersComponent.prototype.action;
    /** @type {?} */
    AnalyticsReportParametersComponent.prototype.isEditable;
    /** @type {?} */
    AnalyticsReportParametersComponent.prototype.reportName;
    /**
     * @type {?}
     * @private
     */
    AnalyticsReportParametersComponent.prototype.dropDownSub;
    /**
     * @type {?}
     * @private
     */
    AnalyticsReportParametersComponent.prototype.reportParamsSub;
    /**
     * @type {?}
     * @private
     */
    AnalyticsReportParametersComponent.prototype.paramOpts;
    /** @type {?} */
    AnalyticsReportParametersComponent.prototype.reportParamQuery;
    /**
     * @type {?}
     * @private
     */
    AnalyticsReportParametersComponent.prototype.hideParameters;
    /** @type {?} */
    AnalyticsReportParametersComponent.prototype.formValidState;
    /**
     * @type {?}
     * @private
     */
    AnalyticsReportParametersComponent.prototype.analyticsService;
    /**
     * @type {?}
     * @private
     */
    AnalyticsReportParametersComponent.prototype.formBuilder;
    /**
     * @type {?}
     * @private
     */
    AnalyticsReportParametersComponent.prototype.logService;
    /**
     * @type {?}
     * @private
     */
    AnalyticsReportParametersComponent.prototype.contentService;
    /**
     * @type {?}
     * @private
     */
    AnalyticsReportParametersComponent.prototype.dialog;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYW5hbHl0aWNzLXJlcG9ydC1wYXJhbWV0ZXJzLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BhbGZyZXNjby9hZGYtaW5zaWdodHMvIiwic291cmNlcyI6WyJhbmFseXRpY3MtcHJvY2Vzcy9jb21wb25lbnRzL2FuYWx5dGljcy1yZXBvcnQtcGFyYW1ldGVycy5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFpQkEsT0FBTyxFQUFFLGNBQWMsRUFBRSxVQUFVLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQUNoRSxPQUFPLEVBRUgsU0FBUyxFQUNULFlBQVksRUFDWixLQUFLLEVBSUwsTUFBTSxFQUVOLFNBQVMsRUFDVCxpQkFBaUIsRUFDcEIsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFFLFdBQVcsRUFBRSxXQUFXLEVBQUUsU0FBUyxFQUFFLFVBQVUsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ2pGLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUM5QyxPQUFPLE1BQU0sTUFBTSxZQUFZLENBQUM7QUFJaEMsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLCtDQUErQyxDQUFDO0FBQzVFLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLCtCQUErQixDQUFDO0FBUWpFLE1BQU0sT0FBTyxrQ0FBa0M7Ozs7Ozs7O0lBeUQzQyxZQUFvQixnQkFBa0MsRUFDbEMsV0FBd0IsRUFDeEIsVUFBc0IsRUFDdEIsY0FBOEIsRUFDOUIsTUFBaUI7UUFKakIscUJBQWdCLEdBQWhCLGdCQUFnQixDQUFrQjtRQUNsQyxnQkFBVyxHQUFYLFdBQVcsQ0FBYTtRQUN4QixlQUFVLEdBQVYsVUFBVSxDQUFZO1FBQ3RCLG1CQUFjLEdBQWQsY0FBYyxDQUFnQjtRQUM5QixXQUFNLEdBQU4sTUFBTSxDQUFXO1FBbERyQyxrQkFBYSxHQUFZLEtBQUssQ0FBQztRQUcvQixZQUFPLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUc3QixVQUFLLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUczQixTQUFJLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUcxQixxQkFBZ0IsR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO1FBR3RDLHNCQUFpQixHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7UUFHdkMsd0JBQW1CLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUt6QyxzQkFBaUIsR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO1FBRXZDLHdCQUFtQixHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7UUFFekMsb0JBQWUsR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO1FBUXJDLGVBQVUsR0FBWSxLQUFLLENBQUM7UUFRcEIsbUJBQWMsR0FBWSxJQUFJLENBQUM7UUFDdkMsbUJBQWMsR0FBWSxLQUFLLENBQUM7SUFRaEMsQ0FBQzs7OztJQUVELFFBQVE7UUFDSixJQUFJLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxTQUFTOzs7O1FBQUMsQ0FBQyxLQUFLLEVBQUUsRUFBRTs7a0JBQ3BELGFBQWEsR0FBZ0MsSUFBSSxDQUFDLGdCQUFnQixDQUFDLFVBQVUsQ0FBQyxVQUFVLENBQUMsSUFBSTs7OztZQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsU0FBUyxLQUFLLEtBQUssQ0FBQyxFQUFFLEVBQUM7WUFDcEksSUFBSSxhQUFhLEVBQUU7Z0JBQ2YsSUFBSSxDQUFDLHdCQUF3QixDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxVQUFVLENBQUMsVUFBVSxFQUFFLElBQUksQ0FBQyxLQUFLLEVBQUUsSUFBSSxDQUFDLFFBQVEsRUFBRSxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUM7YUFDdEg7UUFDTCxDQUFDLEVBQUMsQ0FBQztRQUVILElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDLG1CQUFtQixDQUFDLFNBQVM7Ozs7UUFBQyxDQUFDLE1BQTZCLEVBQUUsRUFBRTtZQUNsRixJQUFJLE1BQU0sQ0FBQyxhQUFhLEVBQUUsRUFBRTtnQkFDeEIsSUFBSSxDQUFDLHdCQUF3QixDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsVUFBVSxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztnQkFDeEUsSUFBSSxDQUFDLDhCQUE4QixDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsVUFBVSxDQUFDLENBQUM7YUFDckU7UUFDTCxDQUFDLEVBQUMsQ0FBQztJQUNQLENBQUM7Ozs7O0lBRUQsV0FBVyxDQUFDLE9BQXNCO1FBQzlCLElBQUksQ0FBQyxVQUFVLEdBQUcsS0FBSyxDQUFDO1FBQ3hCLElBQUksSUFBSSxDQUFDLFVBQVUsRUFBRTtZQUNqQixJQUFJLENBQUMsVUFBVSxDQUFDLEtBQUssRUFBRSxDQUFDO1NBQzNCOztjQUVLLFFBQVEsR0FBRyxPQUFPLENBQUMsVUFBVSxDQUFDO1FBQ3BDLElBQUksUUFBUSxJQUFJLFFBQVEsQ0FBQyxZQUFZLEVBQUU7WUFDbkMsSUFBSSxDQUFDLFFBQVEsR0FBRyxRQUFRLENBQUMsWUFBWSxDQUFDO1lBQ3RDLElBQUksQ0FBQyxlQUFlLENBQUMsUUFBUSxDQUFDLFlBQVksQ0FBQyxDQUFDO1NBQy9DOztjQUVLLEtBQUssR0FBRyxPQUFPLENBQUMsT0FBTyxDQUFDO1FBQzlCLElBQUksS0FBSyxJQUFJLENBQUMsS0FBSyxDQUFDLFlBQVksSUFBSSxLQUFLLENBQUMsWUFBWSxLQUFLLElBQUksQ0FBQyxFQUFFO1lBQzlELElBQUksQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1NBQ3ZDO0lBQ0wsQ0FBQzs7Ozs7O0lBRU8sOEJBQThCLENBQUMsVUFBeUM7O2NBQ3RFLGdCQUFnQixHQUFRLEVBQUU7UUFDaEMsVUFBVSxDQUFDLE9BQU87Ozs7UUFBQyxDQUFDLEtBQWtDLEVBQUUsRUFBRTtZQUN0RCxRQUFRLEtBQUssQ0FBQyxJQUFJLEVBQUU7Z0JBQ2hCLEtBQUssV0FBVztvQkFDWixnQkFBZ0IsQ0FBQyxTQUFTLEdBQUcsSUFBSSxTQUFTLENBQUMsRUFBRSxFQUFFLFVBQVUsQ0FBQyxRQUFRLENBQUMsQ0FBQztvQkFDcEUsTUFBTTtnQkFDVixLQUFLLG1CQUFtQjtvQkFDcEIsZ0JBQWdCLENBQUMsZUFBZSxHQUFHLElBQUksU0FBUyxDQUFDO3dCQUM3QyxtQkFBbUIsRUFBRSxJQUFJLFdBQVcsQ0FBQyxJQUFJLEVBQUUsVUFBVSxDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUM7cUJBQ3hFLEVBQUUsVUFBVSxDQUFDLFFBQVEsQ0FBQyxDQUFDO29CQUN4QixNQUFNO2dCQUNWLEtBQUssVUFBVTtvQkFDWCxnQkFBZ0IsQ0FBQyxhQUFhLEdBQUcsSUFBSSxTQUFTLENBQUM7d0JBQzNDLFFBQVEsRUFBRSxJQUFJLFdBQVcsQ0FBQyxJQUFJLEVBQUUsVUFBVSxDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUM7cUJBQzdELEVBQUUsVUFBVSxDQUFDLFFBQVEsQ0FBQyxDQUFDO29CQUN4QixNQUFNO2dCQUNWLEtBQUssY0FBYztvQkFDZixnQkFBZ0IsQ0FBQyxpQkFBaUIsR0FBRyxJQUFJLFNBQVMsQ0FBQzt3QkFDL0MsaUJBQWlCLEVBQUUsSUFBSSxXQUFXLENBQUMsSUFBSSxFQUFFLFVBQVUsQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDO3FCQUN0RSxFQUFFLFVBQVUsQ0FBQyxRQUFRLENBQUMsQ0FBQztvQkFDeEIsTUFBTTtnQkFDVixLQUFLLFNBQVM7b0JBQ1YsZ0JBQWdCLENBQUMsa0JBQWtCLEdBQUcsSUFBSSxTQUFTLENBQUM7d0JBQ2hELGFBQWEsRUFBRSxJQUFJLFdBQVcsQ0FBQyxJQUFJLEVBQUUsVUFBVSxDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUM7cUJBQ2xFLEVBQUUsVUFBVSxDQUFDLFFBQVEsQ0FBQyxDQUFDO29CQUN4QixNQUFNO2dCQUNWLEtBQUssTUFBTTtvQkFDUCxnQkFBZ0IsQ0FBQyxTQUFTLEdBQUcsSUFBSSxTQUFTLENBQUM7d0JBQ3ZDLFFBQVEsRUFBRSxJQUFJLFdBQVcsQ0FBQyxJQUFJLEVBQUUsVUFBVSxDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUM7cUJBQzdELEVBQUUsVUFBVSxDQUFDLFFBQVEsQ0FBQyxDQUFDO29CQUN4QixNQUFNO2dCQUNWLEtBQUssU0FBUztvQkFDVixnQkFBZ0IsQ0FBQyxvQkFBb0IsR0FBRyxJQUFJLFNBQVMsQ0FBQzt3QkFDbEQsMEJBQTBCLEVBQUUsSUFBSSxXQUFXLENBQUMsSUFBSSxFQUFFLFVBQVUsQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDO3FCQUMvRSxFQUFFLFVBQVUsQ0FBQyxRQUFRLENBQUMsQ0FBQztvQkFDeEIsTUFBTTtnQkFDVixLQUFLLFFBQVE7b0JBQ1QsZ0JBQWdCLENBQUMsV0FBVyxHQUFHLElBQUksU0FBUyxDQUFDO3dCQUN6QyxNQUFNLEVBQUUsSUFBSSxXQUFXLENBQUMsSUFBSSxFQUFFLFVBQVUsQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDO3FCQUMzRCxFQUFFLFVBQVUsQ0FBQyxRQUFRLENBQUMsQ0FBQztvQkFDeEIsTUFBTTtnQkFDVjtvQkFDSSxPQUFPO2FBQ2Q7UUFDTCxDQUFDLEVBQUMsQ0FBQztRQUNILElBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztRQUMzRCxJQUFJLENBQUMsVUFBVSxDQUFDLFlBQVksQ0FBQyxTQUFTOzs7O1FBQUMsQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLEVBQUMsQ0FBQztRQUM1RSxJQUFJLENBQUMsVUFBVSxDQUFDLGFBQWEsQ0FBQyxTQUFTOzs7O1FBQUMsQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLEVBQUMsQ0FBQztJQUNsRixDQUFDOzs7OztJQUVNLGVBQWUsQ0FBQyxRQUFnQjtRQUNuQyxJQUFJLENBQUMsZUFBZSxHQUFHLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxlQUFlLENBQUMsUUFBUSxDQUFDLENBQUMsU0FBUzs7OztRQUM1RSxDQUFDLEdBQTBCLEVBQUUsRUFBRTtZQUMzQixJQUFJLENBQUMsZ0JBQWdCLEdBQUcsR0FBRyxDQUFDO1lBQzVCLElBQUksSUFBSSxDQUFDLGdCQUFnQixDQUFDLGFBQWEsRUFBRSxFQUFFO2dCQUN2QyxJQUFJLENBQUMsbUJBQW1CLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO2FBQ3RDO2lCQUFNO2dCQUNILElBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDLENBQUM7Z0JBQzdDLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxFQUFFLENBQUM7YUFDdkI7UUFDTCxDQUFDOzs7O1FBQ0QsQ0FBQyxHQUFRLEVBQUUsRUFBRTtZQUNULElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ3pCLENBQUMsRUFDSixDQUFDO0lBQ04sQ0FBQzs7Ozs7Ozs7O0lBRU8sd0JBQXdCLENBQUMsVUFBeUMsRUFBRSxLQUFhLEVBQUUsUUFBaUIsRUFBRSxtQkFBNEI7UUFDdEksVUFBVSxDQUFDLE9BQU87Ozs7UUFBQyxDQUFDLEtBQUssRUFBRSxFQUFFO1lBQ3pCLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxvQkFBb0IsQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLEtBQUssRUFBRSxRQUFRLEVBQUUsbUJBQW1CLENBQUMsQ0FBQyxTQUFTOzs7O1lBQ2xHLENBQUMsSUFBMkIsRUFBRSxFQUFFO2dCQUM1QixLQUFLLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQztnQkFDckIsSUFBSSxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDcEMsQ0FBQzs7OztZQUNELENBQUMsR0FBUSxFQUFFLEVBQUU7Z0JBQ1QsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7WUFDekIsQ0FBQyxFQUNKLENBQUM7UUFDTixDQUFDLEVBQUMsQ0FBQztJQUNQLENBQUM7Ozs7O0lBRUQsMEJBQTBCLENBQUMsS0FBVTtRQUNqQyxJQUFJLEtBQUssQ0FBQyxLQUFLLEVBQUU7WUFDYixJQUFJLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1NBQ3RDO0lBQ0wsQ0FBQzs7Ozs7SUFFTSxNQUFNLENBQUMsTUFBVztRQUNyQixJQUFJLENBQUMsZ0JBQWdCLEdBQUcsSUFBSSxDQUFDLG1DQUFtQyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQ3pFLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO0lBQzdDLENBQUM7Ozs7O0lBRUQsY0FBYyxDQUFDLE1BQVc7UUFDdEIsSUFBSSxDQUFDLGdCQUFnQixDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUNuQyxJQUFJLElBQUksQ0FBQyxVQUFVLElBQUksSUFBSSxDQUFDLFVBQVUsQ0FBQyxLQUFLLEVBQUU7WUFDMUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQztTQUN2QjtJQUNMLENBQUM7Ozs7O0lBRUQsZUFBZSxDQUFDLE1BQVc7UUFDdkIsSUFBSSxJQUFJLENBQUMsVUFBVSxJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxPQUFPLElBQUksSUFBSSxDQUFDLFVBQVUsQ0FBQyxLQUFLLEVBQUU7WUFDdEUsSUFBSSxDQUFDLGNBQWMsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLEtBQUssQ0FBQztTQUMvQztJQUNMLENBQUM7Ozs7O0lBRU0saUJBQWlCLENBQUMsSUFBWTtRQUNqQyxPQUFPLE1BQU0sQ0FBQyxJQUFJLEVBQUUsa0NBQWtDLENBQUMsb0JBQW9CLEVBQUUsSUFBSSxDQUFDO2FBQzdFLE1BQU0sQ0FBQyxrQ0FBa0MsQ0FBQyxvQkFBb0IsQ0FBQyxHQUFHLGdCQUFnQixDQUFDO0lBQzVGLENBQUM7Ozs7SUFFTSxZQUFZO1FBQ2YsT0FBTyxNQUFNLEVBQUUsQ0FBQyxNQUFNLENBQUMsa0NBQWtDLENBQUMsb0JBQW9CLENBQUMsQ0FBQztJQUNwRixDQUFDOzs7OztJQUVNLGFBQWEsQ0FBQyxLQUFhO1FBQzlCLE9BQU8sS0FBSyxJQUFJLElBQUksQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ25ELENBQUM7Ozs7O0lBRUQsbUNBQW1DLENBQUMsTUFBVzs7Y0FDckMsZ0JBQWdCLEdBQWdCLElBQUksV0FBVyxFQUFFO1FBQ3ZELElBQUksTUFBTSxDQUFDLFNBQVMsRUFBRTtZQUNsQixnQkFBZ0IsQ0FBQyxTQUFTLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBQzFGLGdCQUFnQixDQUFDLFNBQVMsQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDLGlCQUFpQixDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLENBQUM7U0FDekY7UUFDRCxJQUFJLE1BQU0sQ0FBQyxXQUFXLEVBQUU7WUFDcEIsZ0JBQWdCLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDO1NBQ3ZEO1FBQ0QsSUFBSSxNQUFNLENBQUMsZUFBZSxFQUFFO1lBQ3hCLGdCQUFnQixDQUFDLG1CQUFtQixHQUFHLE1BQU0sQ0FBQyxlQUFlLENBQUMsbUJBQW1CLENBQUM7U0FDckY7UUFDRCxJQUFJLE1BQU0sQ0FBQyxTQUFTLEVBQUU7WUFDbEIsZ0JBQWdCLENBQUMsUUFBUSxHQUFHLE1BQU0sQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDO1NBQ3pEO1FBQ0QsSUFBSSxNQUFNLENBQUMsYUFBYSxFQUFFO1lBQ3RCLGdCQUFnQixDQUFDLFFBQVEsR0FBRyxNQUFNLENBQUMsYUFBYSxDQUFDLFFBQVEsQ0FBQztTQUM3RDtRQUNELElBQUksTUFBTSxDQUFDLGlCQUFpQixFQUFFO1lBQzFCLGdCQUFnQixDQUFDLGlCQUFpQixHQUFHLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxpQkFBaUIsQ0FBQztTQUNuRjtRQUNELElBQUksTUFBTSxDQUFDLG9CQUFvQixFQUFFO1lBQzdCLGdCQUFnQixDQUFDLDBCQUEwQixHQUFHLElBQUksQ0FBQyxhQUFhLENBQUMsTUFBTSxDQUFDLG9CQUFvQixDQUFDLDBCQUEwQixDQUFDLENBQUM7U0FDNUg7UUFDRCxJQUFJLE1BQU0sQ0FBQyxrQkFBa0IsRUFBRTtZQUMzQixnQkFBZ0IsQ0FBQyxhQUFhLEdBQUcsTUFBTSxDQUFDLGtCQUFrQixDQUFDLGFBQWEsQ0FBQztTQUM1RTtRQUNELE9BQU8sZ0JBQWdCLENBQUM7SUFDNUIsQ0FBQzs7OztJQUVELFdBQVc7UUFDUCxJQUFJLENBQUMsV0FBVyxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQy9CLElBQUksQ0FBQyxTQUFTLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDN0IsSUFBSSxJQUFJLENBQUMsZUFBZSxFQUFFO1lBQ3RCLElBQUksQ0FBQyxlQUFlLENBQUMsV0FBVyxFQUFFLENBQUM7U0FDdEM7SUFDTCxDQUFDOzs7O0lBRU0sVUFBVTtRQUNiLElBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDO0lBQzNCLENBQUM7Ozs7SUFFTSxXQUFXO1FBQ2QsSUFBSSxDQUFDLFVBQVUsR0FBRyxLQUFLLENBQUM7SUFDNUIsQ0FBQzs7OztJQUVNLFNBQVM7UUFDWixJQUFJLENBQUMsZUFBZSxHQUFHLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxDQUFDLENBQUMsU0FBUzs7OztRQUNySCxDQUFDLEdBQTBCLEVBQUUsRUFBRTtZQUMzQixJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7WUFDbkIsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLElBQUksQ0FBQyxDQUFDO1FBQy9DLENBQUM7Ozs7UUFDRCxDQUFDLEdBQVEsRUFBRSxFQUFFO1lBQ1QsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDekIsQ0FBQyxFQUNKLENBQUM7SUFDTixDQUFDOzs7OztJQUVNLFVBQVUsQ0FBQyxLQUFhO1FBQzNCLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsRUFBRSxFQUFFLEtBQUssRUFBRSxPQUFPLEVBQUUsQ0FBQyxDQUFDO1FBQzVELElBQUksQ0FBQyxNQUFNLEdBQUcsS0FBSyxDQUFDO1FBQ3BCLElBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDLGdCQUFnQixDQUFDLElBQUksR0FBRyxLQUFLLEdBQUcsSUFBSSxDQUFDLFlBQVksRUFBRSxHQUFHLElBQUksQ0FBQztJQUN0RixDQUFDOzs7O0lBRUQsV0FBVztRQUNQLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxFQUFFLENBQUM7SUFDM0IsQ0FBQzs7Ozs7O0lBRUQsYUFBYSxDQUFDLE1BQWMsRUFBRSxnQkFBNkI7UUFDdkQsZ0JBQWdCLENBQUMsVUFBVSxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUM7UUFDOUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQ25CLElBQUksTUFBTSxLQUFLLE1BQU0sRUFBRTtZQUNuQixJQUFJLENBQUMsTUFBTSxDQUFDLGdCQUFnQixDQUFDLENBQUM7U0FDakM7YUFBTSxJQUFJLE1BQU0sS0FBSyxRQUFRLEVBQUU7WUFDNUIsSUFBSSxDQUFDLFFBQVEsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1NBQ25DO1FBQ0QsSUFBSSxDQUFDLFlBQVksRUFBRSxDQUFDO0lBQ3hCLENBQUM7Ozs7SUFFRCxZQUFZO1FBQ1IsSUFBSSxDQUFDLE1BQU0sR0FBRyxFQUFFLENBQUM7UUFDakIsSUFBSSxDQUFDLFVBQVUsR0FBRyxFQUFFLENBQUM7SUFDekIsQ0FBQzs7OztJQUVELFlBQVk7UUFDUixPQUFPLElBQUksQ0FBQyxNQUFNLEtBQUssTUFBTSxDQUFDO0lBQ2xDLENBQUM7Ozs7O0lBRUQsUUFBUSxDQUFDLFVBQXVCO1FBQzVCLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFLFVBQVUsQ0FBQyxDQUFDLFNBQVM7Ozs7UUFDeEUsQ0FBQyxJQUFTLEVBQUUsRUFBRTs7a0JBQ0osSUFBSSxHQUFTLElBQUksSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsRUFBRSxJQUFJLEVBQUUsVUFBVSxFQUFFLENBQUM7WUFDekQsSUFBSSxDQUFDLGNBQWMsQ0FBQyxZQUFZLENBQUMsSUFBSSxFQUFFLFVBQVUsQ0FBQyxVQUFVLEdBQUcsTUFBTSxDQUFDLENBQUM7UUFDM0UsQ0FBQyxFQUFDLENBQUM7SUFDWCxDQUFDOzs7OztJQUVELE1BQU0sQ0FBQyxVQUF1QjtRQUMxQixJQUFJLENBQUMsZ0JBQWdCLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUUsVUFBVSxDQUFDLENBQUMsU0FBUzs7O1FBQUMsR0FBRyxFQUFFO1lBQ3ZFLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQy9DLENBQUMsRUFBQyxDQUFDO0lBQ1AsQ0FBQzs7Ozs7SUFFRCxZQUFZLENBQUMsUUFBZ0I7UUFDekIsSUFBSSxDQUFDLGdCQUFnQixDQUFDLFlBQVksQ0FBQyxRQUFRLENBQUMsQ0FBQyxTQUFTOzs7UUFBQyxHQUFHLEVBQUU7WUFDeEQsSUFBSSxDQUFDLG1CQUFtQixDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUM1QyxDQUFDOzs7O1FBQUUsQ0FBQyxLQUFLLEVBQUUsRUFBRSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxFQUFDLENBQUM7SUFDaEQsQ0FBQzs7OztJQUVELHFCQUFxQjtRQUNqQixJQUFJLElBQUksQ0FBQyxVQUFVLElBQUksSUFBSSxDQUFDLFVBQVUsQ0FBQyxLQUFLLEVBQUU7WUFDMUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxXQUFXLEVBQUUsQ0FBQztTQUNqQztJQUNMLENBQUM7Ozs7SUFFRCxnQkFBZ0I7UUFDWixJQUFJLENBQUMsY0FBYyxHQUFHLENBQUMsSUFBSSxDQUFDLGNBQWMsQ0FBQztJQUMvQyxDQUFDOzs7O0lBRUQsZ0JBQWdCO1FBQ1osT0FBTyxJQUFJLENBQUMsY0FBYyxDQUFDO0lBQy9CLENBQUM7Ozs7SUFFRCxXQUFXO1FBQ1AsT0FBTyxJQUFJLENBQUMsVUFBVSxJQUFJLElBQUksQ0FBQyxVQUFVLENBQUMsS0FBSyxJQUFJLElBQUksQ0FBQyxVQUFVLENBQUMsS0FBSyxDQUFDO0lBQzdFLENBQUM7O0FBcFZhLHVEQUFvQixHQUFXLFlBQVksQ0FBQzs7WUFSN0QsU0FBUyxTQUFDO2dCQUNQLFFBQVEsRUFBRSxpQ0FBaUM7Z0JBQzNDLHk3UUFBMkQ7Z0JBRTNELGFBQWEsRUFBRSxpQkFBaUIsQ0FBQyxJQUFJOzthQUN4Qzs7OztZQVBRLGdCQUFnQjtZQVBoQixXQUFXO1lBZEssVUFBVTtZQUExQixjQUFjO1lBZWQsU0FBUzs7O29CQWtCYixLQUFLO3VCQUdMLEtBQUs7NEJBR0wsS0FBSztzQkFHTCxNQUFNO29CQUdOLE1BQU07bUJBR04sTUFBTTsrQkFHTixNQUFNO2dDQUdOLE1BQU07a0NBR04sTUFBTTsrQkFHTixTQUFTLFNBQUMsa0JBQWtCOzs7O0lBN0I3Qix3REFBMEQ7O0lBRTFELG1EQUNjOztJQUVkLHNEQUNpQjs7SUFFakIsMkRBQytCOztJQUUvQixxREFDNkI7O0lBRTdCLG1EQUMyQjs7SUFFM0Isa0RBQzBCOztJQUUxQiw4REFDc0M7O0lBRXRDLCtEQUN1Qzs7SUFFdkMsaUVBQ3lDOztJQUV6Qyw4REFDc0I7O0lBRXRCLCtEQUF1Qzs7SUFFdkMsaUVBQXlDOztJQUV6Qyw2REFBcUM7O0lBRXJDLDhEQUF3Qzs7SUFFeEMsd0RBQXNCOztJQUV0QixvREFBZTs7SUFFZix3REFBNEI7O0lBRTVCLHdEQUFtQjs7Ozs7SUFFbkIseURBQW9COzs7OztJQUNwQiw2REFBd0I7Ozs7O0lBQ3hCLHVEQUFrQjs7SUFDbEIsOERBQThCOzs7OztJQUM5Qiw0REFBdUM7O0lBQ3ZDLDREQUFnQzs7Ozs7SUFFcEIsOERBQTBDOzs7OztJQUMxQyx5REFBZ0M7Ozs7O0lBQ2hDLHdEQUE4Qjs7Ozs7SUFDOUIsNERBQXNDOzs7OztJQUN0QyxvREFBeUIiLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOSBBbGZyZXNjbyBTb2Z0d2FyZSwgTHRkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBDb250ZW50U2VydmljZSwgTG9nU2VydmljZSB9IGZyb20gJ0BhbGZyZXNjby9hZGYtY29yZSc7XG5pbXBvcnQge1xuICAgIEFmdGVyQ29udGVudENoZWNrZWQsXG4gICAgQ29tcG9uZW50LFxuICAgIEV2ZW50RW1pdHRlcixcbiAgICBJbnB1dCxcbiAgICBPbkNoYW5nZXMsXG4gICAgT25EZXN0cm95LFxuICAgIE9uSW5pdCxcbiAgICBPdXRwdXQsXG4gICAgU2ltcGxlQ2hhbmdlcyxcbiAgICBWaWV3Q2hpbGQsXG4gICAgVmlld0VuY2Fwc3VsYXRpb25cbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBGb3JtQnVpbGRlciwgRm9ybUNvbnRyb2wsIEZvcm1Hcm91cCwgVmFsaWRhdG9ycyB9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcbmltcG9ydCB7IE1hdERpYWxvZyB9IGZyb20gJ0Bhbmd1bGFyL21hdGVyaWFsJztcbmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50LWVzNic7XG5pbXBvcnQgeyBQYXJhbWV0ZXJWYWx1ZU1vZGVsIH0gZnJvbSAnLi4vLi4vZGlhZ3JhbS9tb2RlbHMvcmVwb3J0L3BhcmFtZXRlclZhbHVlLm1vZGVsJztcbmltcG9ydCB7IFJlcG9ydFBhcmFtZXRlckRldGFpbHNNb2RlbCB9IGZyb20gJy4uLy4uL2RpYWdyYW0vbW9kZWxzL3JlcG9ydC9yZXBvcnRQYXJhbWV0ZXJEZXRhaWxzLm1vZGVsJztcbmltcG9ydCB7IFJlcG9ydFBhcmFtZXRlcnNNb2RlbCB9IGZyb20gJy4uLy4uL2RpYWdyYW0vbW9kZWxzL3JlcG9ydC9yZXBvcnRQYXJhbWV0ZXJzLm1vZGVsJztcbmltcG9ydCB7IFJlcG9ydFF1ZXJ5IH0gZnJvbSAnLi4vLi4vZGlhZ3JhbS9tb2RlbHMvcmVwb3J0L3JlcG9ydFF1ZXJ5Lm1vZGVsJztcbmltcG9ydCB7IEFuYWx5dGljc1NlcnZpY2UgfSBmcm9tICcuLi9zZXJ2aWNlcy9hbmFseXRpY3Muc2VydmljZSc7XG5cbkBDb21wb25lbnQoe1xuICAgIHNlbGVjdG9yOiAnYWRmLWFuYWx5dGljcy1yZXBvcnQtcGFyYW1ldGVycycsXG4gICAgdGVtcGxhdGVVcmw6ICcuL2FuYWx5dGljcy1yZXBvcnQtcGFyYW1ldGVycy5jb21wb25lbnQuaHRtbCcsXG4gICAgc3R5bGVVcmxzOiBbJy4vYW5hbHl0aWNzLXJlcG9ydC1wYXJhbWV0ZXJzLmNvbXBvbmVudC5zY3NzJ10sXG4gICAgZW5jYXBzdWxhdGlvbjogVmlld0VuY2Fwc3VsYXRpb24uTm9uZVxufSlcbmV4cG9ydCBjbGFzcyBBbmFseXRpY3NSZXBvcnRQYXJhbWV0ZXJzQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkNoYW5nZXMsIE9uRGVzdHJveSwgQWZ0ZXJDb250ZW50Q2hlY2tlZCB7XG5cbiAgICBwdWJsaWMgc3RhdGljIEZPUk1BVF9EQVRFX0FDVElWSVRJOiBzdHJpbmcgPSAnWVlZWS1NTS1ERCc7XG5cbiAgICBASW5wdXQoKVxuICAgIGFwcElkOiBudW1iZXI7XG5cbiAgICBASW5wdXQoKVxuICAgIHJlcG9ydElkOiBzdHJpbmc7XG5cbiAgICBASW5wdXQoKVxuICAgIGhpZGVDb21wb25lbnQ6IGJvb2xlYW4gPSBmYWxzZTtcblxuICAgIEBPdXRwdXQoKVxuICAgIHN1Y2Nlc3MgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG5cbiAgICBAT3V0cHV0KClcbiAgICBlcnJvciA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcblxuICAgIEBPdXRwdXQoKVxuICAgIGVkaXQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG5cbiAgICBAT3V0cHV0KClcbiAgICBmb3JtVmFsdWVDaGFuZ2VkID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuXG4gICAgQE91dHB1dCgpXG4gICAgc2F2ZVJlcG9ydFN1Y2Nlc3MgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG5cbiAgICBAT3V0cHV0KClcbiAgICBkZWxldGVSZXBvcnRTdWNjZXNzID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuXG4gICAgQFZpZXdDaGlsZCgncmVwb3J0TmFtZURpYWxvZycpXG4gICAgcmVwb3J0TmFtZURpYWxvZzogYW55O1xuXG4gICAgb25Ecm9wZG93bkNoYW5nZWQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG5cbiAgICBzdWNjZXNzUmVwb3J0UGFyYW1zID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuXG4gICAgc3VjY2Vzc1BhcmFtT3B0ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuXG4gICAgcmVwb3J0UGFyYW1ldGVyczogUmVwb3J0UGFyYW1ldGVyc01vZGVsO1xuXG4gICAgcmVwb3J0Rm9ybTogRm9ybUdyb3VwO1xuXG4gICAgYWN0aW9uOiBzdHJpbmc7XG5cbiAgICBpc0VkaXRhYmxlOiBib29sZWFuID0gZmFsc2U7XG5cbiAgICByZXBvcnROYW1lOiBzdHJpbmc7XG5cbiAgICBwcml2YXRlIGRyb3BEb3duU3ViO1xuICAgIHByaXZhdGUgcmVwb3J0UGFyYW1zU3ViO1xuICAgIHByaXZhdGUgcGFyYW1PcHRzO1xuICAgIHJlcG9ydFBhcmFtUXVlcnk6IFJlcG9ydFF1ZXJ5O1xuICAgIHByaXZhdGUgaGlkZVBhcmFtZXRlcnM6IGJvb2xlYW4gPSB0cnVlO1xuICAgIGZvcm1WYWxpZFN0YXRlOiBib29sZWFuID0gZmFsc2U7XG5cbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGFuYWx5dGljc1NlcnZpY2U6IEFuYWx5dGljc1NlcnZpY2UsXG4gICAgICAgICAgICAgICAgcHJpdmF0ZSBmb3JtQnVpbGRlcjogRm9ybUJ1aWxkZXIsXG4gICAgICAgICAgICAgICAgcHJpdmF0ZSBsb2dTZXJ2aWNlOiBMb2dTZXJ2aWNlLFxuICAgICAgICAgICAgICAgIHByaXZhdGUgY29udGVudFNlcnZpY2U6IENvbnRlbnRTZXJ2aWNlLFxuICAgICAgICAgICAgICAgIHByaXZhdGUgZGlhbG9nOiBNYXREaWFsb2cpIHtcblxuICAgIH1cblxuICAgIG5nT25Jbml0KCkge1xuICAgICAgICB0aGlzLmRyb3BEb3duU3ViID0gdGhpcy5vbkRyb3Bkb3duQ2hhbmdlZC5zdWJzY3JpYmUoKGZpZWxkKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBwYXJhbURlcGVuZE9uOiBSZXBvcnRQYXJhbWV0ZXJEZXRhaWxzTW9kZWwgPSB0aGlzLnJlcG9ydFBhcmFtZXRlcnMuZGVmaW5pdGlvbi5wYXJhbWV0ZXJzLmZpbmQoKHApID0+IHAuZGVwZW5kc09uID09PSBmaWVsZC5pZCk7XG4gICAgICAgICAgICBpZiAocGFyYW1EZXBlbmRPbikge1xuICAgICAgICAgICAgICAgIHRoaXMucmV0cmlldmVQYXJhbWV0ZXJPcHRpb25zKHRoaXMucmVwb3J0UGFyYW1ldGVycy5kZWZpbml0aW9uLnBhcmFtZXRlcnMsIHRoaXMuYXBwSWQsIHRoaXMucmVwb3J0SWQsIGZpZWxkLnZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5wYXJhbU9wdHMgPSB0aGlzLnN1Y2Nlc3NSZXBvcnRQYXJhbXMuc3Vic2NyaWJlKChyZXBvcnQ6IFJlcG9ydFBhcmFtZXRlcnNNb2RlbCkgPT4ge1xuICAgICAgICAgICAgaWYgKHJlcG9ydC5oYXNQYXJhbWV0ZXJzKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJldHJpZXZlUGFyYW1ldGVyT3B0aW9ucyhyZXBvcnQuZGVmaW5pdGlvbi5wYXJhbWV0ZXJzLCB0aGlzLmFwcElkKTtcbiAgICAgICAgICAgICAgICB0aGlzLmdlbmVyYXRlRm9ybUdyb3VwRnJvbVBhcmFtZXRlcihyZXBvcnQuZGVmaW5pdGlvbi5wYXJhbWV0ZXJzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcykge1xuICAgICAgICB0aGlzLmlzRWRpdGFibGUgPSBmYWxzZTtcbiAgICAgICAgaWYgKHRoaXMucmVwb3J0Rm9ybSkge1xuICAgICAgICAgICAgdGhpcy5yZXBvcnRGb3JtLnJlc2V0KCk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCByZXBvcnRJZCA9IGNoYW5nZXNbJ3JlcG9ydElkJ107XG4gICAgICAgIGlmIChyZXBvcnRJZCAmJiByZXBvcnRJZC5jdXJyZW50VmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMucmVwb3J0SWQgPSByZXBvcnRJZC5jdXJyZW50VmFsdWU7XG4gICAgICAgICAgICB0aGlzLmdldFJlcG9ydFBhcmFtcyhyZXBvcnRJZC5jdXJyZW50VmFsdWUpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgYXBwSWQgPSBjaGFuZ2VzWydhcHBJZCddO1xuICAgICAgICBpZiAoYXBwSWQgJiYgKGFwcElkLmN1cnJlbnRWYWx1ZSB8fCBhcHBJZC5jdXJyZW50VmFsdWUgPT09IG51bGwpKSB7XG4gICAgICAgICAgICB0aGlzLmdldFJlcG9ydFBhcmFtcyh0aGlzLnJlcG9ydElkKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgZ2VuZXJhdGVGb3JtR3JvdXBGcm9tUGFyYW1ldGVyKHBhcmFtZXRlcnM6IFJlcG9ydFBhcmFtZXRlckRldGFpbHNNb2RlbFtdKSB7XG4gICAgICAgIGNvbnN0IGZvcm1CdWlsZGVyR3JvdXA6IGFueSA9IHt9O1xuICAgICAgICBwYXJhbWV0ZXJzLmZvckVhY2goKHBhcmFtOiBSZXBvcnRQYXJhbWV0ZXJEZXRhaWxzTW9kZWwpID0+IHtcbiAgICAgICAgICAgIHN3aXRjaCAocGFyYW0udHlwZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ2RhdGVSYW5nZSc6XG4gICAgICAgICAgICAgICAgICAgIGZvcm1CdWlsZGVyR3JvdXAuZGF0ZVJhbmdlID0gbmV3IEZvcm1Hcm91cCh7fSwgVmFsaWRhdG9ycy5yZXF1aXJlZCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ3Byb2Nlc3NEZWZpbml0aW9uJzpcbiAgICAgICAgICAgICAgICAgICAgZm9ybUJ1aWxkZXJHcm91cC5wcm9jZXNzRGVmR3JvdXAgPSBuZXcgRm9ybUdyb3VwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2Nlc3NEZWZpbml0aW9uSWQ6IG5ldyBGb3JtQ29udHJvbChudWxsLCBWYWxpZGF0b3JzLnJlcXVpcmVkLCBudWxsKVxuICAgICAgICAgICAgICAgICAgICB9LCBWYWxpZGF0b3JzLnJlcXVpcmVkKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnZHVyYXRpb24nOlxuICAgICAgICAgICAgICAgICAgICBmb3JtQnVpbGRlckdyb3VwLmR1cmF0aW9uR3JvdXAgPSBuZXcgRm9ybUdyb3VwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBuZXcgRm9ybUNvbnRyb2wobnVsbCwgVmFsaWRhdG9ycy5yZXF1aXJlZCwgbnVsbClcbiAgICAgICAgICAgICAgICAgICAgfSwgVmFsaWRhdG9ycy5yZXF1aXJlZCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2RhdGVJbnRlcnZhbCc6XG4gICAgICAgICAgICAgICAgICAgIGZvcm1CdWlsZGVyR3JvdXAuZGF0ZUludGVydmFsR3JvdXAgPSBuZXcgRm9ybUdyb3VwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGVSYW5nZUludGVydmFsOiBuZXcgRm9ybUNvbnRyb2wobnVsbCwgVmFsaWRhdG9ycy5yZXF1aXJlZCwgbnVsbClcbiAgICAgICAgICAgICAgICAgICAgfSwgVmFsaWRhdG9ycy5yZXF1aXJlZCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2Jvb2xlYW4nOlxuICAgICAgICAgICAgICAgICAgICBmb3JtQnVpbGRlckdyb3VwLnR5cGVGaWx0ZXJpbmdHcm91cCA9IG5ldyBGb3JtR3JvdXAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZUZpbHRlcmluZzogbmV3IEZvcm1Db250cm9sKG51bGwsIFZhbGlkYXRvcnMucmVxdWlyZWQsIG51bGwpXG4gICAgICAgICAgICAgICAgICAgIH0sIFZhbGlkYXRvcnMucmVxdWlyZWQpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICd0YXNrJzpcbiAgICAgICAgICAgICAgICAgICAgZm9ybUJ1aWxkZXJHcm91cC50YXNrR3JvdXAgPSBuZXcgRm9ybUdyb3VwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tOYW1lOiBuZXcgRm9ybUNvbnRyb2wobnVsbCwgVmFsaWRhdG9ycy5yZXF1aXJlZCwgbnVsbClcbiAgICAgICAgICAgICAgICAgICAgfSwgVmFsaWRhdG9ycy5yZXF1aXJlZCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2ludGVnZXInOlxuICAgICAgICAgICAgICAgICAgICBmb3JtQnVpbGRlckdyb3VwLnByb2Nlc3NJbnN0YW5jZUdyb3VwID0gbmV3IEZvcm1Hcm91cCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBzbG93UHJvY2Vzc0luc3RhbmNlSW50ZWdlcjogbmV3IEZvcm1Db250cm9sKG51bGwsIFZhbGlkYXRvcnMucmVxdWlyZWQsIG51bGwpXG4gICAgICAgICAgICAgICAgICAgIH0sIFZhbGlkYXRvcnMucmVxdWlyZWQpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdzdGF0dXMnOlxuICAgICAgICAgICAgICAgICAgICBmb3JtQnVpbGRlckdyb3VwLnN0YXR1c0dyb3VwID0gbmV3IEZvcm1Hcm91cCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IG5ldyBGb3JtQ29udHJvbChudWxsLCBWYWxpZGF0b3JzLnJlcXVpcmVkLCBudWxsKVxuICAgICAgICAgICAgICAgICAgICB9LCBWYWxpZGF0b3JzLnJlcXVpcmVkKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5yZXBvcnRGb3JtID0gdGhpcy5mb3JtQnVpbGRlci5ncm91cChmb3JtQnVpbGRlckdyb3VwKTtcbiAgICAgICAgdGhpcy5yZXBvcnRGb3JtLnZhbHVlQ2hhbmdlcy5zdWJzY3JpYmUoKGRhdGEpID0+IHRoaXMub25WYWx1ZUNoYW5nZWQoZGF0YSkpO1xuICAgICAgICB0aGlzLnJlcG9ydEZvcm0uc3RhdHVzQ2hhbmdlcy5zdWJzY3JpYmUoKGRhdGEpID0+IHRoaXMub25TdGF0dXNDaGFuZ2VkKGRhdGEpKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0UmVwb3J0UGFyYW1zKHJlcG9ydElkOiBzdHJpbmcpIHtcbiAgICAgICAgdGhpcy5yZXBvcnRQYXJhbXNTdWIgPSB0aGlzLmFuYWx5dGljc1NlcnZpY2UuZ2V0UmVwb3J0UGFyYW1zKHJlcG9ydElkKS5zdWJzY3JpYmUoXG4gICAgICAgICAgICAocmVzOiBSZXBvcnRQYXJhbWV0ZXJzTW9kZWwpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlcG9ydFBhcmFtZXRlcnMgPSByZXM7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucmVwb3J0UGFyYW1ldGVycy5oYXNQYXJhbWV0ZXJzKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdWNjZXNzUmVwb3J0UGFyYW1zLmVtaXQocmVzKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlcG9ydEZvcm0gPSB0aGlzLmZvcm1CdWlsZGVyLmdyb3VwKHt9KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdWNjZXNzLmVtaXQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgKGVycjogYW55KSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5lcnJvci5lbWl0KGVycik7XG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSByZXRyaWV2ZVBhcmFtZXRlck9wdGlvbnMocGFyYW1ldGVyczogUmVwb3J0UGFyYW1ldGVyRGV0YWlsc01vZGVsW10sIGFwcElkOiBudW1iZXIsIHJlcG9ydElkPzogc3RyaW5nLCBwcm9jZXNzRGVmaW5pdGlvbklkPzogc3RyaW5nKSB7XG4gICAgICAgIHBhcmFtZXRlcnMuZm9yRWFjaCgocGFyYW0pID0+IHtcbiAgICAgICAgICAgIHRoaXMuYW5hbHl0aWNzU2VydmljZS5nZXRQYXJhbVZhbHVlc0J5VHlwZShwYXJhbS50eXBlLCBhcHBJZCwgcmVwb3J0SWQsIHByb2Nlc3NEZWZpbml0aW9uSWQpLnN1YnNjcmliZShcbiAgICAgICAgICAgICAgICAob3B0czogUGFyYW1ldGVyVmFsdWVNb2RlbFtdKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHBhcmFtLm9wdGlvbnMgPSBvcHRzO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN1Y2Nlc3NQYXJhbU9wdC5lbWl0KG9wdHMpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgKGVycjogYW55KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZXJyb3IuZW1pdChlcnIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIG9uUHJvY2Vzc0RlZmluaXRpb25DaGFuZ2VzKGZpZWxkOiBhbnkpIHtcbiAgICAgICAgaWYgKGZpZWxkLnZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLm9uRHJvcGRvd25DaGFuZ2VkLmVtaXQoZmllbGQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIHN1Ym1pdCh2YWx1ZXM6IGFueSkge1xuICAgICAgICB0aGlzLnJlcG9ydFBhcmFtUXVlcnkgPSB0aGlzLmNvbnZlcnRGb3JtVmFsdWVzVG9SZXBvcnRQYXJhbVF1ZXJ5KHZhbHVlcyk7XG4gICAgICAgIHRoaXMuc3VjY2Vzcy5lbWl0KHRoaXMucmVwb3J0UGFyYW1RdWVyeSk7XG4gICAgfVxuXG4gICAgb25WYWx1ZUNoYW5nZWQodmFsdWVzOiBhbnkpIHtcbiAgICAgICAgdGhpcy5mb3JtVmFsdWVDaGFuZ2VkLmVtaXQodmFsdWVzKTtcbiAgICAgICAgaWYgKHRoaXMucmVwb3J0Rm9ybSAmJiB0aGlzLnJlcG9ydEZvcm0udmFsaWQpIHtcbiAgICAgICAgICAgIHRoaXMuc3VibWl0KHZhbHVlcyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvblN0YXR1c0NoYW5nZWQoc3RhdHVzOiBhbnkpIHtcbiAgICAgICAgaWYgKHRoaXMucmVwb3J0Rm9ybSAmJiAhdGhpcy5yZXBvcnRGb3JtLnBlbmRpbmcgJiYgdGhpcy5yZXBvcnRGb3JtLmRpcnR5KSB7XG4gICAgICAgICAgICB0aGlzLmZvcm1WYWxpZFN0YXRlID0gdGhpcy5yZXBvcnRGb3JtLnZhbGlkO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGNvbnZlcnRNb21lbnREYXRlKGRhdGU6IHN0cmluZykge1xuICAgICAgICByZXR1cm4gbW9tZW50KGRhdGUsIEFuYWx5dGljc1JlcG9ydFBhcmFtZXRlcnNDb21wb25lbnQuRk9STUFUX0RBVEVfQUNUSVZJVEksIHRydWUpXG4gICAgICAgICAgICAuZm9ybWF0KEFuYWx5dGljc1JlcG9ydFBhcmFtZXRlcnNDb21wb25lbnQuRk9STUFUX0RBVEVfQUNUSVZJVEkpICsgJ1QwMDowMDowMC4wMDBaJztcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0VG9kYXlEYXRlKCkge1xuICAgICAgICByZXR1cm4gbW9tZW50KCkuZm9ybWF0KEFuYWx5dGljc1JlcG9ydFBhcmFtZXRlcnNDb21wb25lbnQuRk9STUFUX0RBVEVfQUNUSVZJVEkpO1xuICAgIH1cblxuICAgIHB1YmxpYyBjb252ZXJ0TnVtYmVyKHZhbHVlOiBzdHJpbmcpOiBudW1iZXIge1xuICAgICAgICByZXR1cm4gdmFsdWUgIT0gbnVsbCA/IHBhcnNlSW50KHZhbHVlLCAxMCkgOiAwO1xuICAgIH1cblxuICAgIGNvbnZlcnRGb3JtVmFsdWVzVG9SZXBvcnRQYXJhbVF1ZXJ5KHZhbHVlczogYW55KTogUmVwb3J0UXVlcnkge1xuICAgICAgICBjb25zdCByZXBvcnRQYXJhbVF1ZXJ5OiBSZXBvcnRRdWVyeSA9IG5ldyBSZXBvcnRRdWVyeSgpO1xuICAgICAgICBpZiAodmFsdWVzLmRhdGVSYW5nZSkge1xuICAgICAgICAgICAgcmVwb3J0UGFyYW1RdWVyeS5kYXRlUmFuZ2Uuc3RhcnREYXRlID0gdGhpcy5jb252ZXJ0TW9tZW50RGF0ZSh2YWx1ZXMuZGF0ZVJhbmdlLnN0YXJ0RGF0ZSk7XG4gICAgICAgICAgICByZXBvcnRQYXJhbVF1ZXJ5LmRhdGVSYW5nZS5lbmREYXRlID0gdGhpcy5jb252ZXJ0TW9tZW50RGF0ZSh2YWx1ZXMuZGF0ZVJhbmdlLmVuZERhdGUpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2YWx1ZXMuc3RhdHVzR3JvdXApIHtcbiAgICAgICAgICAgIHJlcG9ydFBhcmFtUXVlcnkuc3RhdHVzID0gdmFsdWVzLnN0YXR1c0dyb3VwLnN0YXR1cztcbiAgICAgICAgfVxuICAgICAgICBpZiAodmFsdWVzLnByb2Nlc3NEZWZHcm91cCkge1xuICAgICAgICAgICAgcmVwb3J0UGFyYW1RdWVyeS5wcm9jZXNzRGVmaW5pdGlvbklkID0gdmFsdWVzLnByb2Nlc3NEZWZHcm91cC5wcm9jZXNzRGVmaW5pdGlvbklkO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2YWx1ZXMudGFza0dyb3VwKSB7XG4gICAgICAgICAgICByZXBvcnRQYXJhbVF1ZXJ5LnRhc2tOYW1lID0gdmFsdWVzLnRhc2tHcm91cC50YXNrTmFtZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodmFsdWVzLmR1cmF0aW9uR3JvdXApIHtcbiAgICAgICAgICAgIHJlcG9ydFBhcmFtUXVlcnkuZHVyYXRpb24gPSB2YWx1ZXMuZHVyYXRpb25Hcm91cC5kdXJhdGlvbjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodmFsdWVzLmRhdGVJbnRlcnZhbEdyb3VwKSB7XG4gICAgICAgICAgICByZXBvcnRQYXJhbVF1ZXJ5LmRhdGVSYW5nZUludGVydmFsID0gdmFsdWVzLmRhdGVJbnRlcnZhbEdyb3VwLmRhdGVSYW5nZUludGVydmFsO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2YWx1ZXMucHJvY2Vzc0luc3RhbmNlR3JvdXApIHtcbiAgICAgICAgICAgIHJlcG9ydFBhcmFtUXVlcnkuc2xvd1Byb2Nlc3NJbnN0YW5jZUludGVnZXIgPSB0aGlzLmNvbnZlcnROdW1iZXIodmFsdWVzLnByb2Nlc3NJbnN0YW5jZUdyb3VwLnNsb3dQcm9jZXNzSW5zdGFuY2VJbnRlZ2VyKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodmFsdWVzLnR5cGVGaWx0ZXJpbmdHcm91cCkge1xuICAgICAgICAgICAgcmVwb3J0UGFyYW1RdWVyeS50eXBlRmlsdGVyaW5nID0gdmFsdWVzLnR5cGVGaWx0ZXJpbmdHcm91cC50eXBlRmlsdGVyaW5nO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXBvcnRQYXJhbVF1ZXJ5O1xuICAgIH1cblxuICAgIG5nT25EZXN0cm95KCkge1xuICAgICAgICB0aGlzLmRyb3BEb3duU3ViLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgIHRoaXMucGFyYW1PcHRzLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgIGlmICh0aGlzLnJlcG9ydFBhcmFtc1N1Yikge1xuICAgICAgICAgICAgdGhpcy5yZXBvcnRQYXJhbXNTdWIudW5zdWJzY3JpYmUoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBlZGl0RW5hYmxlKCkge1xuICAgICAgICB0aGlzLmlzRWRpdGFibGUgPSB0cnVlO1xuICAgIH1cblxuICAgIHB1YmxpYyBlZGl0RGlzYWJsZSgpIHtcbiAgICAgICAgdGhpcy5pc0VkaXRhYmxlID0gZmFsc2U7XG4gICAgfVxuXG4gICAgcHVibGljIGVkaXRUaXRsZSgpIHtcbiAgICAgICAgdGhpcy5yZXBvcnRQYXJhbXNTdWIgPSB0aGlzLmFuYWx5dGljc1NlcnZpY2UudXBkYXRlUmVwb3J0KHRoaXMucmVwb3J0UGFyYW1ldGVycy5pZCwgdGhpcy5yZXBvcnRQYXJhbWV0ZXJzLm5hbWUpLnN1YnNjcmliZShcbiAgICAgICAgICAgIChyZXM6IFJlcG9ydFBhcmFtZXRlcnNNb2RlbCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuZWRpdERpc2FibGUoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmVkaXQuZW1pdCh0aGlzLnJlcG9ydFBhcmFtZXRlcnMubmFtZSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgKGVycjogYW55KSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5lcnJvci5lbWl0KGVycik7XG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgcHVibGljIHNob3dEaWFsb2coZXZlbnQ6IHN0cmluZykge1xuICAgICAgICB0aGlzLmRpYWxvZy5vcGVuKHRoaXMucmVwb3J0TmFtZURpYWxvZywgeyB3aWR0aDogJzUwMHB4JyB9KTtcbiAgICAgICAgdGhpcy5hY3Rpb24gPSBldmVudDtcbiAgICAgICAgdGhpcy5yZXBvcnROYW1lID0gdGhpcy5yZXBvcnRQYXJhbWV0ZXJzLm5hbWUgKyAnICggJyArIHRoaXMuZ2V0VG9kYXlEYXRlKCkgKyAnICknO1xuICAgIH1cblxuICAgIGNsb3NlRGlhbG9nKCkge1xuICAgICAgICB0aGlzLmRpYWxvZy5jbG9zZUFsbCgpO1xuICAgIH1cblxuICAgIHBlcmZvcm1BY3Rpb24oYWN0aW9uOiBzdHJpbmcsIHJlcG9ydFBhcmFtUXVlcnk6IFJlcG9ydFF1ZXJ5KSB7XG4gICAgICAgIHJlcG9ydFBhcmFtUXVlcnkucmVwb3J0TmFtZSA9IHRoaXMucmVwb3J0TmFtZTtcbiAgICAgICAgdGhpcy5jbG9zZURpYWxvZygpO1xuICAgICAgICBpZiAoYWN0aW9uID09PSAnU2F2ZScpIHtcbiAgICAgICAgICAgIHRoaXMuZG9TYXZlKHJlcG9ydFBhcmFtUXVlcnkpO1xuICAgICAgICB9IGVsc2UgaWYgKGFjdGlvbiA9PT0gJ0V4cG9ydCcpIHtcbiAgICAgICAgICAgIHRoaXMuZG9FeHBvcnQocmVwb3J0UGFyYW1RdWVyeSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yZXNldEFjdGlvbnMoKTtcbiAgICB9XG5cbiAgICByZXNldEFjdGlvbnMoKSB7XG4gICAgICAgIHRoaXMuYWN0aW9uID0gJyc7XG4gICAgICAgIHRoaXMucmVwb3J0TmFtZSA9ICcnO1xuICAgIH1cblxuICAgIGlzU2F2ZUFjdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYWN0aW9uID09PSAnU2F2ZSc7XG4gICAgfVxuXG4gICAgZG9FeHBvcnQocGFyYW1RdWVyeTogUmVwb3J0UXVlcnkpIHtcbiAgICAgICAgdGhpcy5hbmFseXRpY3NTZXJ2aWNlLmV4cG9ydFJlcG9ydFRvQ3N2KHRoaXMucmVwb3J0SWQsIHBhcmFtUXVlcnkpLnN1YnNjcmliZShcbiAgICAgICAgICAgIChkYXRhOiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBibG9iOiBCbG9iID0gbmV3IEJsb2IoW2RhdGFdLCB7IHR5cGU6ICd0ZXh0L2NzdicgfSk7XG4gICAgICAgICAgICAgICAgdGhpcy5jb250ZW50U2VydmljZS5kb3dubG9hZEJsb2IoYmxvYiwgcGFyYW1RdWVyeS5yZXBvcnROYW1lICsgJy5jc3YnKTtcbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIGRvU2F2ZShwYXJhbVF1ZXJ5OiBSZXBvcnRRdWVyeSkge1xuICAgICAgICB0aGlzLmFuYWx5dGljc1NlcnZpY2Uuc2F2ZVJlcG9ydCh0aGlzLnJlcG9ydElkLCBwYXJhbVF1ZXJ5KS5zdWJzY3JpYmUoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zYXZlUmVwb3J0U3VjY2Vzcy5lbWl0KHRoaXMucmVwb3J0SWQpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBkZWxldGVSZXBvcnQocmVwb3J0SWQ6IHN0cmluZykge1xuICAgICAgICB0aGlzLmFuYWx5dGljc1NlcnZpY2UuZGVsZXRlUmVwb3J0KHJlcG9ydElkKS5zdWJzY3JpYmUoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5kZWxldGVSZXBvcnRTdWNjZXNzLmVtaXQocmVwb3J0SWQpO1xuICAgICAgICB9LCAoZXJyb3IpID0+IHRoaXMubG9nU2VydmljZS5lcnJvcihlcnJvcikpO1xuICAgIH1cblxuICAgIG5nQWZ0ZXJDb250ZW50Q2hlY2tlZCgpIHtcbiAgICAgICAgaWYgKHRoaXMucmVwb3J0Rm9ybSAmJiB0aGlzLnJlcG9ydEZvcm0udmFsaWQpIHtcbiAgICAgICAgICAgIHRoaXMucmVwb3J0Rm9ybS5tYXJrQXNEaXJ0eSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgdG9nZ2xlUGFyYW1ldGVycygpIHtcbiAgICAgICAgdGhpcy5oaWRlUGFyYW1ldGVycyA9ICF0aGlzLmhpZGVQYXJhbWV0ZXJzO1xuICAgIH1cblxuICAgIGlzUGFyYW1ldGVyc0hpZGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmhpZGVQYXJhbWV0ZXJzO1xuICAgIH1cblxuICAgIGlzRm9ybVZhbGlkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yZXBvcnRGb3JtICYmIHRoaXMucmVwb3J0Rm9ybS5kaXJ0eSAmJiB0aGlzLnJlcG9ydEZvcm0udmFsaWQ7XG4gICAgfVxufVxuIl19