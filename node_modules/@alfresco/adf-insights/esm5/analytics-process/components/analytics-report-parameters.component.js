/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/*!
 * @license
 * Copyright 2019 Alfresco Software, Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
import { ContentService, LogService } from '@alfresco/adf-core';
import { Component, EventEmitter, Input, Output, ViewChild, ViewEncapsulation } from '@angular/core';
import { FormBuilder, FormControl, FormGroup, Validators } from '@angular/forms';
import { MatDialog } from '@angular/material';
import moment from 'moment-es6';
import { ReportQuery } from '../../diagram/models/report/reportQuery.model';
import { AnalyticsService } from '../services/analytics.service';
var AnalyticsReportParametersComponent = /** @class */ (function () {
    function AnalyticsReportParametersComponent(analyticsService, formBuilder, logService, contentService, dialog) {
        this.analyticsService = analyticsService;
        this.formBuilder = formBuilder;
        this.logService = logService;
        this.contentService = contentService;
        this.dialog = dialog;
        this.hideComponent = false;
        this.success = new EventEmitter();
        this.error = new EventEmitter();
        this.edit = new EventEmitter();
        this.formValueChanged = new EventEmitter();
        this.saveReportSuccess = new EventEmitter();
        this.deleteReportSuccess = new EventEmitter();
        this.onDropdownChanged = new EventEmitter();
        this.successReportParams = new EventEmitter();
        this.successParamOpt = new EventEmitter();
        this.isEditable = false;
        this.hideParameters = true;
        this.formValidState = false;
    }
    /**
     * @return {?}
     */
    AnalyticsReportParametersComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.dropDownSub = this.onDropdownChanged.subscribe((/**
         * @param {?} field
         * @return {?}
         */
        function (field) {
            /** @type {?} */
            var paramDependOn = _this.reportParameters.definition.parameters.find((/**
             * @param {?} p
             * @return {?}
             */
            function (p) { return p.dependsOn === field.id; }));
            if (paramDependOn) {
                _this.retrieveParameterOptions(_this.reportParameters.definition.parameters, _this.appId, _this.reportId, field.value);
            }
        }));
        this.paramOpts = this.successReportParams.subscribe((/**
         * @param {?} report
         * @return {?}
         */
        function (report) {
            if (report.hasParameters()) {
                _this.retrieveParameterOptions(report.definition.parameters, _this.appId);
                _this.generateFormGroupFromParameter(report.definition.parameters);
            }
        }));
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    AnalyticsReportParametersComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        this.isEditable = false;
        if (this.reportForm) {
            this.reportForm.reset();
        }
        /** @type {?} */
        var reportId = changes['reportId'];
        if (reportId && reportId.currentValue) {
            this.reportId = reportId.currentValue;
            this.getReportParams(reportId.currentValue);
        }
        /** @type {?} */
        var appId = changes['appId'];
        if (appId && (appId.currentValue || appId.currentValue === null)) {
            this.getReportParams(this.reportId);
        }
    };
    /**
     * @private
     * @param {?} parameters
     * @return {?}
     */
    AnalyticsReportParametersComponent.prototype.generateFormGroupFromParameter = /**
     * @private
     * @param {?} parameters
     * @return {?}
     */
    function (parameters) {
        var _this = this;
        /** @type {?} */
        var formBuilderGroup = {};
        parameters.forEach((/**
         * @param {?} param
         * @return {?}
         */
        function (param) {
            switch (param.type) {
                case 'dateRange':
                    formBuilderGroup.dateRange = new FormGroup({}, Validators.required);
                    break;
                case 'processDefinition':
                    formBuilderGroup.processDefGroup = new FormGroup({
                        processDefinitionId: new FormControl(null, Validators.required, null)
                    }, Validators.required);
                    break;
                case 'duration':
                    formBuilderGroup.durationGroup = new FormGroup({
                        duration: new FormControl(null, Validators.required, null)
                    }, Validators.required);
                    break;
                case 'dateInterval':
                    formBuilderGroup.dateIntervalGroup = new FormGroup({
                        dateRangeInterval: new FormControl(null, Validators.required, null)
                    }, Validators.required);
                    break;
                case 'boolean':
                    formBuilderGroup.typeFilteringGroup = new FormGroup({
                        typeFiltering: new FormControl(null, Validators.required, null)
                    }, Validators.required);
                    break;
                case 'task':
                    formBuilderGroup.taskGroup = new FormGroup({
                        taskName: new FormControl(null, Validators.required, null)
                    }, Validators.required);
                    break;
                case 'integer':
                    formBuilderGroup.processInstanceGroup = new FormGroup({
                        slowProcessInstanceInteger: new FormControl(null, Validators.required, null)
                    }, Validators.required);
                    break;
                case 'status':
                    formBuilderGroup.statusGroup = new FormGroup({
                        status: new FormControl(null, Validators.required, null)
                    }, Validators.required);
                    break;
                default:
                    return;
            }
        }));
        this.reportForm = this.formBuilder.group(formBuilderGroup);
        this.reportForm.valueChanges.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) { return _this.onValueChanged(data); }));
        this.reportForm.statusChanges.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) { return _this.onStatusChanged(data); }));
    };
    /**
     * @param {?} reportId
     * @return {?}
     */
    AnalyticsReportParametersComponent.prototype.getReportParams = /**
     * @param {?} reportId
     * @return {?}
     */
    function (reportId) {
        var _this = this;
        this.reportParamsSub = this.analyticsService.getReportParams(reportId).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            _this.reportParameters = res;
            if (_this.reportParameters.hasParameters()) {
                _this.successReportParams.emit(res);
            }
            else {
                _this.reportForm = _this.formBuilder.group({});
                _this.success.emit();
            }
        }), (/**
         * @param {?} err
         * @return {?}
         */
        function (err) {
            _this.error.emit(err);
        }));
    };
    /**
     * @private
     * @param {?} parameters
     * @param {?} appId
     * @param {?=} reportId
     * @param {?=} processDefinitionId
     * @return {?}
     */
    AnalyticsReportParametersComponent.prototype.retrieveParameterOptions = /**
     * @private
     * @param {?} parameters
     * @param {?} appId
     * @param {?=} reportId
     * @param {?=} processDefinitionId
     * @return {?}
     */
    function (parameters, appId, reportId, processDefinitionId) {
        var _this = this;
        parameters.forEach((/**
         * @param {?} param
         * @return {?}
         */
        function (param) {
            _this.analyticsService.getParamValuesByType(param.type, appId, reportId, processDefinitionId).subscribe((/**
             * @param {?} opts
             * @return {?}
             */
            function (opts) {
                param.options = opts;
                _this.successParamOpt.emit(opts);
            }), (/**
             * @param {?} err
             * @return {?}
             */
            function (err) {
                _this.error.emit(err);
            }));
        }));
    };
    /**
     * @param {?} field
     * @return {?}
     */
    AnalyticsReportParametersComponent.prototype.onProcessDefinitionChanges = /**
     * @param {?} field
     * @return {?}
     */
    function (field) {
        if (field.value) {
            this.onDropdownChanged.emit(field);
        }
    };
    /**
     * @param {?} values
     * @return {?}
     */
    AnalyticsReportParametersComponent.prototype.submit = /**
     * @param {?} values
     * @return {?}
     */
    function (values) {
        this.reportParamQuery = this.convertFormValuesToReportParamQuery(values);
        this.success.emit(this.reportParamQuery);
    };
    /**
     * @param {?} values
     * @return {?}
     */
    AnalyticsReportParametersComponent.prototype.onValueChanged = /**
     * @param {?} values
     * @return {?}
     */
    function (values) {
        this.formValueChanged.emit(values);
        if (this.reportForm && this.reportForm.valid) {
            this.submit(values);
        }
    };
    /**
     * @param {?} status
     * @return {?}
     */
    AnalyticsReportParametersComponent.prototype.onStatusChanged = /**
     * @param {?} status
     * @return {?}
     */
    function (status) {
        if (this.reportForm && !this.reportForm.pending && this.reportForm.dirty) {
            this.formValidState = this.reportForm.valid;
        }
    };
    /**
     * @param {?} date
     * @return {?}
     */
    AnalyticsReportParametersComponent.prototype.convertMomentDate = /**
     * @param {?} date
     * @return {?}
     */
    function (date) {
        return moment(date, AnalyticsReportParametersComponent.FORMAT_DATE_ACTIVITI, true)
            .format(AnalyticsReportParametersComponent.FORMAT_DATE_ACTIVITI) + 'T00:00:00.000Z';
    };
    /**
     * @return {?}
     */
    AnalyticsReportParametersComponent.prototype.getTodayDate = /**
     * @return {?}
     */
    function () {
        return moment().format(AnalyticsReportParametersComponent.FORMAT_DATE_ACTIVITI);
    };
    /**
     * @param {?} value
     * @return {?}
     */
    AnalyticsReportParametersComponent.prototype.convertNumber = /**
     * @param {?} value
     * @return {?}
     */
    function (value) {
        return value != null ? parseInt(value, 10) : 0;
    };
    /**
     * @param {?} values
     * @return {?}
     */
    AnalyticsReportParametersComponent.prototype.convertFormValuesToReportParamQuery = /**
     * @param {?} values
     * @return {?}
     */
    function (values) {
        /** @type {?} */
        var reportParamQuery = new ReportQuery();
        if (values.dateRange) {
            reportParamQuery.dateRange.startDate = this.convertMomentDate(values.dateRange.startDate);
            reportParamQuery.dateRange.endDate = this.convertMomentDate(values.dateRange.endDate);
        }
        if (values.statusGroup) {
            reportParamQuery.status = values.statusGroup.status;
        }
        if (values.processDefGroup) {
            reportParamQuery.processDefinitionId = values.processDefGroup.processDefinitionId;
        }
        if (values.taskGroup) {
            reportParamQuery.taskName = values.taskGroup.taskName;
        }
        if (values.durationGroup) {
            reportParamQuery.duration = values.durationGroup.duration;
        }
        if (values.dateIntervalGroup) {
            reportParamQuery.dateRangeInterval = values.dateIntervalGroup.dateRangeInterval;
        }
        if (values.processInstanceGroup) {
            reportParamQuery.slowProcessInstanceInteger = this.convertNumber(values.processInstanceGroup.slowProcessInstanceInteger);
        }
        if (values.typeFilteringGroup) {
            reportParamQuery.typeFiltering = values.typeFilteringGroup.typeFiltering;
        }
        return reportParamQuery;
    };
    /**
     * @return {?}
     */
    AnalyticsReportParametersComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        this.dropDownSub.unsubscribe();
        this.paramOpts.unsubscribe();
        if (this.reportParamsSub) {
            this.reportParamsSub.unsubscribe();
        }
    };
    /**
     * @return {?}
     */
    AnalyticsReportParametersComponent.prototype.editEnable = /**
     * @return {?}
     */
    function () {
        this.isEditable = true;
    };
    /**
     * @return {?}
     */
    AnalyticsReportParametersComponent.prototype.editDisable = /**
     * @return {?}
     */
    function () {
        this.isEditable = false;
    };
    /**
     * @return {?}
     */
    AnalyticsReportParametersComponent.prototype.editTitle = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.reportParamsSub = this.analyticsService.updateReport(this.reportParameters.id, this.reportParameters.name).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            _this.editDisable();
            _this.edit.emit(_this.reportParameters.name);
        }), (/**
         * @param {?} err
         * @return {?}
         */
        function (err) {
            _this.error.emit(err);
        }));
    };
    /**
     * @param {?} event
     * @return {?}
     */
    AnalyticsReportParametersComponent.prototype.showDialog = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this.dialog.open(this.reportNameDialog, { width: '500px' });
        this.action = event;
        this.reportName = this.reportParameters.name + ' ( ' + this.getTodayDate() + ' )';
    };
    /**
     * @return {?}
     */
    AnalyticsReportParametersComponent.prototype.closeDialog = /**
     * @return {?}
     */
    function () {
        this.dialog.closeAll();
    };
    /**
     * @param {?} action
     * @param {?} reportParamQuery
     * @return {?}
     */
    AnalyticsReportParametersComponent.prototype.performAction = /**
     * @param {?} action
     * @param {?} reportParamQuery
     * @return {?}
     */
    function (action, reportParamQuery) {
        reportParamQuery.reportName = this.reportName;
        this.closeDialog();
        if (action === 'Save') {
            this.doSave(reportParamQuery);
        }
        else if (action === 'Export') {
            this.doExport(reportParamQuery);
        }
        this.resetActions();
    };
    /**
     * @return {?}
     */
    AnalyticsReportParametersComponent.prototype.resetActions = /**
     * @return {?}
     */
    function () {
        this.action = '';
        this.reportName = '';
    };
    /**
     * @return {?}
     */
    AnalyticsReportParametersComponent.prototype.isSaveAction = /**
     * @return {?}
     */
    function () {
        return this.action === 'Save';
    };
    /**
     * @param {?} paramQuery
     * @return {?}
     */
    AnalyticsReportParametersComponent.prototype.doExport = /**
     * @param {?} paramQuery
     * @return {?}
     */
    function (paramQuery) {
        var _this = this;
        this.analyticsService.exportReportToCsv(this.reportId, paramQuery).subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            /** @type {?} */
            var blob = new Blob([data], { type: 'text/csv' });
            _this.contentService.downloadBlob(blob, paramQuery.reportName + '.csv');
        }));
    };
    /**
     * @param {?} paramQuery
     * @return {?}
     */
    AnalyticsReportParametersComponent.prototype.doSave = /**
     * @param {?} paramQuery
     * @return {?}
     */
    function (paramQuery) {
        var _this = this;
        this.analyticsService.saveReport(this.reportId, paramQuery).subscribe((/**
         * @return {?}
         */
        function () {
            _this.saveReportSuccess.emit(_this.reportId);
        }));
    };
    /**
     * @param {?} reportId
     * @return {?}
     */
    AnalyticsReportParametersComponent.prototype.deleteReport = /**
     * @param {?} reportId
     * @return {?}
     */
    function (reportId) {
        var _this = this;
        this.analyticsService.deleteReport(reportId).subscribe((/**
         * @return {?}
         */
        function () {
            _this.deleteReportSuccess.emit(reportId);
        }), (/**
         * @param {?} error
         * @return {?}
         */
        function (error) { return _this.logService.error(error); }));
    };
    /**
     * @return {?}
     */
    AnalyticsReportParametersComponent.prototype.ngAfterContentChecked = /**
     * @return {?}
     */
    function () {
        if (this.reportForm && this.reportForm.valid) {
            this.reportForm.markAsDirty();
        }
    };
    /**
     * @return {?}
     */
    AnalyticsReportParametersComponent.prototype.toggleParameters = /**
     * @return {?}
     */
    function () {
        this.hideParameters = !this.hideParameters;
    };
    /**
     * @return {?}
     */
    AnalyticsReportParametersComponent.prototype.isParametersHide = /**
     * @return {?}
     */
    function () {
        return this.hideParameters;
    };
    /**
     * @return {?}
     */
    AnalyticsReportParametersComponent.prototype.isFormValid = /**
     * @return {?}
     */
    function () {
        return this.reportForm && this.reportForm.dirty && this.reportForm.valid;
    };
    AnalyticsReportParametersComponent.FORMAT_DATE_ACTIVITI = 'YYYY-MM-DD';
    AnalyticsReportParametersComponent.decorators = [
        { type: Component, args: [{
                    selector: 'adf-analytics-report-parameters',
                    template: "<div [class.adf-hide]=\"hideComponent\">\n    <div class=\"adf-report-report-container\">\n        <div *ngIf=\"reportParameters\">\n            <form [formGroup]=\"reportForm\" novalidate>\n                <adf-toolbar>\n                    <adf-toolbar-title class=\"adf-report-title-container\">\n                        <div *ngIf=\"isEditable\">\n                            <mat-form-field class=\"adf-full-width-input\">\n                                <input\n                                    matInput\n                                    type=\"text\"\n                                    class=\"adf-edit-report-title\"\n                                    id=\"reportName\"\n                                    autofocus\n                                    data-automation-id=\"reportName\"\n                                    [value]=\"reportParameters.name\"\n                                    (input)=\"reportParameters.name=$event.target.value\"\n                                    (blur)=\"editTitle()\"\n                                    (keyup.enter)=\"editTitle()\"\n                                />\n                            </mat-form-field>\n                        </div>\n                        <div class=\"adf-report-title\" *ngIf=\"!isEditable\" (click)=\"editEnable()\">\n                            <mat-icon class=\"adf-report-icon\" >mode_edit</mat-icon>\n                            <h4>{{reportParameters.name}}</h4>\n                        </div>\n                    </adf-toolbar-title>\n                    <adf-buttons-action-menu *ngIf=\"!isEditable\">\n                        <button mat-menu-item (click)=\"toggleParameters()\" id=\"\">\n                            <mat-icon>settings</mat-icon><span>{{ 'ANALYTICS.MESSAGES.ICON-SETTING' | translate }}</span>\n                        </button>\n                        <button mat-menu-item (click)=\"deleteReport(reportId)\" id=\"delete-button\">\n                            <mat-icon>delete</mat-icon><span>{{ 'ANALYTICS.MESSAGES.ICON-DELETE' | translate }}</span>\n                        </button>\n                        <div *ngIf=\"isFormValid()\">\n                            <button mat-menu-item (click)=\"showDialog('Export')\" id=\"export-button\">\n                                <mat-icon>file_download</mat-icon><span>{{ 'ANALYTICS.MESSAGES.ICON-EXPORT-CSV' | translate }}</span>\n                            </button>\n                            <button mat-menu-item (click)=\"showDialog('Save')\" id=\"save-button\">\n                                <mat-icon>save</mat-icon><span>{{ 'ANALYTICS.MESSAGES.ICON-SAVE' | translate }}</span>\n                            </button>\n                        </div>\n                    </adf-buttons-action-menu>\n                </adf-toolbar>\n                <div *ngFor=\"let field of reportParameters.definition.parameters\"\n                        [class.adf-is-hide]=\"isParametersHide()\">\n                    <div [ngSwitch]=\"field.type\">\n                        <div *ngSwitchCase=\"'integer'\">\n                            <br>\n                            <analytics-number-widget [field]=\"field\" [group]=\"reportForm.controls.processInstanceGroup\"\n                                            [controllerName]=\"'slowProcessInstanceInteger'\"\n                                            [required]=\"true\"></analytics-number-widget>\n                        </div>\n                        <div *ngSwitchCase=\"'duration'\">\n                            <br>\n                            <duration-widget [field]=\"field\" [group]=\"reportForm.controls.durationGroup\"\n                                                [controllerName]=\"'duration'\"></duration-widget>\n                        </div>\n                        <div *ngSwitchCase=\"'boolean'\">\n                            <br>\n                            <analytics-checkbox-widget [field]=\"field\" [group]=\"reportForm.controls.typeFilteringGroup\"\n                                                [controllerName]=\"'typeFiltering'\"></analytics-checkbox-widget>\n                        </div>\n                        <div *ngSwitchCase=\"'status'\">\n                            <br>\n                            <analytics-dropdown-widget [field]=\"field\" [group]=\"reportForm.controls.statusGroup\"\n                                                [controllerName]=\"'status'\"\n                                                [required]=\"true\"></analytics-dropdown-widget>\n                        </div>\n                        <div *ngSwitchCase=\"'processDefinition'\">\n                            <br>\n                            <analytics-dropdown-widget [field]=\"field\" [group]=\"reportForm.controls.processDefGroup\"\n                                                [controllerName]=\"'processDefinitionId'\"\n                                                [required]=\"true\"\n                                                (fieldChanged)=\"onProcessDefinitionChanges(field)\"></analytics-dropdown-widget>\n                        </div>\n                        <div *ngSwitchCase=\"'task'\">\n                            <br>\n                            <analytics-dropdown-widget [field]=\"field\" [group]=\"reportForm.controls.taskGroup\"\n                                                [controllerName]=\"'taskName'\"\n                                                [required]=\"true\"></analytics-dropdown-widget>\n                        </div>\n                        <div *ngSwitchCase=\"'dateRange'\">\n                            <br>\n                            <adf-date-range-widget [field]=\"field\"\n                                                    [group]=\"reportForm.controls.dateRange\"></adf-date-range-widget>\n                        </div>\n                        <div *ngSwitchCase=\"'dateInterval'\">\n                            <br>\n                            <analytics-dropdown-widget [field]=\"field\" [group]=\"reportForm.controls.dateIntervalGroup\"\n                                                [controllerName]=\"'dateRangeInterval'\"\n                                                [required]=\"true\" [showDefaultOption]=\"false\"></analytics-dropdown-widget>\n                        </div>\n                        <div *ngSwitchDefault>\n                            <span>{{'ANALYTICS.MESSAGES.UNKNOWN-WIDGET-TYPE' | translate}}: {{field.type}}</span>\n                        </div>\n                    </div>\n                </div>\n                <ng-template #reportNameDialog>\n                    <div id=\"report-dialog\" class=\"adf-report-dialog\">\n                        <h5 matDialogTitle id=\"report-dialog-title\">{{action}} report</h5>\n                        <div mat-dialog-content>\n                            <div *ngIf=\"isSaveAction()\" id=\"save-title-submessage\" class=\"adf-export-message\">\n                                {{'DIALOG.SAVE_MESSAGE' | translate}}\n                            </div>\n                            <div class=\"adf-save-export-input\">\n                                <mat-form-field class=\"adf-example-full-width\" floatPlaceholder=\"always\">\n                                    <input matInput\n                                        type=\"text\"\n                                        id=\"repName\"\n                                        placeholder=\"Report Name\"\n                                        [value]=\"reportName\"\n                                        [(ngModel)]=\"reportName\"\n                                        [ngModelOptions]=\"{standalone: true}\">\n                                </mat-form-field>\n                            </div>\n                        </div>\n                        <div mat-dialog-actions>\n                            <button mat-button\n                                color=\"accent\"\n                                type=\"button\"\n                                id=\"close-dialog-button\"\n                                (click)=\"closeDialog()\">Close</button>\n                            <button mat-button\n                                color=\"primary\"\n                                type=\"button\"\n                                id=\"action-dialog-button\"\n                                (click)=\"performAction(action, reportParamQuery)\">{{action}}</button>\n                        </div>\n                    </div>\n                </ng-template>\n            </form>\n        </div>\n    </div>\n</div>\n",
                    encapsulation: ViewEncapsulation.None,
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    AnalyticsReportParametersComponent.ctorParameters = function () { return [
        { type: AnalyticsService },
        { type: FormBuilder },
        { type: LogService },
        { type: ContentService },
        { type: MatDialog }
    ]; };
    AnalyticsReportParametersComponent.propDecorators = {
        appId: [{ type: Input }],
        reportId: [{ type: Input }],
        hideComponent: [{ type: Input }],
        success: [{ type: Output }],
        error: [{ type: Output }],
        edit: [{ type: Output }],
        formValueChanged: [{ type: Output }],
        saveReportSuccess: [{ type: Output }],
        deleteReportSuccess: [{ type: Output }],
        reportNameDialog: [{ type: ViewChild, args: ['reportNameDialog',] }]
    };
    return AnalyticsReportParametersComponent;
}());
export { AnalyticsReportParametersComponent };
if (false) {
    /** @type {?} */
    AnalyticsReportParametersComponent.FORMAT_DATE_ACTIVITI;
    /** @type {?} */
    AnalyticsReportParametersComponent.prototype.appId;
    /** @type {?} */
    AnalyticsReportParametersComponent.prototype.reportId;
    /** @type {?} */
    AnalyticsReportParametersComponent.prototype.hideComponent;
    /** @type {?} */
    AnalyticsReportParametersComponent.prototype.success;
    /** @type {?} */
    AnalyticsReportParametersComponent.prototype.error;
    /** @type {?} */
    AnalyticsReportParametersComponent.prototype.edit;
    /** @type {?} */
    AnalyticsReportParametersComponent.prototype.formValueChanged;
    /** @type {?} */
    AnalyticsReportParametersComponent.prototype.saveReportSuccess;
    /** @type {?} */
    AnalyticsReportParametersComponent.prototype.deleteReportSuccess;
    /** @type {?} */
    AnalyticsReportParametersComponent.prototype.reportNameDialog;
    /** @type {?} */
    AnalyticsReportParametersComponent.prototype.onDropdownChanged;
    /** @type {?} */
    AnalyticsReportParametersComponent.prototype.successReportParams;
    /** @type {?} */
    AnalyticsReportParametersComponent.prototype.successParamOpt;
    /** @type {?} */
    AnalyticsReportParametersComponent.prototype.reportParameters;
    /** @type {?} */
    AnalyticsReportParametersComponent.prototype.reportForm;
    /** @type {?} */
    AnalyticsReportParametersComponent.prototype.action;
    /** @type {?} */
    AnalyticsReportParametersComponent.prototype.isEditable;
    /** @type {?} */
    AnalyticsReportParametersComponent.prototype.reportName;
    /**
     * @type {?}
     * @private
     */
    AnalyticsReportParametersComponent.prototype.dropDownSub;
    /**
     * @type {?}
     * @private
     */
    AnalyticsReportParametersComponent.prototype.reportParamsSub;
    /**
     * @type {?}
     * @private
     */
    AnalyticsReportParametersComponent.prototype.paramOpts;
    /** @type {?} */
    AnalyticsReportParametersComponent.prototype.reportParamQuery;
    /**
     * @type {?}
     * @private
     */
    AnalyticsReportParametersComponent.prototype.hideParameters;
    /** @type {?} */
    AnalyticsReportParametersComponent.prototype.formValidState;
    /**
     * @type {?}
     * @private
     */
    AnalyticsReportParametersComponent.prototype.analyticsService;
    /**
     * @type {?}
     * @private
     */
    AnalyticsReportParametersComponent.prototype.formBuilder;
    /**
     * @type {?}
     * @private
     */
    AnalyticsReportParametersComponent.prototype.logService;
    /**
     * @type {?}
     * @private
     */
    AnalyticsReportParametersComponent.prototype.contentService;
    /**
     * @type {?}
     * @private
     */
    AnalyticsReportParametersComponent.prototype.dialog;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYW5hbHl0aWNzLXJlcG9ydC1wYXJhbWV0ZXJzLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BhbGZyZXNjby9hZGYtaW5zaWdodHMvIiwic291cmNlcyI6WyJhbmFseXRpY3MtcHJvY2Vzcy9jb21wb25lbnRzL2FuYWx5dGljcy1yZXBvcnQtcGFyYW1ldGVycy5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFpQkEsT0FBTyxFQUFFLGNBQWMsRUFBRSxVQUFVLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQUNoRSxPQUFPLEVBRUgsU0FBUyxFQUNULFlBQVksRUFDWixLQUFLLEVBSUwsTUFBTSxFQUVOLFNBQVMsRUFDVCxpQkFBaUIsRUFDcEIsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFFLFdBQVcsRUFBRSxXQUFXLEVBQUUsU0FBUyxFQUFFLFVBQVUsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ2pGLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUM5QyxPQUFPLE1BQU0sTUFBTSxZQUFZLENBQUM7QUFJaEMsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLCtDQUErQyxDQUFDO0FBQzVFLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLCtCQUErQixDQUFDO0FBRWpFO0lBK0RJLDRDQUFvQixnQkFBa0MsRUFDbEMsV0FBd0IsRUFDeEIsVUFBc0IsRUFDdEIsY0FBOEIsRUFDOUIsTUFBaUI7UUFKakIscUJBQWdCLEdBQWhCLGdCQUFnQixDQUFrQjtRQUNsQyxnQkFBVyxHQUFYLFdBQVcsQ0FBYTtRQUN4QixlQUFVLEdBQVYsVUFBVSxDQUFZO1FBQ3RCLG1CQUFjLEdBQWQsY0FBYyxDQUFnQjtRQUM5QixXQUFNLEdBQU4sTUFBTSxDQUFXO1FBbERyQyxrQkFBYSxHQUFZLEtBQUssQ0FBQztRQUcvQixZQUFPLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUc3QixV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O0lBRS9CLHFEQUM2Qjs7SUFFN0IsbURBQzJCOztJQUUzQixrREFDMEI7O0lBRTFCLDhEQUNzQzs7SUFFdEMsK0RBQ3VDOztJQUV2QyxpRUFDeUM7O0lBRXpDLDhEQUNzQjs7SUFFdEIsK0RBQXVDOztJQUV2QyxpRUFBeUM7O0lBRXpDLDZEQUFxQzs7SUFFckMsOERBQXdDOztJQUV4Qyx3REFBc0I7O0lBRXRCLG9EQUFlOztJQUVmLHdEQUE0Qjs7SUFFNUIsd0RBQW1COzs7OztJQUVuQix5REFBb0I7Ozs7O0lBQ3BCLDZEQUF3Qjs7Ozs7SUFDeEIsdURBQWtCOztJQUNsQiw4REFBOEI7Ozs7O0lBQzlCLDREQUF1Qzs7SUFDdkMsNERBQWdDOzs7OztJQUVwQiw4REFBMEM7Ozs7O0lBQzFDLHlEQUFnQzs7Ozs7SUFDaEMsd0RBQThCOzs7OztJQUM5Qiw0REFBc0M7Ozs7O0lBQ3RDLG9EQUF5QiIsInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEFsZnJlc2NvIFNvZnR3YXJlLCBMdGQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IENvbnRlbnRTZXJ2aWNlLCBMb2dTZXJ2aWNlIH0gZnJvbSAnQGFsZnJlc2NvL2FkZi1jb3JlJztcbmltcG9ydCB7XG4gICAgQWZ0ZXJDb250ZW50Q2hlY2tlZCxcbiAgICBDb21wb25lbnQsXG4gICAgRXZlbnRFbWl0dGVyLFxuICAgIElucHV0LFxuICAgIE9uQ2hhbmdlcyxcbiAgICBPbkRlc3Ryb3ksXG4gICAgT25Jbml0LFxuICAgIE91dHB1dCxcbiAgICBTaW1wbGVDaGFuZ2VzLFxuICAgIFZpZXdDaGlsZCxcbiAgICBWaWV3RW5jYXBzdWxhdGlvblxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IEZvcm1CdWlsZGVyLCBGb3JtQ29udHJvbCwgRm9ybUdyb3VwLCBWYWxpZGF0b3JzIH0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xuaW1wb3J0IHsgTWF0RGlhbG9nIH0gZnJvbSAnQGFuZ3VsYXIvbWF0ZXJpYWwnO1xuaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQtZXM2JztcbmltcG9ydCB7IFBhcmFtZXRlclZhbHVlTW9kZWwgfSBmcm9tICcuLi8uLi9kaWFncmFtL21vZGVscy9yZXBvcnQvcGFyYW1ldGVyVmFsdWUubW9kZWwnO1xuaW1wb3J0IHsgUmVwb3J0UGFyYW1ldGVyRGV0YWlsc01vZGVsIH0gZnJvbSAnLi4vLi4vZGlhZ3JhbS9tb2RlbHMvcmVwb3J0L3JlcG9ydFBhcmFtZXRlckRldGFpbHMubW9kZWwnO1xuaW1wb3J0IHsgUmVwb3J0UGFyYW1ldGVyc01vZGVsIH0gZnJvbSAnLi4vLi4vZGlhZ3JhbS9tb2RlbHMvcmVwb3J0L3JlcG9ydFBhcmFtZXRlcnMubW9kZWwnO1xuaW1wb3J0IHsgUmVwb3J0UXVlcnkgfSBmcm9tICcuLi8uLi9kaWFncmFtL21vZGVscy9yZXBvcnQvcmVwb3J0UXVlcnkubW9kZWwnO1xuaW1wb3J0IHsgQW5hbHl0aWNzU2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2VzL2FuYWx5dGljcy5zZXJ2aWNlJztcblxuQENvbXBvbmVudCh7XG4gICAgc2VsZWN0b3I6ICdhZGYtYW5hbHl0aWNzLXJlcG9ydC1wYXJhbWV0ZXJzJyxcbiAgICB0ZW1wbGF0ZVVybDogJy4vYW5hbHl0aWNzLXJlcG9ydC1wYXJhbWV0ZXJzLmNvbXBvbmVudC5odG1sJyxcbiAgICBzdHlsZVVybHM6IFsnLi9hbmFseXRpY3MtcmVwb3J0LXBhcmFtZXRlcnMuY29tcG9uZW50LnNjc3MnXSxcbiAgICBlbmNhcHN1bGF0aW9uOiBWaWV3RW5jYXBzdWxhdGlvbi5Ob25lXG59KVxuZXhwb3J0IGNsYXNzIEFuYWx5dGljc1JlcG9ydFBhcmFtZXRlcnNDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uQ2hhbmdlcywgT25EZXN0cm95LCBBZnRlckNvbnRlbnRDaGVja2VkIHtcblxuICAgIHB1YmxpYyBzdGF0aWMgRk9STUFUX0RBVEVfQUNUSVZJVEk6IHN0cmluZyA9ICdZWVlZLU1NLUREJztcblxuICAgIEBJbnB1dCgpXG4gICAgYXBwSWQ6IG51bWJlcjtcblxuICAgIEBJbnB1dCgpXG4gICAgcmVwb3J0SWQ6IHN0cmluZztcblxuICAgIEBJbnB1dCgpXG4gICAgaGlkZUNvbXBvbmVudDogYm9vbGVhbiA9IGZhbHNlO1xuXG4gICAgQE91dHB1dCgpXG4gICAgc3VjY2VzcyA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcblxuICAgIEBPdXRwdXQoKVxuICAgIGVycm9yID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuXG4gICAgQE91dHB1dCgpXG4gICAgZWRpdCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcblxuICAgIEBPdXRwdXQoKVxuICAgIGZvcm1WYWx1ZUNoYW5nZWQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG5cbiAgICBAT3V0cHV0KClcbiAgICBzYXZlUmVwb3J0U3VjY2VzcyA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcblxuICAgIEBPdXRwdXQoKVxuICAgIGRlbGV0ZVJlcG9ydFN1Y2Nlc3MgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG5cbiAgICBAVmlld0NoaWxkKCdyZXBvcnROYW1lRGlhbG9nJylcbiAgICByZXBvcnROYW1lRGlhbG9nOiBhbnk7XG5cbiAgICBvbkRyb3Bkb3duQ2hhbmdlZCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcblxuICAgIHN1Y2Nlc3NSZXBvcnRQYXJhbXMgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG5cbiAgICBzdWNjZXNzUGFyYW1PcHQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG5cbiAgICByZXBvcnRQYXJhbWV0ZXJzOiBSZXBvcnRQYXJhbWV0ZXJzTW9kZWw7XG5cbiAgICByZXBvcnRGb3JtOiBGb3JtR3JvdXA7XG5cbiAgICBhY3Rpb246IHN0cmluZztcblxuICAgIGlzRWRpdGFibGU6IGJvb2xlYW4gPSBmYWxzZTtcblxuICAgIHJlcG9ydE5hbWU6IHN0cmluZztcblxuICAgIHByaXZhdGUgZHJvcERvd25TdWI7XG4gICAgcHJpdmF0ZSByZXBvcnRQYXJhbXNTdWI7XG4gICAgcHJpdmF0ZSBwYXJhbU9wdHM7XG4gICAgcmVwb3J0UGFyYW1RdWVyeTogUmVwb3J0UXVlcnk7XG4gICAgcHJpdmF0ZSBoaWRlUGFyYW1ldGVyczogYm9vbGVhbiA9IHRydWU7XG4gICAgZm9ybVZhbGlkU3RhdGU6IGJvb2xlYW4gPSBmYWxzZTtcblxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgYW5hbHl0aWNzU2VydmljZTogQW5hbHl0aWNzU2VydmljZSxcbiAgICAgICAgICAgICAgICBwcml2YXRlIGZvcm1CdWlsZGVyOiBGb3JtQnVpbGRlcixcbiAgICAgICAgICAgICAgICBwcml2YXRlIGxvZ1NlcnZpY2U6IExvZ1NlcnZpY2UsXG4gICAgICAgICAgICAgICAgcHJpdmF0ZSBjb250ZW50U2VydmljZTogQ29udGVudFNlcnZpY2UsXG4gICAgICAgICAgICAgICAgcHJpdmF0ZSBkaWFsb2c6IE1hdERpYWxvZykge1xuXG4gICAgfVxuXG4gICAgbmdPbkluaXQoKSB7XG4gICAgICAgIHRoaXMuZHJvcERvd25TdWIgPSB0aGlzLm9uRHJvcGRvd25DaGFuZ2VkLnN1YnNjcmliZSgoZmllbGQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHBhcmFtRGVwZW5kT246IFJlcG9ydFBhcmFtZXRlckRldGFpbHNNb2RlbCA9IHRoaXMucmVwb3J0UGFyYW1ldGVycy5kZWZpbml0aW9uLnBhcmFtZXRlcnMuZmluZCgocCkgPT4gcC5kZXBlbmRzT24gPT09IGZpZWxkLmlkKTtcbiAgICAgICAgICAgIGlmIChwYXJhbURlcGVuZE9uKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZXRyaWV2ZVBhcmFtZXRlck9wdGlvbnModGhpcy5yZXBvcnRQYXJhbWV0ZXJzLmRlZmluaXRpb24ucGFyYW1ldGVycywgdGhpcy5hcHBJZCwgdGhpcy5yZXBvcnRJZCwgZmllbGQudmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLnBhcmFtT3B0cyA9IHRoaXMuc3VjY2Vzc1JlcG9ydFBhcmFtcy5zdWJzY3JpYmUoKHJlcG9ydDogUmVwb3J0UGFyYW1ldGVyc01vZGVsKSA9PiB7XG4gICAgICAgICAgICBpZiAocmVwb3J0Lmhhc1BhcmFtZXRlcnMoKSkge1xuICAgICAgICAgICAgICAgIHRoaXMucmV0cmlldmVQYXJhbWV0ZXJPcHRpb25zKHJlcG9ydC5kZWZpbml0aW9uLnBhcmFtZXRlcnMsIHRoaXMuYXBwSWQpO1xuICAgICAgICAgICAgICAgIHRoaXMuZ2VuZXJhdGVGb3JtR3JvdXBGcm9tUGFyYW1ldGVyKHJlcG9ydC5kZWZpbml0aW9uLnBhcmFtZXRlcnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKSB7XG4gICAgICAgIHRoaXMuaXNFZGl0YWJsZSA9IGZhbHNlO1xuICAgICAgICBpZiAodGhpcy5yZXBvcnRGb3JtKSB7XG4gICAgICAgICAgICB0aGlzLnJlcG9ydEZvcm0ucmVzZXQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHJlcG9ydElkID0gY2hhbmdlc1sncmVwb3J0SWQnXTtcbiAgICAgICAgaWYgKHJlcG9ydElkICYmIHJlcG9ydElkLmN1cnJlbnRWYWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5yZXBvcnRJZCA9IHJlcG9ydElkLmN1cnJlbnRWYWx1ZTtcbiAgICAgICAgICAgIHRoaXMuZ2V0UmVwb3J0UGFyYW1zKHJlcG9ydElkLmN1cnJlbnRWYWx1ZSk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBhcHBJZCA9IGNoYW5nZXNbJ2FwcElkJ107XG4gICAgICAgIGlmIChhcHBJZCAmJiAoYXBwSWQuY3VycmVudFZhbHVlIHx8IGFwcElkLmN1cnJlbnRWYWx1ZSA9PT0gbnVsbCkpIHtcbiAgICAgICAgICAgIHRoaXMuZ2V0UmVwb3J0UGFyYW1zKHRoaXMucmVwb3J0SWQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZW5lcmF0ZUZvcm1Hcm91cEZyb21QYXJhbWV0ZXIocGFyYW1ldGVyczogUmVwb3J0UGFyYW1ldGVyRGV0YWlsc01vZGVsW10pIHtcbiAgICAgICAgY29uc3QgZm9ybUJ1aWxkZXJHcm91cDogYW55ID0ge307XG4gICAgICAgIHBhcmFtZXRlcnMuZm9yRWFjaCgocGFyYW06IFJlcG9ydFBhcmFtZXRlckRldGFpbHNNb2RlbCkgPT4ge1xuICAgICAgICAgICAgc3dpdGNoIChwYXJhbS50eXBlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnZGF0ZVJhbmdlJzpcbiAgICAgICAgICAgICAgICAgICAgZm9ybUJ1aWxkZXJHcm91cC5kYXRlUmFuZ2UgPSBuZXcgRm9ybUdyb3VwKHt9LCBWYWxpZGF0b3JzLnJlcXVpcmVkKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAncHJvY2Vzc0RlZmluaXRpb24nOlxuICAgICAgICAgICAgICAgICAgICBmb3JtQnVpbGRlckdyb3VwLnByb2Nlc3NEZWZHcm91cCA9IG5ldyBGb3JtR3JvdXAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc0RlZmluaXRpb25JZDogbmV3IEZvcm1Db250cm9sKG51bGwsIFZhbGlkYXRvcnMucmVxdWlyZWQsIG51bGwpXG4gICAgICAgICAgICAgICAgICAgIH0sIFZhbGlkYXRvcnMucmVxdWlyZWQpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdkdXJhdGlvbic6XG4gICAgICAgICAgICAgICAgICAgIGZvcm1CdWlsZGVyR3JvdXAuZHVyYXRpb25Hcm91cCA9IG5ldyBGb3JtR3JvdXAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IG5ldyBGb3JtQ29udHJvbChudWxsLCBWYWxpZGF0b3JzLnJlcXVpcmVkLCBudWxsKVxuICAgICAgICAgICAgICAgICAgICB9LCBWYWxpZGF0b3JzLnJlcXVpcmVkKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnZGF0ZUludGVydmFsJzpcbiAgICAgICAgICAgICAgICAgICAgZm9ybUJ1aWxkZXJHcm91cC5kYXRlSW50ZXJ2YWxHcm91cCA9IG5ldyBGb3JtR3JvdXAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZVJhbmdlSW50ZXJ2YWw6IG5ldyBGb3JtQ29udHJvbChudWxsLCBWYWxpZGF0b3JzLnJlcXVpcmVkLCBudWxsKVxuICAgICAgICAgICAgICAgICAgICB9LCBWYWxpZGF0b3JzLnJlcXVpcmVkKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnYm9vbGVhbic6XG4gICAgICAgICAgICAgICAgICAgIGZvcm1CdWlsZGVyR3JvdXAudHlwZUZpbHRlcmluZ0dyb3VwID0gbmV3IEZvcm1Hcm91cCh7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlRmlsdGVyaW5nOiBuZXcgRm9ybUNvbnRyb2wobnVsbCwgVmFsaWRhdG9ycy5yZXF1aXJlZCwgbnVsbClcbiAgICAgICAgICAgICAgICAgICAgfSwgVmFsaWRhdG9ycy5yZXF1aXJlZCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ3Rhc2snOlxuICAgICAgICAgICAgICAgICAgICBmb3JtQnVpbGRlckdyb3VwLnRhc2tHcm91cCA9IG5ldyBGb3JtR3JvdXAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFza05hbWU6IG5ldyBGb3JtQ29udHJvbChudWxsLCBWYWxpZGF0b3JzLnJlcXVpcmVkLCBudWxsKVxuICAgICAgICAgICAgICAgICAgICB9LCBWYWxpZGF0b3JzLnJlcXVpcmVkKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnaW50ZWdlcic6XG4gICAgICAgICAgICAgICAgICAgIGZvcm1CdWlsZGVyR3JvdXAucHJvY2Vzc0luc3RhbmNlR3JvdXAgPSBuZXcgRm9ybUdyb3VwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNsb3dQcm9jZXNzSW5zdGFuY2VJbnRlZ2VyOiBuZXcgRm9ybUNvbnRyb2wobnVsbCwgVmFsaWRhdG9ycy5yZXF1aXJlZCwgbnVsbClcbiAgICAgICAgICAgICAgICAgICAgfSwgVmFsaWRhdG9ycy5yZXF1aXJlZCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ3N0YXR1cyc6XG4gICAgICAgICAgICAgICAgICAgIGZvcm1CdWlsZGVyR3JvdXAuc3RhdHVzR3JvdXAgPSBuZXcgRm9ybUdyb3VwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czogbmV3IEZvcm1Db250cm9sKG51bGwsIFZhbGlkYXRvcnMucmVxdWlyZWQsIG51bGwpXG4gICAgICAgICAgICAgICAgICAgIH0sIFZhbGlkYXRvcnMucmVxdWlyZWQpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnJlcG9ydEZvcm0gPSB0aGlzLmZvcm1CdWlsZGVyLmdyb3VwKGZvcm1CdWlsZGVyR3JvdXApO1xuICAgICAgICB0aGlzLnJlcG9ydEZvcm0udmFsdWVDaGFuZ2VzLnN1YnNjcmliZSgoZGF0YSkgPT4gdGhpcy5vblZhbHVlQ2hhbmdlZChkYXRhKSk7XG4gICAgICAgIHRoaXMucmVwb3J0Rm9ybS5zdGF0dXNDaGFuZ2VzLnN1YnNjcmliZSgoZGF0YSkgPT4gdGhpcy5vblN0YXR1c0NoYW5nZWQoZGF0YSkpO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRSZXBvcnRQYXJhbXMocmVwb3J0SWQ6IHN0cmluZykge1xuICAgICAgICB0aGlzLnJlcG9ydFBhcmFtc1N1YiA9IHRoaXMuYW5hbHl0aWNzU2VydmljZS5nZXRSZXBvcnRQYXJhbXMocmVwb3J0SWQpLnN1YnNjcmliZShcbiAgICAgICAgICAgIChyZXM6IFJlcG9ydFBhcmFtZXRlcnNNb2RlbCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMucmVwb3J0UGFyYW1ldGVycyA9IHJlcztcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5yZXBvcnRQYXJhbWV0ZXJzLmhhc1BhcmFtZXRlcnMoKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN1Y2Nlc3NSZXBvcnRQYXJhbXMuZW1pdChyZXMpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVwb3J0Rm9ybSA9IHRoaXMuZm9ybUJ1aWxkZXIuZ3JvdXAoe30pO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN1Y2Nlc3MuZW1pdCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAoZXJyOiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmVycm9yLmVtaXQoZXJyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHJldHJpZXZlUGFyYW1ldGVyT3B0aW9ucyhwYXJhbWV0ZXJzOiBSZXBvcnRQYXJhbWV0ZXJEZXRhaWxzTW9kZWxbXSwgYXBwSWQ6IG51bWJlciwgcmVwb3J0SWQ/OiBzdHJpbmcsIHByb2Nlc3NEZWZpbml0aW9uSWQ/OiBzdHJpbmcpIHtcbiAgICAgICAgcGFyYW1ldGVycy5mb3JFYWNoKChwYXJhbSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5hbmFseXRpY3NTZXJ2aWNlLmdldFBhcmFtVmFsdWVzQnlUeXBlKHBhcmFtLnR5cGUsIGFwcElkLCByZXBvcnRJZCwgcHJvY2Vzc0RlZmluaXRpb25JZCkuc3Vic2NyaWJlKFxuICAgICAgICAgICAgICAgIChvcHRzOiBQYXJhbWV0ZXJWYWx1ZU1vZGVsW10pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcGFyYW0ub3B0aW9ucyA9IG9wdHM7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3VjY2Vzc1BhcmFtT3B0LmVtaXQob3B0cyk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAoZXJyOiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lcnJvci5lbWl0KGVycik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgb25Qcm9jZXNzRGVmaW5pdGlvbkNoYW5nZXMoZmllbGQ6IGFueSkge1xuICAgICAgICBpZiAoZmllbGQudmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMub25Ecm9wZG93bkNoYW5nZWQuZW1pdChmaWVsZCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgc3VibWl0KHZhbHVlczogYW55KSB7XG4gICAgICAgIHRoaXMucmVwb3J0UGFyYW1RdWVyeSA9IHRoaXMuY29udmVydEZvcm1WYWx1ZXNUb1JlcG9ydFBhcmFtUXVlcnkodmFsdWVzKTtcbiAgICAgICAgdGhpcy5zdWNjZXNzLmVtaXQodGhpcy5yZXBvcnRQYXJhbVF1ZXJ5KTtcbiAgICB9XG5cbiAgICBvblZhbHVlQ2hhbmdlZCh2YWx1ZXM6IGFueSkge1xuICAgICAgICB0aGlzLmZvcm1WYWx1ZUNoYW5nZWQuZW1pdCh2YWx1ZXMpO1xuICAgICAgICBpZiAodGhpcy5yZXBvcnRGb3JtICYmIHRoaXMucmVwb3J0Rm9ybS52YWxpZCkge1xuICAgICAgICAgICAgdGhpcy5zdWJtaXQodmFsdWVzKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG9uU3RhdHVzQ2hhbmdlZChzdGF0dXM6IGFueSkge1xuICAgICAgICBpZiAodGhpcy5yZXBvcnRGb3JtICYmICF0aGlzLnJlcG9ydEZvcm0ucGVuZGluZyAmJiB0aGlzLnJlcG9ydEZvcm0uZGlydHkpIHtcbiAgICAgICAgICAgIHRoaXMuZm9ybVZhbGlkU3RhdGUgPSB0aGlzLnJlcG9ydEZvcm0udmFsaWQ7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgY29udmVydE1vbWVudERhdGUoZGF0ZTogc3RyaW5nKSB7XG4gICAgICAgIHJldHVybiBtb21lbnQoZGF0ZSwgQW5hbHl0aWNzUmVwb3J0UGFyYW1ldGVyc0NvbXBvbmVudC5GT1JNQVRfREFURV9BQ1RJVklUSSwgdHJ1ZSlcbiAgICAgICAgICAgIC5mb3JtYXQoQW5hbHl0aWNzUmVwb3J0UGFyYW1ldGVyc0NvbXBvbmVudC5GT1JNQVRfREFURV9BQ1RJVklUSSkgKyAnVDAwOjAwOjAwLjAwMFonO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRUb2RheURhdGUoKSB7XG4gICAgICAgIHJldHVybiBtb21lbnQoKS5mb3JtYXQoQW5hbHl0aWNzUmVwb3J0UGFyYW1ldGVyc0NvbXBvbmVudC5GT1JNQVRfREFURV9BQ1RJVklUSSk7XG4gICAgfVxuXG4gICAgcHVibGljIGNvbnZlcnROdW1iZXIodmFsdWU6IHN0cmluZyk6IG51bWJlciB7XG4gICAgICAgIHJldHVybiB2YWx1ZSAhPSBudWxsID8gcGFyc2VJbnQodmFsdWUsIDEwKSA6IDA7XG4gICAgfVxuXG4gICAgY29udmVydEZvcm1WYWx1ZXNUb1JlcG9ydFBhcmFtUXVlcnkodmFsdWVzOiBhbnkpOiBSZXBvcnRRdWVyeSB7XG4gICAgICAgIGNvbnN0IHJlcG9ydFBhcmFtUXVlcnk6IFJlcG9ydFF1ZXJ5ID0gbmV3IFJlcG9ydFF1ZXJ5KCk7XG4gICAgICAgIGlmICh2YWx1ZXMuZGF0ZVJhbmdlKSB7XG4gICAgICAgICAgICByZXBvcnRQYXJhbVF1ZXJ5LmRhdGVSYW5nZS5zdGFydERhdGUgPSB0aGlzLmNvbnZlcnRNb21lbnREYXRlKHZhbHVlcy5kYXRlUmFuZ2Uuc3RhcnREYXRlKTtcbiAgICAgICAgICAgIHJlcG9ydFBhcmFtUXVlcnkuZGF0ZVJhbmdlLmVuZERhdGUgPSB0aGlzLmNvbnZlcnRNb21lbnREYXRlKHZhbHVlcy5kYXRlUmFuZ2UuZW5kRGF0ZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZhbHVlcy5zdGF0dXNHcm91cCkge1xuICAgICAgICAgICAgcmVwb3J0UGFyYW1RdWVyeS5zdGF0dXMgPSB2YWx1ZXMuc3RhdHVzR3JvdXAuc3RhdHVzO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2YWx1ZXMucHJvY2Vzc0RlZkdyb3VwKSB7XG4gICAgICAgICAgICByZXBvcnRQYXJhbVF1ZXJ5LnByb2Nlc3NEZWZpbml0aW9uSWQgPSB2YWx1ZXMucHJvY2Vzc0RlZkdyb3VwLnByb2Nlc3NEZWZpbml0aW9uSWQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZhbHVlcy50YXNrR3JvdXApIHtcbiAgICAgICAgICAgIHJlcG9ydFBhcmFtUXVlcnkudGFza05hbWUgPSB2YWx1ZXMudGFza0dyb3VwLnRhc2tOYW1lO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2YWx1ZXMuZHVyYXRpb25Hcm91cCkge1xuICAgICAgICAgICAgcmVwb3J0UGFyYW1RdWVyeS5kdXJhdGlvbiA9IHZhbHVlcy5kdXJhdGlvbkdyb3VwLmR1cmF0aW9uO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2YWx1ZXMuZGF0ZUludGVydmFsR3JvdXApIHtcbiAgICAgICAgICAgIHJlcG9ydFBhcmFtUXVlcnkuZGF0ZVJhbmdlSW50ZXJ2YWwgPSB2YWx1ZXMuZGF0ZUludGVydmFsR3JvdXAuZGF0ZVJhbmdlSW50ZXJ2YWw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZhbHVlcy5wcm9jZXNzSW5zdGFuY2VHcm91cCkge1xuICAgICAgICAgICAgcmVwb3J0UGFyYW1RdWVyeS5zbG93UHJvY2Vzc0luc3RhbmNlSW50ZWdlciA9IHRoaXMuY29udmVydE51bWJlcih2YWx1ZXMucHJvY2Vzc0luc3RhbmNlR3JvdXAuc2xvd1Byb2Nlc3NJbnN0YW5jZUludGVnZXIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2YWx1ZXMudHlwZUZpbHRlcmluZ0dyb3VwKSB7XG4gICAgICAgICAgICByZXBvcnRQYXJhbVF1ZXJ5LnR5cGVGaWx0ZXJpbmcgPSB2YWx1ZXMudHlwZUZpbHRlcmluZ0dyb3VwLnR5cGVGaWx0ZXJpbmc7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcG9ydFBhcmFtUXVlcnk7XG4gICAgfVxuXG4gICAgbmdPbkRlc3Ryb3koKSB7XG4gICAgICAgIHRoaXMuZHJvcERvd25TdWIudW5zdWJzY3JpYmUoKTtcbiAgICAgICAgdGhpcy5wYXJhbU9wdHMudW5zdWJzY3JpYmUoKTtcbiAgICAgICAgaWYgKHRoaXMucmVwb3J0UGFyYW1zU3ViKSB7XG4gICAgICAgICAgICB0aGlzLnJlcG9ydFBhcmFtc1N1Yi51bnN1YnNjcmliZSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGVkaXRFbmFibGUoKSB7XG4gICAgICAgIHRoaXMuaXNFZGl0YWJsZSA9IHRydWU7XG4gICAgfVxuXG4gICAgcHVibGljIGVkaXREaXNhYmxlKCkge1xuICAgICAgICB0aGlzLmlzRWRpdGFibGUgPSBmYWxzZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZWRpdFRpdGxlKCkge1xuICAgICAgICB0aGlzLnJlcG9ydFBhcmFtc1N1YiA9IHRoaXMuYW5hbHl0aWNzU2VydmljZS51cGRhdGVSZXBvcnQodGhpcy5yZXBvcnRQYXJhbWV0ZXJzLmlkLCB0aGlzLnJlcG9ydFBhcmFtZXRlcnMubmFtZSkuc3Vic2NyaWJlKFxuICAgICAgICAgICAgKHJlczogUmVwb3J0UGFyYW1ldGVyc01vZGVsKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5lZGl0RGlzYWJsZSgpO1xuICAgICAgICAgICAgICAgIHRoaXMuZWRpdC5lbWl0KHRoaXMucmVwb3J0UGFyYW1ldGVycy5uYW1lKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAoZXJyOiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmVycm9yLmVtaXQoZXJyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgc2hvd0RpYWxvZyhldmVudDogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMuZGlhbG9nLm9wZW4odGhpcy5yZXBvcnROYW1lRGlhbG9nLCB7IHdpZHRoOiAnNTAwcHgnIH0pO1xuICAgICAgICB0aGlzLmFjdGlvbiA9IGV2ZW50O1xuICAgICAgICB0aGlzLnJlcG9ydE5hbWUgPSB0aGlzLnJlcG9ydFBhcmFtZXRlcnMubmFtZSArICcgKCAnICsgdGhpcy5nZXRUb2RheURhdGUoKSArICcgKSc7XG4gICAgfVxuXG4gICAgY2xvc2VEaWFsb2coKSB7XG4gICAgICAgIHRoaXMuZGlhbG9nLmNsb3NlQWxsKCk7XG4gICAgfVxuXG4gICAgcGVyZm9ybUFjdGlvbihhY3Rpb246IHN0cmluZywgcmVwb3J0UGFyYW1RdWVyeTogUmVwb3J0UXVlcnkpIHtcbiAgICAgICAgcmVwb3J0UGFyYW1RdWVyeS5yZXBvcnROYW1lID0gdGhpcy5yZXBvcnROYW1lO1xuICAgICAgICB0aGlzLmNsb3NlRGlhbG9nKCk7XG4gICAgICAgIGlmIChhY3Rpb24gPT09ICdTYXZlJykge1xuICAgICAgICAgICAgdGhpcy5kb1NhdmUocmVwb3J0UGFyYW1RdWVyeSk7XG4gICAgICAgIH0gZWxzZSBpZiAoYWN0aW9uID09PSAnRXhwb3J0Jykge1xuICAgICAgICAgICAgdGhpcy5kb0V4cG9ydChyZXBvcnRQYXJhbVF1ZXJ5KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlc2V0QWN0aW9ucygpO1xuICAgIH1cblxuICAgIHJlc2V0QWN0aW9ucygpIHtcbiAgICAgICAgdGhpcy5hY3Rpb24gPSAnJztcbiAgICAgICAgdGhpcy5yZXBvcnROYW1lID0gJyc7XG4gICAgfVxuXG4gICAgaXNTYXZlQWN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hY3Rpb24gPT09ICdTYXZlJztcbiAgICB9XG5cbiAgICBkb0V4cG9ydChwYXJhbVF1ZXJ5OiBSZXBvcnRRdWVyeSkge1xuICAgICAgICB0aGlzLmFuYWx5dGljc1NlcnZpY2UuZXhwb3J0UmVwb3J0VG9Dc3YodGhpcy5yZXBvcnRJZCwgcGFyYW1RdWVyeSkuc3Vic2NyaWJlKFxuICAgICAgICAgICAgKGRhdGE6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGJsb2I6IEJsb2IgPSBuZXcgQmxvYihbZGF0YV0sIHsgdHlwZTogJ3RleHQvY3N2JyB9KTtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnRlbnRTZXJ2aWNlLmRvd25sb2FkQmxvYihibG9iLCBwYXJhbVF1ZXJ5LnJlcG9ydE5hbWUgKyAnLmNzdicpO1xuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZG9TYXZlKHBhcmFtUXVlcnk6IFJlcG9ydFF1ZXJ5KSB7XG4gICAgICAgIHRoaXMuYW5hbHl0aWNzU2VydmljZS5zYXZlUmVwb3J0KHRoaXMucmVwb3J0SWQsIHBhcmFtUXVlcnkpLnN1YnNjcmliZSgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnNhdmVSZXBvcnRTdWNjZXNzLmVtaXQodGhpcy5yZXBvcnRJZCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGRlbGV0ZVJlcG9ydChyZXBvcnRJZDogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMuYW5hbHl0aWNzU2VydmljZS5kZWxldGVSZXBvcnQocmVwb3J0SWQpLnN1YnNjcmliZSgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmRlbGV0ZVJlcG9ydFN1Y2Nlc3MuZW1pdChyZXBvcnRJZCk7XG4gICAgICAgIH0sIChlcnJvcikgPT4gdGhpcy5sb2dTZXJ2aWNlLmVycm9yKGVycm9yKSk7XG4gICAgfVxuXG4gICAgbmdBZnRlckNvbnRlbnRDaGVja2VkKCkge1xuICAgICAgICBpZiAodGhpcy5yZXBvcnRGb3JtICYmIHRoaXMucmVwb3J0Rm9ybS52YWxpZCkge1xuICAgICAgICAgICAgdGhpcy5yZXBvcnRGb3JtLm1hcmtBc0RpcnR5KCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB0b2dnbGVQYXJhbWV0ZXJzKCkge1xuICAgICAgICB0aGlzLmhpZGVQYXJhbWV0ZXJzID0gIXRoaXMuaGlkZVBhcmFtZXRlcnM7XG4gICAgfVxuXG4gICAgaXNQYXJhbWV0ZXJzSGlkZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaGlkZVBhcmFtZXRlcnM7XG4gICAgfVxuXG4gICAgaXNGb3JtVmFsaWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJlcG9ydEZvcm0gJiYgdGhpcy5yZXBvcnRGb3JtLmRpcnR5ICYmIHRoaXMucmVwb3J0Rm9ybS52YWxpZDtcbiAgICB9XG59XG4iXX0=