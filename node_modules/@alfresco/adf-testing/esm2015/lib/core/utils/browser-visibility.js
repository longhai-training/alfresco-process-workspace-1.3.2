/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/*!
 * @license
 * Copyright 2019 Alfresco Software, Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
import { browser, protractor } from 'protractor';
/** @type {?} */
const until = protractor.ExpectedConditions;
/** @type {?} */
const DEFAULT_TIMEOUT = global['TestConfig'] ? global['TestConfig'].main.timeout : 40000;
export class BrowserVisibility {
    /*
         * Wait for element is visible
         */
    /**
     * @param {?} elementToCheck
     * @param {?=} waitTimeout
     * @return {?}
     */
    static waitUntilElementIsVisible(elementToCheck, waitTimeout = DEFAULT_TIMEOUT) {
        /** @type {?} */
        let isDisplayed = false;
        return browser.wait((/**
         * @return {?}
         */
        () => {
            browser.waitForAngularEnabled();
            elementToCheck.isDisplayed().then((/**
             * @return {?}
             */
            () => {
                isDisplayed = true;
            }), (/**
             * @return {?}
             */
            () => {
                isDisplayed = false;
            }));
            return isDisplayed;
        }), waitTimeout, 'Element is not visible ' + elementToCheck.locator());
    }
    /*
         * Wait for element to be clickable
         */
    /**
     * @param {?} elementToCheck
     * @param {?=} waitTimeout
     * @return {?}
     */
    static waitUntilElementIsClickable(elementToCheck, waitTimeout = DEFAULT_TIMEOUT) {
        /** @type {?} */
        let isDisplayed = false;
        return browser.wait((/**
         * @return {?}
         */
        () => {
            browser.waitForAngularEnabled();
            elementToCheck.isDisplayed().then((/**
             * @return {?}
             */
            () => {
                isDisplayed = true;
            }), (/**
             * @return {?}
             */
            () => {
                isDisplayed = false;
            }));
            return isDisplayed;
        }), waitTimeout, 'Element is not visible ' + elementToCheck.locator());
    }
    /*
       * Wait for element to not be visible
       */
    /**
     * @param {?} elementToCheck
     * @param {?=} waitTimeout
     * @return {?}
     */
    static waitUntilElementIsStale(elementToCheck, waitTimeout = DEFAULT_TIMEOUT) {
        return browser.wait(until.stalenessOf(elementToCheck), waitTimeout, 'Element is not in stale ' + elementToCheck.locator());
    }
    /*
         * Wait for element to not be visible
         */
    /**
     * @param {?} elementToCheck
     * @param {?=} waitTimeout
     * @return {?}
     */
    static waitUntilElementIsNotVisible(elementToCheck, waitTimeout = DEFAULT_TIMEOUT) {
        /** @type {?} */
        let isPresent = false;
        return browser.wait((/**
         * @return {?}
         */
        () => {
            browser.waitForAngularEnabled();
            elementToCheck.isPresent().then((/**
             * @param {?} present
             * @return {?}
             */
            (present) => {
                isPresent = !present;
            }));
            return isPresent;
        }), waitTimeout, 'Element is Visible and it should not' + elementToCheck.locator());
    }
    /*
         * Wait for element to have value
         */
    /**
     * @param {?} elementToCheck
     * @param {?} elementValue
     * @param {?=} waitTimeout
     * @return {?}
     */
    static waitUntilElementHasValue(elementToCheck, elementValue, waitTimeout = DEFAULT_TIMEOUT) {
        browser.waitForAngularEnabled();
        browser.wait(until.textToBePresentInElementValue(elementToCheck, elementValue), waitTimeout, 'Element doesn\'t have a value ' + elementToCheck.locator());
    }
    /**
     * @param {?} elementToCheck
     * @param {?=} waitTimeout
     * @return {?}
     */
    static waitUntilElementIsOnPage(elementToCheck, waitTimeout = DEFAULT_TIMEOUT) {
        return browser.wait(browser.wait(until.visibilityOf(elementToCheck)), waitTimeout);
    }
    /*
         * Wait for element to not be visible
         */
    /**
     * @param {?} elementToCheck
     * @param {?=} waitTimeout
     * @return {?}
     */
    static waitUntilElementIsNotOnPage(elementToCheck, waitTimeout = DEFAULT_TIMEOUT) {
        return browser.wait(until.not(until.visibilityOf(elementToCheck)), waitTimeout, 'Element is not in the page ' + elementToCheck.locator());
    }
    /**
     * @param {?} elementToCheck
     * @param {?=} waitTimeout
     * @return {?}
     */
    static waitUntilElementIsPresent(elementToCheck, waitTimeout = DEFAULT_TIMEOUT) {
        browser.waitForAngularEnabled();
        return browser.wait(until.presenceOf(elementToCheck), waitTimeout, 'Element is not present ' + elementToCheck.locator());
    }
    /**
     * @param {?} elementToCheck
     * @param {?=} waitTimeout
     * @return {?}
     */
    static waitUntilElementIsNotPresent(elementToCheck, waitTimeout = DEFAULT_TIMEOUT) {
        return browser.wait(until.not(until.presenceOf(elementToCheck)), waitTimeout, 'Element is not in the page ' + elementToCheck.locator());
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnJvd3Nlci12aXNpYmlsaXR5LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGFsZnJlc2NvL2FkZi10ZXN0aW5nLyIsInNvdXJjZXMiOlsibGliL2NvcmUvdXRpbHMvYnJvd3Nlci12aXNpYmlsaXR5LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBaUJBLE9BQU8sRUFBRSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sWUFBWSxDQUFDOztNQUUzQyxLQUFLLEdBQUcsVUFBVSxDQUFDLGtCQUFrQjs7TUFDckMsZUFBZSxHQUFHLE1BQU0sQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLFlBQVksQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEtBQUs7QUFFeEYsTUFBTSxPQUFPLGlCQUFpQjs7Ozs7Ozs7O0lBSzFCLE1BQU0sQ0FBQyx5QkFBeUIsQ0FBQyxjQUFjLEVBQUUsY0FBc0IsZUFBZTs7WUFDOUUsV0FBVyxHQUFHLEtBQUs7UUFDdkIsT0FBTyxPQUFPLENBQUMsSUFBSTs7O1FBQUMsR0FBRyxFQUFFO1lBQ3JCLE9BQU8sQ0FBQyxxQkFBcUIsRUFBRSxDQUFDO1lBRWhDLGNBQWMsQ0FBQyxXQUFXLEVBQUUsQ0FBQyxJQUFJOzs7WUFDN0IsR0FBRyxFQUFFO2dCQUNELFdBQVcsR0FBRyxJQUFJLENBQUM7WUFDdkIsQ0FBQzs7O1lBQ0QsR0FBRyxFQUFFO2dCQUNELFdBQVcsR0FBRyxLQUFLLENBQUM7WUFDeEIsQ0FBQyxFQUNKLENBQUM7WUFDRixPQUFPLFdBQVcsQ0FBQztRQUN2QixDQUFDLEdBQUUsV0FBVyxFQUFFLHlCQUF5QixHQUFHLGNBQWMsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFDO0lBQzFFLENBQUM7Ozs7Ozs7OztJQUtELE1BQU0sQ0FBQywyQkFBMkIsQ0FBQyxjQUFjLEVBQUUsY0FBc0IsZUFBZTs7WUFDaEYsV0FBVyxHQUFHLEtBQUs7UUFDdkIsT0FBTyxP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QUcsQ0FBQyxLQUFLLENBQUMsVUFBVSxDQUFDLGNBQWMsQ0FBQyxDQUFDLEVBQUUsV0FBVyxFQUFFLDZCQUE2QixHQUFHLGNBQWMsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFDO0lBQzVJLENBQUM7Q0FFSiIsInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEFsZnJlc2NvIFNvZnR3YXJlLCBMdGQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IGJyb3dzZXIsIHByb3RyYWN0b3IgfSBmcm9tICdwcm90cmFjdG9yJztcblxuY29uc3QgdW50aWwgPSBwcm90cmFjdG9yLkV4cGVjdGVkQ29uZGl0aW9ucztcbmNvbnN0IERFRkFVTFRfVElNRU9VVCA9IGdsb2JhbFsnVGVzdENvbmZpZyddID8gZ2xvYmFsWydUZXN0Q29uZmlnJ10ubWFpbi50aW1lb3V0IDogNDAwMDA7XG5cbmV4cG9ydCBjbGFzcyBCcm93c2VyVmlzaWJpbGl0eSB7XG5cbiAgICAvKlxuICAgICAqIFdhaXQgZm9yIGVsZW1lbnQgaXMgdmlzaWJsZVxuICAgICAqL1xuICAgIHN0YXRpYyB3YWl0VW50aWxFbGVtZW50SXNWaXNpYmxlKGVsZW1lbnRUb0NoZWNrLCB3YWl0VGltZW91dDogbnVtYmVyID0gREVGQVVMVF9USU1FT1VUKSB7XG4gICAgICAgIGxldCBpc0Rpc3BsYXllZCA9IGZhbHNlO1xuICAgICAgICByZXR1cm4gYnJvd3Nlci53YWl0KCgpID0+IHtcbiAgICAgICAgICAgIGJyb3dzZXIud2FpdEZvckFuZ3VsYXJFbmFibGVkKCk7XG5cbiAgICAgICAgICAgIGVsZW1lbnRUb0NoZWNrLmlzRGlzcGxheWVkKCkudGhlbihcbiAgICAgICAgICAgICAgICAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlzRGlzcGxheWVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaXNEaXNwbGF5ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgcmV0dXJuIGlzRGlzcGxheWVkO1xuICAgICAgICB9LCB3YWl0VGltZW91dCwgJ0VsZW1lbnQgaXMgbm90IHZpc2libGUgJyArIGVsZW1lbnRUb0NoZWNrLmxvY2F0b3IoKSk7XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiBXYWl0IGZvciBlbGVtZW50IHRvIGJlIGNsaWNrYWJsZVxuICAgICAqL1xuICAgIHN0YXRpYyB3YWl0VW50aWxFbGVtZW50SXNDbGlja2FibGUoZWxlbWVudFRvQ2hlY2ssIHdhaXRUaW1lb3V0OiBudW1iZXIgPSBERUZBVUxUX1RJTUVPVVQpIHtcbiAgICAgICAgbGV0IGlzRGlzcGxheWVkID0gZmFsc2U7XG4gICAgICAgIHJldHVybiBicm93c2VyLndhaXQoKCkgPT4ge1xuICAgICAgICAgICAgYnJvd3Nlci53YWl0Rm9yQW5ndWxhckVuYWJsZWQoKTtcblxuICAgICAgICAgICAgZWxlbWVudFRvQ2hlY2suaXNEaXNwbGF5ZWQoKS50aGVuKFxuICAgICAgICAgICAgICAgICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaXNEaXNwbGF5ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpc0Rpc3BsYXllZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICByZXR1cm4gaXNEaXNwbGF5ZWQ7XG4gICAgICAgIH0sIHdhaXRUaW1lb3V0LCAnRWxlbWVudCBpcyBub3QgdmlzaWJsZSAnICsgZWxlbWVudFRvQ2hlY2subG9jYXRvcigpKTtcbiAgICB9XG5cbiAgICAvKlxuICAgKiBXYWl0IGZvciBlbGVtZW50IHRvIG5vdCBiZSB2aXNpYmxlXG4gICAqL1xuICAgIHN0YXRpYyB3YWl0VW50aWxFbGVtZW50SXNTdGFsZShlbGVtZW50VG9DaGVjaywgd2FpdFRpbWVvdXQ6IG51bWJlciA9IERFRkFVTFRfVElNRU9VVCkge1xuICAgICAgICByZXR1cm4gYnJvd3Nlci53YWl0KHVudGlsLnN0YWxlbmVzc09mKGVsZW1lbnRUb0NoZWNrKSwgd2FpdFRpbWVvdXQsICdFbGVtZW50IGlzIG5vdCBpbiBzdGFsZSAnICsgZWxlbWVudFRvQ2hlY2subG9jYXRvcigpKTtcbiAgICB9XG5cbiAgICAvKlxuICAgICAqIFdhaXQgZm9yIGVsZW1lbnQgdG8gbm90IGJlIHZpc2libGVcbiAgICAgKi9cbiAgICBzdGF0aWMgd2FpdFVudGlsRWxlbWVudElzTm90VmlzaWJsZShlbGVtZW50VG9DaGVjaywgd2FpdFRpbWVvdXQ6IG51bWJlciA9IERFRkFVTFRfVElNRU9VVCkge1xuICAgICAgICBsZXQgaXNQcmVzZW50ID0gZmFsc2U7XG4gICAgICAgIHJldHVybiBicm93c2VyLndhaXQoKCkgPT4ge1xuICAgICAgICAgICAgYnJvd3Nlci53YWl0Rm9yQW5ndWxhckVuYWJsZWQoKTtcblxuICAgICAgICAgICAgZWxlbWVudFRvQ2hlY2suaXNQcmVzZW50KCkudGhlbihcbiAgICAgICAgICAgICAgICAocHJlc2VudCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpc1ByZXNlbnQgPSAhcHJlc2VudDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgcmV0dXJuIGlzUHJlc2VudDtcbiAgICAgICAgfSwgd2FpdFRpbWVvdXQsICdFbGVtZW50IGlzIFZpc2libGUgYW5kIGl0IHNob3VsZCBub3QnICsgZWxlbWVudFRvQ2hlY2subG9jYXRvcigpKTtcbiAgICB9XG5cbiAgICAvKlxuICAgICAqIFdhaXQgZm9yIGVsZW1lbnQgdG8gaGF2ZSB2YWx1ZVxuICAgICAqL1xuICAgIHN0YXRpYyB3YWl0VW50aWxFbGVtZW50SGFzVmFsdWUoZWxlbWVudFRvQ2hlY2ssIGVsZW1lbnRWYWx1ZSwgd2FpdFRpbWVvdXQ6IG51bWJlciA9IERFRkFVTFRfVElNRU9VVCkge1xuICAgICAgICBicm93c2VyLndhaXRGb3JBbmd1bGFyRW5hYmxlZCgpO1xuXG4gICAgICAgIGJyb3dzZXIud2FpdCh1bnRpbC50ZXh0VG9CZVByZXNlbnRJbkVsZW1lbnRWYWx1ZShlbGVtZW50VG9DaGVjaywgZWxlbWVudFZhbHVlKSwgd2FpdFRpbWVvdXQsICdFbGVtZW50IGRvZXNuXFwndCBoYXZlIGEgdmFsdWUgJyArIGVsZW1lbnRUb0NoZWNrLmxvY2F0b3IoKSk7XG4gICAgfVxuXG4gICAgc3RhdGljIHdhaXRVbnRpbEVsZW1lbnRJc09uUGFnZShlbGVtZW50VG9DaGVjaywgd2FpdFRpbWVvdXQ6IG51bWJlciA9IERFRkFVTFRfVElNRU9VVCkge1xuICAgICAgICByZXR1cm4gYnJvd3Nlci53YWl0KGJyb3dzZXIud2FpdCh1bnRpbC52aXNpYmlsaXR5T2YoZWxlbWVudFRvQ2hlY2spKSwgd2FpdFRpbWVvdXQpO1xuICAgIH1cblxuICAgIC8qXG4gICAgICogV2FpdCBmb3IgZWxlbWVudCB0byBub3QgYmUgdmlzaWJsZVxuICAgICAqL1xuICAgIHN0YXRpYyB3YWl0VW50aWxFbGVtZW50SXNOb3RPblBhZ2UoZWxlbWVudFRvQ2hlY2ssIHdhaXRUaW1lb3V0OiBudW1iZXIgPSBERUZBVUxUX1RJTUVPVVQpIHtcbiAgICAgICAgcmV0dXJuIGJyb3dzZXIud2FpdCh1bnRpbC5ub3QodW50aWwudmlzaWJpbGl0eU9mKGVsZW1lbnRUb0NoZWNrKSksIHdhaXRUaW1lb3V0LCAnRWxlbWVudCBpcyBub3QgaW4gdGhlIHBhZ2UgJyArIGVsZW1lbnRUb0NoZWNrLmxvY2F0b3IoKSk7XG4gICAgfVxuXG4gICAgc3RhdGljIHdhaXRVbnRpbEVsZW1lbnRJc1ByZXNlbnQoZWxlbWVudFRvQ2hlY2ssIHdhaXRUaW1lb3V0OiBudW1iZXIgPSBERUZBVUxUX1RJTUVPVVQpIHtcbiAgICAgICAgYnJvd3Nlci53YWl0Rm9yQW5ndWxhckVuYWJsZWQoKTtcblxuICAgICAgICByZXR1cm4gYnJvd3Nlci53YWl0KHVudGlsLnByZXNlbmNlT2YoZWxlbWVudFRvQ2hlY2spLCB3YWl0VGltZW91dCwgJ0VsZW1lbnQgaXMgbm90IHByZXNlbnQgJyArIGVsZW1lbnRUb0NoZWNrLmxvY2F0b3IoKSk7XG4gICAgfVxuXG4gICAgc3RhdGljIHdhaXRVbnRpbEVsZW1lbnRJc05vdFByZXNlbnQoZWxlbWVudFRvQ2hlY2ssIHdhaXRUaW1lb3V0OiBudW1iZXIgPSBERUZBVUxUX1RJTUVPVVQpIHtcbiAgICAgICAgcmV0dXJuIGJyb3dzZXIud2FpdCh1bnRpbC5ub3QodW50aWwucHJlc2VuY2VPZihlbGVtZW50VG9DaGVjaykpLCB3YWl0VGltZW91dCwgJ0VsZW1lbnQgaXMgbm90IGluIHRoZSBwYWdlICcgKyBlbGVtZW50VG9DaGVjay5sb2NhdG9yKCkpO1xuICAgIH1cblxufVxuIl19