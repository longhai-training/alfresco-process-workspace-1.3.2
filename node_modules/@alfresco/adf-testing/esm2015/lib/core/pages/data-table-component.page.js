/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
/*!
 * @license
 * Copyright 2019 Alfresco Software, Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
import { browser, by, element, protractor } from 'protractor';
import { BrowserVisibility } from '../utils/browser-visibility';
export class DataTableComponentPage {
    /**
     * @param {?=} rootElement
     */
    constructor(rootElement = element.all(by.css('adf-datatable')).first()) {
        this.rows = by.css(`adf-datatable div[class*='adf-datatable-body'] div[class*='adf-datatable-row']`);
        this.rootElement = rootElement;
        this.list = this.rootElement.all(by.css(`div[class*='adf-datatable-body'] div[class*='adf-datatable-row']`));
        this.contents = this.rootElement.all(by.css('div[class="adf-datatable-body"] span'));
        this.tableBody = this.rootElement.all(by.css(`div[class='adf-datatable-body']`)).first();
        this.spinner = this.rootElement.element(by.css('mat-progress-spinner'));
        this.allColumns = this.rootElement.all(by.css('div[data-automation-id*="auto_id_entry."]'));
        this.selectedRowNumber = this.rootElement.element(by.css(`div[class*='is-selected'] div[data-automation-id*='text_']`));
        this.allSelectedRows = this.rootElement.all(by.css(`div[class*='is-selected']`));
        this.selectAll = this.rootElement.element(by.css(`div[class*='adf-datatable-header'] mat-checkbox`));
        this.copyColumnTooltip = this.rootElement.element(by.css(`adf-copy-content-tooltip span`));
    }
    /**
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    checkAllRowsButtonIsDisplayed() {
        BrowserVisibility.waitUntilElementIsVisible((/** @type {?} */ (this)).selectAll);
        return (/** @type {?} */ (this));
    }
    /**
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    checkAllRows() {
        BrowserVisibility.waitUntilElementIsVisible((/** @type {?} */ (this)).selectAll);
        BrowserVisibility.waitUntilElementIsClickable((/** @type {?} */ (this)).selectAll).then((/**
         * @return {?}
         */
        () => {
            (/** @type {?} */ (this)).selectAll.click();
            BrowserVisibility.waitUntilElementIsVisible((/** @type {?} */ (this)).selectAll.element(by.css('input[aria-checked="true"]')));
        }));
        return (/** @type {?} */ (this));
    }
    /**
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    uncheckAllRows() {
        BrowserVisibility.waitUntilElementIsVisible((/** @type {?} */ (this)).selectAll);
        BrowserVisibility.waitUntilElementIsClickable((/** @type {?} */ (this)).selectAll).then((/**
         * @return {?}
         */
        () => {
            (/** @type {?} */ (this)).selectAll.click();
            BrowserVisibility.waitUntilElementIsNotOnPage((/** @type {?} */ (this)).selectAll.element(by.css('input[aria-checked="true"]')));
        }));
        return (/** @type {?} */ (this));
    }
    /**
     * @param {?} columnName
     * @param {?} columnValue
     * @return {?}
     */
    clickCheckbox(columnName, columnValue) {
        /** @type {?} */
        const checkbox = this.getRowCheckbox(columnName, columnValue);
        BrowserVisibility.waitUntilElementIsClickable(checkbox);
        checkbox.click();
    }
    /**
     * @param {?} columnName
     * @param {?} columnValue
     * @return {?}
     */
    checkRowIsNotChecked(columnName, columnValue) {
        BrowserVisibility.waitUntilElementIsNotOnPage(this.getRowCheckbox(columnName, columnValue).element(by.css('input[aria-checked="true"]')));
    }
    /**
     * @param {?} columnName
     * @param {?} columnValue
     * @return {?}
     */
    checkRowIsChecked(columnName, columnValue) {
        /** @type {?} */
        const rowCheckbox = this.getRowCheckbox(columnName, columnValue);
        BrowserVisibility.waitUntilElementIsVisible(rowCheckbox.element(by.css('input[aria-checked="true"]')));
    }
    /**
     * @param {?} columnName
     * @param {?} columnValue
     * @return {?}
     */
    getRowCheckbox(columnName, columnValue) {
        return this.getRow(columnName, columnValue)
            .element(by.css('mat-checkbox'));
    }
    /**
     * @return {?}
     */
    checkNoRowIsSelected() {
        BrowserVisibility.waitUntilElementIsNotOnPage(this.selectedRowNumber);
    }
    /**
     * @return {?}
     */
    getNumberOfSelectedRows() {
        return this.allSelectedRows.count();
    }
    /**
     * @param {?} columnName
     * @param {?} columnValue
     * @return {?}
     */
    selectRowWithKeyboard(columnName, columnValue) {
        /** @type {?} */
        const row = this.getRow(columnName, columnValue);
        browser.actions().sendKeys(protractor.Key.COMMAND).click(row).perform();
    }
    /**
     * @template THIS
     * @this {THIS}
     * @param {?} columnName
     * @param {?} columnValue
     * @return {THIS}
     */
    selectRow(columnName, columnValue) {
        /** @type {?} */
        const row = (/** @type {?} */ (this)).getRow(columnName, columnValue);
        BrowserVisibility.waitUntilElementIsVisible(row);
        BrowserVisibility.waitUntilElementIsClickable(row);
        row.click();
        return (/** @type {?} */ (this));
    }
    /**
     * @template THIS
     * @this {THIS}
     * @param {?} columnName
     * @param {?} columnValue
     * @return {THIS}
     */
    checkRowIsSelected(columnName, columnValue) {
        /** @type {?} */
        const selectedRow = (/** @type {?} */ (this)).getCellElementByValue(columnName, columnValue).element(by.xpath(`ancestor::div[contains(@class, 'is-selected')]`));
        BrowserVisibility.waitUntilElementIsVisible(selectedRow);
        return (/** @type {?} */ (this));
    }
    /**
     * @template THIS
     * @this {THIS}
     * @param {?} columnName
     * @param {?} columnValue
     * @return {THIS}
     */
    checkRowIsNotSelected(columnName, columnValue) {
        /** @type {?} */
        const selectedRow = (/** @type {?} */ (this)).getCellElementByValue(columnName, columnValue).element(by.xpath(`ancestor::div[contains(@class, 'is-selected')]`));
        BrowserVisibility.waitUntilElementIsNotOnPage(selectedRow);
        return (/** @type {?} */ (this));
    }
    /**
     * @param {?} identifyingColumn
     * @param {?} identifyingValue
     * @param {?} columnName
     * @return {?}
     */
    getColumnValueForRow(identifyingColumn, identifyingValue, columnName) {
        /** @type {?} */
        const row = this.getRow(identifyingColumn, identifyingValue);
        BrowserVisibility.waitUntilElementIsVisible(row);
        /** @type {?} */
        const rowColumn = row.element(by.css(`div[title="${columnName}"] span`));
        BrowserVisibility.waitUntilElementIsVisible(rowColumn);
        return rowColumn.getText();
    }
    /**
     * Check the list is sorted.
     *
     * @param {?} sortOrder
     * @param {?} locator
     * @return {?} 'true' if the list is sorted as expected and 'false' if it isn't
     */
    checkListIsSorted(sortOrder, locator) {
        /** @type {?} */
        const deferred = protractor.promise.defer();
        /** @type {?} */
        const column = element.all(by.css(`div[title='${locator}'] span`));
        BrowserVisibility.waitUntilElementIsVisible(column.first());
        /** @type {?} */
        const initialList = [];
        column.each((/**
         * @param {?} currentElement
         * @return {?}
         */
        function (currentElement) {
            currentElement.getText().then((/**
             * @param {?} text
             * @return {?}
             */
            function (text) {
                initialList.push(text);
            }));
        })).then((/**
         * @return {?}
         */
        function () {
            /** @type {?} */
            let sortedList = initialList;
            sortedList = sortedList.sort();
            if (sortOrder === false) {
                sortedList = sortedList.reverse();
            }
            deferred.fulfill(initialList.toString() === sortedList.toString());
        }));
        return deferred.promise;
    }
    /**
     * @param {?} columnName
     * @param {?} columnValue
     * @return {?}
     */
    rightClickOnRow(columnName, columnValue) {
        /** @type {?} */
        const row = this.getRow(columnName, columnValue);
        browser.actions().click(row, protractor.Button.RIGHT).perform();
        BrowserVisibility.waitUntilElementIsVisible(element(by.id('adf-context-menu-content')));
    }
    /**
     * @param {?} columnName
     * @param {?} columnValue
     * @return {?}
     */
    getTooltip(columnName, columnValue) {
        return this.getCellElementByValue(columnName, columnValue).getAttribute('title');
    }
    /**
     * @param {?} filename
     * @return {?}
     */
    getFileHyperlink(filename) {
        return element(by.cssContainingText('adf-name-column[class*="adf-datatable-link"] span', filename));
    }
    /**
     * @return {?}
     */
    numberOfRows() {
        return this.rootElement.all(this.rows).count();
    }
    /**
     * @param {?} column
     * @return {?}
     */
    getAllRowsColumnValues(column) {
        return tslib_1.__awaiter(this, void 0, void 0, function* () {
            /** @type {?} */
            const columnLocator = by.css("adf-datatable div[class*='adf-datatable-body'] div[class*='adf-datatable-row'] div[title='" + column + "'] span");
            BrowserVisibility.waitUntilElementIsVisible(element.all(columnLocator).first());
            /** @type {?} */
            const initialList = yield element.all(columnLocator).getText();
            return initialList.filter((/**
             * @param {?} el
             * @return {?}
             */
            (el) => el));
        });
    }
    /**
     * @param {?} columnName
     * @param {?} columnValue
     * @return {?}
     */
    getRowsWithSameColumnValues(columnName, columnValue) {
        return tslib_1.__awaiter(this, void 0, void 0, function* () {
            /** @type {?} */
            const columnLocator = by.css(`div[title='${columnName}'] div[data-automation-id="text_${columnValue}"] span`);
            BrowserVisibility.waitUntilElementIsVisible(this.rootElement.all(columnLocator).first());
            return this.rootElement.all(columnLocator).getText();
        });
    }
    /**
     * @template THIS
     * @this {THIS}
     * @param {?} columnName
     * @param {?} columnValue
     * @return {THIS}
     */
    doubleClickRow(columnName, columnValue) {
        /** @type {?} */
        const row = (/** @type {?} */ (this)).getRow(columnName, columnValue);
        BrowserVisibility.waitUntilElementIsVisible(row);
        BrowserVisibility.waitUntilElementIsClickable(row);
        row.click();
        (/** @type {?} */ (this)).checkRowIsSelected(columnName, columnValue);
        browser.actions().sendKeys(protractor.Key.ENTER).perform();
        return (/** @type {?} */ (this));
    }
    /**
     * @return {?}
     */
    waitForTableBody() {
        BrowserVisibility.waitUntilElementIsVisible(this.tableBody);
    }
    /**
     * @param {?} detail
     * @return {?}
     */
    getFirstElementDetail(detail) {
        /** @type {?} */
        const firstNode = element.all(by.css(`adf-datatable div[title="${detail}"] span`)).first();
        return firstNode.getText();
    }
    /**
     * @param {?} detail
     * @return {?}
     */
    geCellElementDetail(detail) {
        return element.all(by.css(`adf-datatable div[title="${detail}"] span`));
    }
    /**
     * @param {?} sortOrder
     * @param {?} column
     * @return {?}
     */
    sortByColumn(sortOrder, column) {
        /** @type {?} */
        const locator = by.css(`div[data-automation-id="auto_id_${column}"]`);
        BrowserVisibility.waitUntilElementIsVisible(element(locator));
        return element(locator).getAttribute('class').then((/**
         * @param {?} result
         * @return {?}
         */
        function (result) {
            if (sortOrder === true) {
                if (!result.includes('sorted-asc')) {
                    if (result.includes('sorted-desc') || result.includes('sortable')) {
                        element(locator).click();
                    }
                }
            }
            else {
                if (result.includes('sorted-asc')) {
                    element(locator).click();
                }
                else if (result.includes('sortable')) {
                    element(locator).click();
                    element(locator).click();
                }
            }
            return Promise.resolve();
        }));
    }
    /**
     * @template THIS
     * @this {THIS}
     * @param {?} columnName
     * @param {?} columnValue
     * @return {THIS}
     */
    checkContentIsDisplayed(columnName, columnValue) {
        /** @type {?} */
        const row = (/** @type {?} */ (this)).getCellElementByValue(columnName, columnValue);
        BrowserVisibility.waitUntilElementIsVisible(row);
        return (/** @type {?} */ (this));
    }
    /**
     * @template THIS
     * @this {THIS}
     * @param {?} columnName
     * @param {?} columnValue
     * @return {THIS}
     */
    checkContentIsNotDisplayed(columnName, columnValue) {
        /** @type {?} */
        const row = (/** @type {?} */ (this)).getCellElementByValue(columnName, columnValue);
        BrowserVisibility.waitUntilElementIsNotOnPage(row);
        return (/** @type {?} */ (this));
    }
    /**
     * @param {?} columnName
     * @param {?} columnValue
     * @return {?}
     */
    getRow(columnName, columnValue) {
        /** @type {?} */
        const row = this.rootElement.all(by.css(`div[title="${columnName}"] div[data-automation-id="text_${columnValue}"]`)).first()
            .element(by.xpath(`ancestor::div[contains(@class, 'adf-datatable-row')]`));
        BrowserVisibility.waitUntilElementIsVisible(row);
        return row;
    }
    /**
     * @param {?} position
     * @return {?}
     */
    contentInPosition(position) {
        BrowserVisibility.waitUntilElementIsVisible(this.contents);
        return this.contents.get(position - 1).getText();
    }
    /**
     * @param {?} columnName
     * @param {?} columnValue
     * @return {?}
     */
    getCellElementByValue(columnName, columnValue) {
        return this.rootElement.all(by.css(`div[title="${columnName}"] div[data-automation-id="text_${columnValue}"] span`)).first();
    }
    /**
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    checkSpinnerIsDisplayed() {
        BrowserVisibility.waitUntilElementIsPresent((/** @type {?} */ (this)).spinner);
        return (/** @type {?} */ (this));
    }
    /**
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    checkSpinnerIsNotDisplayed() {
        BrowserVisibility.waitUntilElementIsNotOnPage((/** @type {?} */ (this)).spinner);
        return (/** @type {?} */ (this));
    }
    /**
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    tableIsLoaded() {
        BrowserVisibility.waitUntilElementIsVisible((/** @type {?} */ (this)).rootElement);
        return (/** @type {?} */ (this));
    }
    /**
     * @template THIS
     * @this {THIS}
     * @param {?} column
     * @return {THIS}
     */
    checkColumnIsDisplayed(column) {
        BrowserVisibility.waitUntilElementIsVisible(element(by.css(`div[data-automation-id="auto_id_entry.${column}"]`)));
        return (/** @type {?} */ (this));
    }
    /**
     * @return {?}
     */
    getNumberOfColumns() {
        return this.allColumns.count();
    }
    /**
     * @return {?}
     */
    getNumberOfRows() {
        return this.list.count();
    }
    /**
     * @param {?} rowNumber
     * @param {?} columnName
     * @return {?}
     */
    getCellByRowNumberAndColumnName(rowNumber, columnName) {
        return this.list.get(rowNumber).element(by.css(`div[title="${columnName}"] span`));
    }
    /**
     * @param {?} rowColumn
     * @param {?} rowContent
     * @param {?} columnName
     * @return {?}
     */
    getCellByRowContentAndColumn(rowColumn, rowContent, columnName) {
        return this.getRow(rowColumn, rowContent).element(by.css(`div[title='${columnName}']`));
    }
    /**
     * @param {?} content
     * @return {?}
     */
    selectRowByContent(content) {
        /** @type {?} */
        const row = this.getCellByContent(content);
        return row.click();
    }
    /**
     * @template THIS
     * @this {THIS}
     * @param {?} folderName
     * @return {THIS}
     */
    checkRowByContentIsSelected(folderName) {
        /** @type {?} */
        const selectedRow = (/** @type {?} */ (this)).getCellByContent(folderName).element(by.xpath(`ancestor::div[contains(@class, 'is-selected')]`));
        BrowserVisibility.waitUntilElementIsVisible(selectedRow);
        return (/** @type {?} */ (this));
    }
    /**
     * @param {?} content
     * @return {?}
     */
    getCellByContent(content) {
        /** @type {?} */
        const cell = this.rootElement.element(by.cssContainingText(`div[class*='adf-datatable-row'] div[class*='adf-name-location-cell-name']`, content));
        BrowserVisibility.waitUntilElementIsVisible(cell);
        return cell;
    }
    /**
     * @param {?} name
     * @return {?}
     */
    clickRowByContent(name) {
        /** @type {?} */
        const resultElement = this.rootElement.all(by.css(`div[data-automation-id='${name}']`)).first();
        BrowserVisibility.waitUntilElementIsVisible(resultElement);
        BrowserVisibility.waitUntilElementIsClickable(resultElement);
        resultElement.click();
    }
    /**
     * @return {?}
     */
    getCopyContentTooltip() {
        BrowserVisibility.waitUntilElementIsVisible(this.copyColumnTooltip);
        return this.copyColumnTooltip.getText();
    }
    /**
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    copyContentTooltipIsNotDisplayed() {
        BrowserVisibility.waitUntilElementIsNotPresent((/** @type {?} */ (this)).copyColumnTooltip);
        return (/** @type {?} */ (this));
    }
    /**
     * @template THIS
     * @this {THIS}
     * @param {?} columnName
     * @param {?} columnValue
     * @return {THIS}
     */
    mouseOverColumn(columnName, columnValue) {
        /** @type {?} */
        const column = (/** @type {?} */ (this)).getCellElementByValue(columnName, columnValue);
        (/** @type {?} */ (this)).mouseOverElement(column);
        return (/** @type {?} */ (this));
    }
    /**
     * @template THIS
     * @this {THIS}
     * @param {?} elem
     * @return {THIS}
     */
    mouseOverElement(elem) {
        BrowserVisibility.waitUntilElementIsVisible(elem);
        browser.actions().mouseMove(elem).perform();
        return (/** @type {?} */ (this));
    }
    /**
     * @template THIS
     * @this {THIS}
     * @param {?} columnName
     * @param {?} columnValue
     * @return {THIS}
     */
    clickColumn(columnName, columnValue) {
        /** @type {?} */
        const column = (/** @type {?} */ (this)).getCellElementByValue(columnName, columnValue);
        (/** @type {?} */ (this)).clickElement(column);
        return (/** @type {?} */ (this));
    }
    /**
     * @template THIS
     * @this {THIS}
     * @param {?} elem
     * @return {THIS}
     */
    clickElement(elem) {
        BrowserVisibility.waitUntilElementIsVisible(elem);
        BrowserVisibility.waitUntilElementIsClickable(elem);
        elem.click();
        return (/** @type {?} */ (this));
    }
}
if (false) {
    /** @type {?} */
    DataTableComponentPage.prototype.rootElement;
    /** @type {?} */
    DataTableComponentPage.prototype.list;
    /** @type {?} */
    DataTableComponentPage.prototype.contents;
    /** @type {?} */
    DataTableComponentPage.prototype.tableBody;
    /** @type {?} */
    DataTableComponentPage.prototype.spinner;
    /** @type {?} */
    DataTableComponentPage.prototype.rows;
    /** @type {?} */
    DataTableComponentPage.prototype.allColumns;
    /** @type {?} */
    DataTableComponentPage.prototype.selectedRowNumber;
    /** @type {?} */
    DataTableComponentPage.prototype.allSelectedRows;
    /** @type {?} */
    DataTableComponentPage.prototype.selectAll;
    /** @type {?} */
    DataTableComponentPage.prototype.copyColumnTooltip;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0YS10YWJsZS1jb21wb25lbnQucGFnZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BhbGZyZXNjby9hZGYtdGVzdGluZy8iLCJzb3VyY2VzIjpbImxpYi9jb3JlL3BhZ2VzL2RhdGEtdGFibGUtY29tcG9uZW50LnBhZ2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBaUJBLE9BQU8sRUFBRSxPQUFPLEVBQUUsRUFBRSxFQUFFLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxZQUFZLENBQUM7QUFFOUQsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0sNkJBQTZCLENBQUM7QUFFaEUsTUFBTSxPQUFPLHNCQUFzQjs7OztJQWMvQixZQUFZLGNBQTZCLE9BQU8sQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxlQUFlLENBQUMsQ0FBQyxDQUFDLEtBQUssRUFBRTtRQVByRixTQUFJLEdBQUcsRUFBRSxDQUFDLEdBQUcsQ0FBQyxnRkFBZ0YsQ0FBQyxDQUFDO1FBUTVGLElBQUksQ0FBQyxXQUFXLEdBQUcsV0FBVyxDQUFDO1FBQy9CLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxrRUFBa0UsQ0FBQyxDQUFDLENBQUM7UUFDN0csSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLHNDQUFzQyxDQUFDLENBQUMsQ0FBQztRQUNyRixJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQyxXQUFXLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsaUNBQWlDLENBQUMsQ0FBQyxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ3pGLElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxz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LENBQUMsVUFBVSxFQUFFLFdBQVcsQ0FBQztRQUNsRSxtQkFBQSxJQUFJLEVBQUEsQ0FBQyxZQUFZLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDMUIsT0FBTyxtQkFBQSxJQUFJLEVBQUEsQ0FBQztJQUNoQixDQUFDOzs7Ozs7O0lBRUQsWUFBWSxDQUFDLElBQUk7UUFDYixpQkFBaUIsQ0FBQyx5QkFBeUIsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNsRCxpQkFBaUIsQ0FBQywyQkFBMkIsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNwRCxJQUFJLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDYixPQUFPLG1CQUFBLElBQUksRUFBQSxDQUFDO0lBQ2hCLENBQUM7Q0FDSjs7O0lBL1VHLDZDQUEyQjs7SUFDM0Isc0NBQXlCOztJQUN6QiwwQ0FBUzs7SUFDVCwyQ0FBVTs7SUFDVix5Q0FBUTs7SUFDUixzQ0FBZ0c7O0lBQ2hHLDRDQUFXOztJQUNYLG1EQUFrQjs7SUFDbEIsaURBQWdCOztJQUNoQiwyQ0FBVTs7SUFDVixtREFBa0IiLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOSBBbGZyZXNjbyBTb2Z0d2FyZSwgTHRkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBicm93c2VyLCBieSwgZWxlbWVudCwgcHJvdHJhY3RvciB9IGZyb20gJ3Byb3RyYWN0b3InO1xuaW1wb3J0IHsgRWxlbWVudEZpbmRlciwgRWxlbWVudEFycmF5RmluZGVyIH0gZnJvbSAncHJvdHJhY3Rvci9idWlsdC9lbGVtZW50JztcbmltcG9ydCB7IEJyb3dzZXJWaXNpYmlsaXR5IH0gZnJvbSAnLi4vdXRpbHMvYnJvd3Nlci12aXNpYmlsaXR5JztcblxuZXhwb3J0IGNsYXNzIERhdGFUYWJsZUNvbXBvbmVudFBhZ2Uge1xuXG4gICAgcm9vdEVsZW1lbnQ6IEVsZW1lbnRGaW5kZXI7XG4gICAgbGlzdDogRWxlbWVudEFycmF5RmluZGVyO1xuICAgIGNvbnRlbnRzO1xuICAgIHRhYmxlQm9keTtcbiAgICBzcGlubmVyO1xuICAgIHJvd3MgPSBieS5jc3MoYGFkZi1kYXRhdGFibGUgZGl2W2NsYXNzKj0nYWRmLWRhdGF0YWJsZS1ib2R5J10gZGl2W2NsYXNzKj0nYWRmLWRhdGF0YWJsZS1yb3cnXWApO1xuICAgIGFsbENvbHVtbnM7XG4gICAgc2VsZWN0ZWRSb3dOdW1iZXI7XG4gICAgYWxsU2VsZWN0ZWRSb3dzO1xuICAgIHNlbGVjdEFsbDtcbiAgICBjb3B5Q29sdW1uVG9vbHRpcDtcblxuICAgIGNvbnN0cnVjdG9yKHJvb3RFbGVtZW50OiBFbGVtZW50RmluZGVyID0gZWxlbWVudC5hbGwoYnkuY3NzKCdhZGYtZGF0YXRhYmxlJykpLmZpcnN0KCkpIHtcbiAgICAgICAgdGhpcy5yb290RWxlbWVudCA9IHJvb3RFbGVtZW50O1xuICAgICAgICB0aGlzLmxpc3QgPSB0aGlzLnJvb3RFbGVtZW50LmFsbChieS5jc3MoYGRpdltjbGFzcyo9J2FkZi1kYXRhdGFibGUtYm9keSddIGRpdltjbGFzcyo9J2FkZi1kYXRhdGFibGUtcm93J11gKSk7XG4gICAgICAgIHRoaXMuY29udGVudHMgPSB0aGlzLnJvb3RFbGVtZW50LmFsbChieS5jc3MoJ2RpdltjbGFzcz1cImFkZi1kYXRhdGFibGUtYm9keVwiXSBzcGFuJykpO1xuICAgICAgICB0aGlzLnRhYmxlQm9keSA9IHRoaXMucm9vdEVsZW1lbnQuYWxsKGJ5LmNzcyhgZGl2W2NsYXNzPSdhZGYtZGF0YXRhYmxlLWJvZHknXWApKS5maXJzdCgpO1xuICAgICAgICB0aGlzLnNwaW5uZXIgPSB0aGlzLnJvb3RFbGVtZW50LmVsZW1lbnQoYnkuY3NzKCdtYXQtcHJvZ3Jlc3Mtc3Bpbm5lcicpKTtcbiAgICAgICAgdGhpcy5hbGxDb2x1bW5zID0gdGhpcy5yb290RWxlbWVudC5hbGwoYnkuY3NzKCdkaXZbZGF0YS1hdXRvbWF0aW9uLWlkKj1cImF1dG9faWRfZW50cnkuXCJdJykpO1xuICAgICAgICB0aGlzLnNlbGVjdGVkUm93TnVtYmVyID0gdGhpcy5yb290RWxlbWVudC5lbGVtZW50KGJ5LmNzcyhgZGl2W2NsYXNzKj0naXMtc2VsZWN0ZWQnXSBkaXZbZGF0YS1hdXRvbWF0aW9uLWlkKj0ndGV4dF8nXWApKTtcbiAgICAgICAgdGhpcy5hbGxTZWxlY3RlZFJvd3MgPSB0aGlzLnJvb3RFbGVtZW50LmFsbChieS5jc3MoYGRpdltjbGFzcyo9J2lzLXNlbGVjdGVkJ11gKSk7XG4gICAgICAgIHRoaXMuc2VsZWN0QWxsID0gdGhpcy5yb290RWxlbWVudC5lbGVtZW50KGJ5LmNzcyhgZGl2W2NsYXNzKj0nYWRmLWRhdGF0YWJsZS1oZWFkZXInXSBtYXQtY2hlY2tib3hgKSk7XG4gICAgICAgIHRoaXMuY29weUNvbHVtblRvb2x0aXAgPSB0aGlzLnJvb3RFbGVtZW50LmVsZW1lbnQoYnkuY3NzKGBhZGYtY29weS1jb250ZW50LXRvb2x0aXAgc3BhbmApKTtcbiAgICB9XG5cbiAgICBjaGVja0FsbFJvd3NCdXR0b25Jc0Rpc3BsYXllZCgpIHtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzVmlzaWJsZSh0aGlzLnNlbGVjdEFsbCk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIGNoZWNrQWxsUm93cygpIHtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzVmlzaWJsZSh0aGlzLnNlbGVjdEFsbCk7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc0NsaWNrYWJsZSh0aGlzLnNlbGVjdEFsbCkudGhlbigoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdEFsbC5jbGljaygpO1xuICAgICAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzVmlzaWJsZSh0aGlzLnNlbGVjdEFsbC5lbGVtZW50KGJ5LmNzcygnaW5wdXRbYXJpYS1jaGVja2VkPVwidHJ1ZVwiXScpKSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICB1bmNoZWNrQWxsUm93cygpIHtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzVmlzaWJsZSh0aGlzLnNlbGVjdEFsbCk7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc0NsaWNrYWJsZSh0aGlzLnNlbGVjdEFsbCkudGhlbigoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdEFsbC5jbGljaygpO1xuICAgICAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzTm90T25QYWdlKHRoaXMuc2VsZWN0QWxsLmVsZW1lbnQoYnkuY3NzKCdpbnB1dFthcmlhLWNoZWNrZWQ9XCJ0cnVlXCJdJykpKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIGNsaWNrQ2hlY2tib3goY29sdW1uTmFtZSwgY29sdW1uVmFsdWUpIHtcbiAgICAgICAgY29uc3QgY2hlY2tib3ggPSB0aGlzLmdldFJvd0NoZWNrYm94KGNvbHVtbk5hbWUsIGNvbHVtblZhbHVlKTtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzQ2xpY2thYmxlKGNoZWNrYm94KTtcbiAgICAgICAgY2hlY2tib3guY2xpY2soKTtcbiAgICB9XG5cbiAgICBjaGVja1Jvd0lzTm90Q2hlY2tlZChjb2x1bW5OYW1lLCBjb2x1bW5WYWx1ZSkge1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNOb3RPblBhZ2UodGhpcy5nZXRSb3dDaGVja2JveChjb2x1bW5OYW1lLCBjb2x1bW5WYWx1ZSkuZWxlbWVudChieS5jc3MoJ2lucHV0W2FyaWEtY2hlY2tlZD1cInRydWVcIl0nKSkpO1xuICAgIH1cblxuICAgIGNoZWNrUm93SXNDaGVja2VkKGNvbHVtbk5hbWUsIGNvbHVtblZhbHVlKSB7XG4gICAgICAgIGNvbnN0IHJvd0NoZWNrYm94ID0gdGhpcy5nZXRSb3dDaGVja2JveChjb2x1bW5OYW1lLCBjb2x1bW5WYWx1ZSk7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc1Zpc2libGUocm93Q2hlY2tib3guZWxlbWVudChieS5jc3MoJ2lucHV0W2FyaWEtY2hlY2tlZD1cInRydWVcIl0nKSkpO1xuICAgIH1cblxuICAgIGdldFJvd0NoZWNrYm94KGNvbHVtbk5hbWUsIGNvbHVtblZhbHVlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFJvdyhjb2x1bW5OYW1lLCBjb2x1bW5WYWx1ZSlcbiAgICAgICAgICAgIC5lbGVtZW50KGJ5LmNzcygnbWF0LWNoZWNrYm94JykpO1xuICAgIH1cblxuICAgIGNoZWNrTm9Sb3dJc1NlbGVjdGVkKCkge1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNOb3RPblBhZ2UodGhpcy5zZWxlY3RlZFJvd051bWJlcik7XG4gICAgfVxuXG4gICAgZ2V0TnVtYmVyT2ZTZWxlY3RlZFJvd3MoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFsbFNlbGVjdGVkUm93cy5jb3VudCgpO1xuICAgIH1cblxuICAgIHNlbGVjdFJvd1dpdGhLZXlib2FyZChjb2x1bW5OYW1lLCBjb2x1bW5WYWx1ZSkge1xuICAgICAgICBjb25zdCByb3cgPSB0aGlzLmdldFJvdyhjb2x1bW5OYW1lLCBjb2x1bW5WYWx1ZSk7XG4gICAgICAgIGJyb3dzZXIuYWN0aW9ucygpLnNlbmRLZXlzKHByb3RyYWN0b3IuS2V5LkNPTU1BTkQpLmNsaWNrKHJvdykucGVyZm9ybSgpO1xuICAgIH1cblxuICAgIHNlbGVjdFJvdyhjb2x1bW5OYW1lLCBjb2x1bW5WYWx1ZSkge1xuICAgICAgICBjb25zdCByb3cgPSB0aGlzLmdldFJvdyhjb2x1bW5OYW1lLCBjb2x1bW5WYWx1ZSk7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc1Zpc2libGUocm93KTtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzQ2xpY2thYmxlKHJvdyk7XG4gICAgICAgIHJvdy5jbGljaygpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICBjaGVja1Jvd0lzU2VsZWN0ZWQoY29sdW1uTmFtZSwgY29sdW1uVmFsdWUpIHtcbiAgICAgICAgY29uc3Qgc2VsZWN0ZWRSb3cgPSB0aGlzLmdldENlbGxFbGVtZW50QnlWYWx1ZShjb2x1bW5OYW1lLCBjb2x1bW5WYWx1ZSkuZWxlbWVudChieS54cGF0aChgYW5jZXN0b3I6OmRpdltjb250YWlucyhAY2xhc3MsICdpcy1zZWxlY3RlZCcpXWApKTtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzVmlzaWJsZShzZWxlY3RlZFJvdyk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIGNoZWNrUm93SXNOb3RTZWxlY3RlZChjb2x1bW5OYW1lLCBjb2x1bW5WYWx1ZSkge1xuICAgICAgICBjb25zdCBzZWxlY3RlZFJvdyA9IHRoaXMuZ2V0Q2VsbEVsZW1lbnRCeVZhbHVlKGNvbHVtbk5hbWUsIGNvbHVtblZhbHVlKS5lbGVtZW50KGJ5LnhwYXRoKGBhbmNlc3Rvcjo6ZGl2W2NvbnRhaW5zKEBjbGFzcywgJ2lzLXNlbGVjdGVkJyldYCkpO1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNOb3RPblBhZ2Uoc2VsZWN0ZWRSb3cpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICBnZXRDb2x1bW5WYWx1ZUZvclJvdyhpZGVudGlmeWluZ0NvbHVtbiwgaWRlbnRpZnlpbmdWYWx1ZSwgY29sdW1uTmFtZSkge1xuICAgICAgICBjb25zdCByb3cgPSB0aGlzLmdldFJvdyhpZGVudGlmeWluZ0NvbHVtbiwgaWRlbnRpZnlpbmdWYWx1ZSk7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc1Zpc2libGUocm93KTtcbiAgICAgICAgY29uc3Qgcm93Q29sdW1uID0gcm93LmVsZW1lbnQoYnkuY3NzKGBkaXZbdGl0bGU9XCIke2NvbHVtbk5hbWV9XCJdIHNwYW5gKSk7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc1Zpc2libGUocm93Q29sdW1uKTtcbiAgICAgICAgcmV0dXJuIHJvd0NvbHVtbi5nZXRUZXh0KCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2sgdGhlIGxpc3QgaXMgc29ydGVkLlxuICAgICAqXG4gICAgICogQHBhcmFtIHNvcnRPcmRlcjogJ3RydWUnIGlmIHRoZSBsaXN0IGlzIGV4cGVjdGVkIHRvIGJlIHNvcnRlZCBhc2NlbmRhbnQgYW5kICdmYWxzZScgZm9yIGRlc2NlbmRhbnRcbiAgICAgKiBAcGFyYW0gbG9jYXRvcjogbG9jYXRvciBmb3IgY29sdW1uXG4gICAgICogQHJldHVybiAndHJ1ZScgaWYgdGhlIGxpc3QgaXMgc29ydGVkIGFzIGV4cGVjdGVkIGFuZCAnZmFsc2UnIGlmIGl0IGlzbid0XG4gICAgICovXG4gICAgY2hlY2tMaXN0SXNTb3J0ZWQoc29ydE9yZGVyLCBsb2NhdG9yKSB7XG4gICAgICAgIGNvbnN0IGRlZmVycmVkID0gcHJvdHJhY3Rvci5wcm9taXNlLmRlZmVyKCk7XG4gICAgICAgIGNvbnN0IGNvbHVtbiA9IGVsZW1lbnQuYWxsKGJ5LmNzcyhgZGl2W3RpdGxlPScke2xvY2F0b3J9J10gc3BhbmApKTtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzVmlzaWJsZShjb2x1bW4uZmlyc3QoKSk7XG4gICAgICAgIGNvbnN0IGluaXRpYWxMaXN0ID0gW107XG4gICAgICAgIGNvbHVtbi5lYWNoKGZ1bmN0aW9uIChjdXJyZW50RWxlbWVudCkge1xuICAgICAgICAgICAgY3VycmVudEVsZW1lbnQuZ2V0VGV4dCgpLnRoZW4oZnVuY3Rpb24gKHRleHQpIHtcbiAgICAgICAgICAgICAgICBpbml0aWFsTGlzdC5wdXNoKHRleHQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgbGV0IHNvcnRlZExpc3QgPSBpbml0aWFsTGlzdDtcbiAgICAgICAgICAgIHNvcnRlZExpc3QgPSBzb3J0ZWRMaXN0LnNvcnQoKTtcbiAgICAgICAgICAgIGlmIChzb3J0T3JkZXIgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgc29ydGVkTGlzdCA9IHNvcnRlZExpc3QucmV2ZXJzZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGVmZXJyZWQuZnVsZmlsbChpbml0aWFsTGlzdC50b1N0cmluZygpID09PSBzb3J0ZWRMaXN0LnRvU3RyaW5nKCkpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgfVxuXG4gICAgcmlnaHRDbGlja09uUm93KGNvbHVtbk5hbWUsIGNvbHVtblZhbHVlKSB7XG4gICAgICAgIGNvbnN0IHJvdyA9IHRoaXMuZ2V0Um93KGNvbHVtbk5hbWUsIGNvbHVtblZhbHVlKTtcbiAgICAgICAgYnJvd3Nlci5hY3Rpb25zKCkuY2xpY2socm93LCBwcm90cmFjdG9yLkJ1dHRvbi5SSUdIVCkucGVyZm9ybSgpO1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNWaXNpYmxlKGVsZW1lbnQoYnkuaWQoJ2FkZi1jb250ZXh0LW1lbnUtY29udGVudCcpKSk7XG4gICAgfVxuXG4gICAgZ2V0VG9vbHRpcChjb2x1bW5OYW1lLCBjb2x1bW5WYWx1ZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRDZWxsRWxlbWVudEJ5VmFsdWUoY29sdW1uTmFtZSwgY29sdW1uVmFsdWUpLmdldEF0dHJpYnV0ZSgndGl0bGUnKTtcbiAgICB9XG5cbiAgICBnZXRGaWxlSHlwZXJsaW5rKGZpbGVuYW1lKSB7XG4gICAgICAgIHJldHVybiBlbGVtZW50KGJ5LmNzc0NvbnRhaW5pbmdUZXh0KCdhZGYtbmFtZS1jb2x1bW5bY2xhc3MqPVwiYWRmLWRhdGF0YWJsZS1saW5rXCJdIHNwYW4nLCBmaWxlbmFtZSkpO1xuICAgIH1cblxuICAgIG51bWJlck9mUm93cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucm9vdEVsZW1lbnQuYWxsKHRoaXMucm93cykuY291bnQoKTtcbiAgICB9XG5cbiAgICBhc3luYyBnZXRBbGxSb3dzQ29sdW1uVmFsdWVzKGNvbHVtbikge1xuICAgICAgICBjb25zdCBjb2x1bW5Mb2NhdG9yID0gYnkuY3NzKFwiYWRmLWRhdGF0YWJsZSBkaXZbY2xhc3MqPSdhZGYtZGF0YXRhYmxlLWJvZHknXSBkaXZbY2xhc3MqPSdhZGYtZGF0YXRhYmxlLXJvdyddIGRpdlt0aXRsZT0nXCIgKyBjb2x1bW4gKyBcIiddIHNwYW5cIik7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc1Zpc2libGUoZWxlbWVudC5hbGwoY29sdW1uTG9jYXRvcikuZmlyc3QoKSk7XG4gICAgICAgIGNvbnN0IGluaXRpYWxMaXN0OiBhbnkgPSBhd2FpdCBlbGVtZW50LmFsbChjb2x1bW5Mb2NhdG9yKS5nZXRUZXh0KCk7XG4gICAgICAgIHJldHVybiBpbml0aWFsTGlzdC5maWx0ZXIoKGVsKSA9PiBlbCk7XG4gICAgfVxuXG4gICAgYXN5bmMgZ2V0Um93c1dpdGhTYW1lQ29sdW1uVmFsdWVzKGNvbHVtbk5hbWUsIGNvbHVtblZhbHVlKSB7XG4gICAgICAgIGNvbnN0IGNvbHVtbkxvY2F0b3IgPSBieS5jc3MoYGRpdlt0aXRsZT0nJHtjb2x1bW5OYW1lfSddIGRpdltkYXRhLWF1dG9tYXRpb24taWQ9XCJ0ZXh0XyR7Y29sdW1uVmFsdWV9XCJdIHNwYW5gKTtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzVmlzaWJsZSh0aGlzLnJvb3RFbGVtZW50LmFsbChjb2x1bW5Mb2NhdG9yKS5maXJzdCgpKTtcbiAgICAgICAgcmV0dXJuIHRoaXMucm9vdEVsZW1lbnQuYWxsKGNvbHVtbkxvY2F0b3IpLmdldFRleHQoKTtcbiAgICB9XG5cbiAgICBkb3VibGVDbGlja1Jvdyhjb2x1bW5OYW1lLCBjb2x1bW5WYWx1ZSkge1xuICAgICAgICBjb25zdCByb3cgPSB0aGlzLmdldFJvdyhjb2x1bW5OYW1lLCBjb2x1bW5WYWx1ZSk7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc1Zpc2libGUocm93KTtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzQ2xpY2thYmxlKHJvdyk7XG4gICAgICAgIHJvdy5jbGljaygpO1xuICAgICAgICB0aGlzLmNoZWNrUm93SXNTZWxlY3RlZChjb2x1bW5OYW1lLCBjb2x1bW5WYWx1ZSk7XG4gICAgICAgIGJyb3dzZXIuYWN0aW9ucygpLnNlbmRLZXlzKHByb3RyYWN0b3IuS2V5LkVOVEVSKS5wZXJmb3JtKCk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIHdhaXRGb3JUYWJsZUJvZHkoKSB7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc1Zpc2libGUodGhpcy50YWJsZUJvZHkpO1xuICAgIH1cblxuICAgIGdldEZpcnN0RWxlbWVudERldGFpbChkZXRhaWwpIHtcbiAgICAgICAgY29uc3QgZmlyc3ROb2RlID0gZWxlbWVudC5hbGwoYnkuY3NzKGBhZGYtZGF0YXRhYmxlIGRpdlt0aXRsZT1cIiR7ZGV0YWlsfVwiXSBzcGFuYCkpLmZpcnN0KCk7XG4gICAgICAgIHJldHVybiBmaXJzdE5vZGUuZ2V0VGV4dCgpO1xuICAgIH1cblxuICAgIGdlQ2VsbEVsZW1lbnREZXRhaWwoZGV0YWlsKSB7XG4gICAgICAgIHJldHVybiBlbGVtZW50LmFsbChieS5jc3MoYGFkZi1kYXRhdGFibGUgZGl2W3RpdGxlPVwiJHtkZXRhaWx9XCJdIHNwYW5gKSk7XG4gICAgfVxuXG4gICAgc29ydEJ5Q29sdW1uKHNvcnRPcmRlciwgY29sdW1uKSB7XG4gICAgICAgIGNvbnN0IGxvY2F0b3IgPSBieS5jc3MoYGRpdltkYXRhLWF1dG9tYXRpb24taWQ9XCJhdXRvX2lkXyR7Y29sdW1ufVwiXWApO1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNWaXNpYmxlKGVsZW1lbnQobG9jYXRvcikpO1xuICAgICAgICByZXR1cm4gZWxlbWVudChsb2NhdG9yKS5nZXRBdHRyaWJ1dGUoJ2NsYXNzJykudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICBpZiAoc29ydE9yZGVyID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFyZXN1bHQuaW5jbHVkZXMoJ3NvcnRlZC1hc2MnKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LmluY2x1ZGVzKCdzb3J0ZWQtZGVzYycpIHx8IHJlc3VsdC5pbmNsdWRlcygnc29ydGFibGUnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudChsb2NhdG9yKS5jbGljaygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LmluY2x1ZGVzKCdzb3J0ZWQtYXNjJykpIHtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudChsb2NhdG9yKS5jbGljaygpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzdWx0LmluY2x1ZGVzKCdzb3J0YWJsZScpKSB7XG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQobG9jYXRvcikuY2xpY2soKTtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudChsb2NhdG9yKS5jbGljaygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBjaGVja0NvbnRlbnRJc0Rpc3BsYXllZChjb2x1bW5OYW1lLCBjb2x1bW5WYWx1ZSkge1xuICAgICAgICBjb25zdCByb3cgPSB0aGlzLmdldENlbGxFbGVtZW50QnlWYWx1ZShjb2x1bW5OYW1lLCBjb2x1bW5WYWx1ZSk7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc1Zpc2libGUocm93KTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgY2hlY2tDb250ZW50SXNOb3REaXNwbGF5ZWQoY29sdW1uTmFtZSwgY29sdW1uVmFsdWUpIHtcbiAgICAgICAgY29uc3Qgcm93ID0gdGhpcy5nZXRDZWxsRWxlbWVudEJ5VmFsdWUoY29sdW1uTmFtZSwgY29sdW1uVmFsdWUpO1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNOb3RPblBhZ2Uocm93KTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgZ2V0Um93KGNvbHVtbk5hbWUsIGNvbHVtblZhbHVlKSB7XG4gICAgICAgIGNvbnN0IHJvdyA9IHRoaXMucm9vdEVsZW1lbnQuYWxsKGJ5LmNzcyhgZGl2W3RpdGxlPVwiJHtjb2x1bW5OYW1lfVwiXSBkaXZbZGF0YS1hdXRvbWF0aW9uLWlkPVwidGV4dF8ke2NvbHVtblZhbHVlfVwiXWApKS5maXJzdCgpXG4gICAgICAgICAgICAuZWxlbWVudChieS54cGF0aChgYW5jZXN0b3I6OmRpdltjb250YWlucyhAY2xhc3MsICdhZGYtZGF0YXRhYmxlLXJvdycpXWApKTtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzVmlzaWJsZShyb3cpO1xuICAgICAgICByZXR1cm4gcm93O1xuICAgIH1cblxuICAgIGNvbnRlbnRJblBvc2l0aW9uKHBvc2l0aW9uKSB7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc1Zpc2libGUodGhpcy5jb250ZW50cyk7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRlbnRzLmdldChwb3NpdGlvbiAtIDEpLmdldFRleHQoKTtcbiAgICB9XG5cbiAgICBnZXRDZWxsRWxlbWVudEJ5VmFsdWUoY29sdW1uTmFtZSwgY29sdW1uVmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucm9vdEVsZW1lbnQuYWxsKGJ5LmNzcyhgZGl2W3RpdGxlPVwiJHtjb2x1bW5OYW1lfVwiXSBkaXZbZGF0YS1hdXRvbWF0aW9uLWlkPVwidGV4dF8ke2NvbHVtblZhbHVlfVwiXSBzcGFuYCkpLmZpcnN0KCk7XG4gICAgfVxuXG4gICAgY2hlY2tTcGlubmVySXNEaXNwbGF5ZWQoKSB7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc1ByZXNlbnQodGhpcy5zcGlubmVyKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgY2hlY2tTcGlubmVySXNOb3REaXNwbGF5ZWQoKSB7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc05vdE9uUGFnZSh0aGlzLnNwaW5uZXIpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICB0YWJsZUlzTG9hZGVkKCkge1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNWaXNpYmxlKHRoaXMucm9vdEVsZW1lbnQpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICBjaGVja0NvbHVtbklzRGlzcGxheWVkKGNvbHVtbikge1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNWaXNpYmxlKGVsZW1lbnQoYnkuY3NzKGBkaXZbZGF0YS1hdXRvbWF0aW9uLWlkPVwiYXV0b19pZF9lbnRyeS4ke2NvbHVtbn1cIl1gKSkpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICBnZXROdW1iZXJPZkNvbHVtbnMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFsbENvbHVtbnMuY291bnQoKTtcbiAgICB9XG5cbiAgICBnZXROdW1iZXJPZlJvd3MoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmxpc3QuY291bnQoKTtcbiAgICB9XG5cbiAgICBnZXRDZWxsQnlSb3dOdW1iZXJBbmRDb2x1bW5OYW1lKHJvd051bWJlciwgY29sdW1uTmFtZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5saXN0LmdldChyb3dOdW1iZXIpLmVsZW1lbnQoYnkuY3NzKGBkaXZbdGl0bGU9XCIke2NvbHVtbk5hbWV9XCJdIHNwYW5gKSk7XG4gICAgfVxuXG4gICAgZ2V0Q2VsbEJ5Um93Q29udGVudEFuZENvbHVtbihyb3dDb2x1bW4sIHJvd0NvbnRlbnQsIGNvbHVtbk5hbWUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Um93KHJvd0NvbHVtbiwgcm93Q29udGVudCkuZWxlbWVudChieS5jc3MoYGRpdlt0aXRsZT0nJHtjb2x1bW5OYW1lfSddYCkpO1xuICAgIH1cblxuICAgIHNlbGVjdFJvd0J5Q29udGVudChjb250ZW50KSB7XG4gICAgICAgIGNvbnN0IHJvdyA9IHRoaXMuZ2V0Q2VsbEJ5Q29udGVudChjb250ZW50KTtcbiAgICAgICAgcmV0dXJuIHJvdy5jbGljaygpO1xuICAgIH1cblxuICAgIGNoZWNrUm93QnlDb250ZW50SXNTZWxlY3RlZChmb2xkZXJOYW1lKSB7XG4gICAgICAgIGNvbnN0IHNlbGVjdGVkUm93ID0gdGhpcy5nZXRDZWxsQnlDb250ZW50KGZvbGRlck5hbWUpLmVsZW1lbnQoYnkueHBhdGgoYGFuY2VzdG9yOjpkaXZbY29udGFpbnMoQGNsYXNzLCAnaXMtc2VsZWN0ZWQnKV1gKSk7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc1Zpc2libGUoc2VsZWN0ZWRSb3cpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICBnZXRDZWxsQnlDb250ZW50KGNvbnRlbnQpIHtcbiAgICAgICAgY29uc3QgY2VsbCA9IHRoaXMucm9vdEVsZW1lbnQuZWxlbWVudChieS5jc3NDb250YWluaW5nVGV4dChgZGl2W2NsYXNzKj0nYWRmLWRhdGF0YWJsZS1yb3cnXSBkaXZbY2xhc3MqPSdhZGYtbmFtZS1sb2NhdGlvbi1jZWxsLW5hbWUnXWAsIGNvbnRlbnQpKTtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzVmlzaWJsZShjZWxsKTtcbiAgICAgICAgcmV0dXJuIGNlbGw7XG4gICAgfVxuXG4gICAgY2xpY2tSb3dCeUNvbnRlbnQobmFtZSkge1xuICAgICAgICBjb25zdCByZXN1bHRFbGVtZW50ID0gdGhpcy5yb290RWxlbWVudC5hbGwoYnkuY3NzKGBkaXZbZGF0YS1hdXRvbWF0aW9uLWlkPScke25hbWV9J11gKSkuZmlyc3QoKTtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzVmlzaWJsZShyZXN1bHRFbGVtZW50KTtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzQ2xpY2thYmxlKHJlc3VsdEVsZW1lbnQpO1xuICAgICAgICByZXN1bHRFbGVtZW50LmNsaWNrKCk7XG4gICAgfVxuXG4gICAgZ2V0Q29weUNvbnRlbnRUb29sdGlwKCkge1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNWaXNpYmxlKHRoaXMuY29weUNvbHVtblRvb2x0aXApO1xuICAgICAgICByZXR1cm4gdGhpcy5jb3B5Q29sdW1uVG9vbHRpcC5nZXRUZXh0KCk7XG4gICAgfVxuXG4gICAgY29weUNvbnRlbnRUb29sdGlwSXNOb3REaXNwbGF5ZWQoKSB7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc05vdFByZXNlbnQodGhpcy5jb3B5Q29sdW1uVG9vbHRpcCk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIG1vdXNlT3ZlckNvbHVtbihjb2x1bW5OYW1lLCBjb2x1bW5WYWx1ZSkge1xuICAgICAgICBjb25zdCBjb2x1bW4gPSB0aGlzLmdldENlbGxFbGVtZW50QnlWYWx1ZShjb2x1bW5OYW1lLCBjb2x1bW5WYWx1ZSk7XG4gICAgICAgIHRoaXMubW91c2VPdmVyRWxlbWVudChjb2x1bW4pO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICBtb3VzZU92ZXJFbGVtZW50KGVsZW0pIHtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzVmlzaWJsZShlbGVtKTtcbiAgICAgICAgYnJvd3Nlci5hY3Rpb25zKCkubW91c2VNb3ZlKGVsZW0pLnBlcmZvcm0oKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgY2xpY2tDb2x1bW4oY29sdW1uTmFtZSwgY29sdW1uVmFsdWUpIHtcbiAgICAgICAgY29uc3QgY29sdW1uID0gdGhpcy5nZXRDZWxsRWxlbWVudEJ5VmFsdWUoY29sdW1uTmFtZSwgY29sdW1uVmFsdWUpO1xuICAgICAgICB0aGlzLmNsaWNrRWxlbWVudChjb2x1bW4pO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICBjbGlja0VsZW1lbnQoZWxlbSkge1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNWaXNpYmxlKGVsZW0pO1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNDbGlja2FibGUoZWxlbSk7XG4gICAgICAgIGVsZW0uY2xpY2soKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxufVxuIl19