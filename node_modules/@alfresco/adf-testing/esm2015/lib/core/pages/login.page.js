/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
/*!
 * @license
 * Copyright 2019 Alfresco Software, Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
import { FormControllersPage } from './form-controller.page';
import { browser, by, element, protractor } from 'protractor';
import { BrowserVisibility } from '../utils/browser-visibility';
import { LocalStorageUtil } from '../utils/local-storage.util';
export class LoginPage {
    constructor() {
        this.loginURL = browser.baseUrl + '/login';
        this.formControllersPage = new FormControllersPage();
        this.txtUsername = element(by.css('input[id="username"]'));
        this.txtPassword = element(by.css('input[id="password"]'));
        this.logoImg = element(by.css('img[id="adf-login-img-logo"]'));
        this.successRouteTxt = element(by.css('input[data-automation-id="adf-success-route"]'));
        this.logoTxt = element(by.css('input[data-automation-id="adf-url-logo"]'));
        this.usernameTooltip = element(by.css('span[data-automation-id="username-error"]'));
        this.passwordTooltip = element(by.css('span[data-automation-id="password-required"]'));
        this.loginTooltip = element(by.css('span[class="adf-login-error-message"]'));
        this.usernameInactive = element(by.css('input[id="username"][aria-invalid="false"]'));
        this.passwordInactive = element(by.css('input[id="password"][aria-invalid="false"]'));
        this.adfLogo = element(by.css('img[class="adf-img-logo ng-star-inserted"]'));
        this.usernameHighlighted = element(by.css('input[id="username"][aria-invalid="true"]'));
        this.passwordHighlighted = element(by.css('input[id="password"][aria-invalid="true"]'));
        this.signInButton = element(by.id('login-button'));
        this.showPasswordElement = element(by.css('mat-icon[data-automation-id="show_password"]'));
        this.hidePasswordElement = element(by.css('mat-icon[data-automation-id="hide_password"]'));
        this.rememberMe = element(by.css('mat-checkbox[id="adf-login-remember"]'));
        this.needHelp = element(by.css('div[id="adf-login-action-left"]'));
        this.register = element(by.css('div[id="adf-login-action-right"]'));
        this.footerSwitch = element(by.id('switch4'));
        this.rememberMeSwitch = element(by.id('adf-toggle-show-rememberme'));
        this.successRouteSwitch = element(by.id('adf-toggle-show-successRoute'));
        this.logoSwitch = element(by.id('adf-toggle-logo'));
        this.header = element(by.id('adf-header'));
        this.settingsIcon = element(by.cssContainingText('a[data-automation-id="settings"] mat-icon', 'settings'));
    }
    /**
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    goToLoginPage() {
        browser.waitForAngularEnabled(true);
        browser.driver.get((/** @type {?} */ (this)).loginURL);
        (/** @type {?} */ (this)).waitForElements();
        return (/** @type {?} */ (this));
    }
    /**
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    waitForElements() {
        BrowserVisibility.waitUntilElementIsVisible((/** @type {?} */ (this)).txtUsername);
        BrowserVisibility.waitUntilElementIsVisible((/** @type {?} */ (this)).txtPassword);
        return (/** @type {?} */ (this));
    }
    /**
     * @param {?} username
     * @return {?}
     */
    enterUsername(username) {
        BrowserVisibility.waitUntilElementIsVisible(this.txtUsername);
        this.txtUsername.sendKeys('');
        this.txtUsername.clear();
        return this.txtUsername.sendKeys(username);
    }
    /**
     * @param {?} password
     * @return {?}
     */
    enterPassword(password) {
        BrowserVisibility.waitUntilElementIsVisible(this.txtPassword);
        this.txtPassword.clear();
        return this.txtPassword.sendKeys(password);
    }
    /**
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    clearUsername() {
        BrowserVisibility.waitUntilElementIsVisible((/** @type {?} */ (this)).txtUsername);
        (/** @type {?} */ (this)).txtUsername.click();
        (/** @type {?} */ (this)).txtUsername.getAttribute('value').then((/**
         * @param {?} value
         * @return {?}
         */
        (value) => {
            for (let i = value.length; i >= 0; i--) {
                (/** @type {?} */ (this)).txtUsername.sendKeys(protractor.Key.BACK_SPACE);
            }
        }));
        return (/** @type {?} */ (this));
    }
    /**
     * @return {?}
     */
    clearPassword() {
        BrowserVisibility.waitUntilElementIsVisible(this.txtPassword);
        this.txtPassword.getAttribute('value').then((/**
         * @param {?} value
         * @return {?}
         */
        (value) => {
            for (let i = value.length; i >= 0; i--) {
                this.txtPassword.sendKeys(protractor.Key.BACK_SPACE);
            }
        }));
    }
    /**
     * @return {?}
     */
    getUsernameTooltip() {
        BrowserVisibility.waitUntilElementIsVisible(this.usernameTooltip);
        return this.usernameTooltip.getText();
    }
    /**
     * @return {?}
     */
    getPasswordTooltip() {
        BrowserVisibility.waitUntilElementIsVisible(this.passwordTooltip);
        return this.passwordTooltip.getText();
    }
    /**
     * @return {?}
     */
    getLoginError() {
        BrowserVisibility.waitUntilElementIsVisible(this.loginTooltip);
        return this.loginTooltip.getText();
    }
    /**
     * @return {?}
     */
    checkLoginImgURL() {
        BrowserVisibility.waitUntilElementIsVisible(this.logoImg);
        return this.logoImg.getAttribute('src');
    }
    /**
     * @return {?}
     */
    checkUsernameInactive() {
        BrowserVisibility.waitUntilElementIsVisible(this.usernameInactive);
    }
    /**
     * @return {?}
     */
    checkPasswordInactive() {
        BrowserVisibility.waitUntilElementIsVisible(this.passwordInactive);
    }
    /**
     * @return {?}
     */
    checkUsernameHighlighted() {
        this.adfLogo.click();
        BrowserVisibility.waitUntilElementIsVisible(this.usernameHighlighted);
    }
    /**
     * @return {?}
     */
    checkPasswordHighlighted() {
        this.adfLogo.click();
        BrowserVisibility.waitUntilElementIsVisible(this.passwordHighlighted);
    }
    /**
     * @return {?}
     */
    checkUsernameTooltipIsNotVisible() {
        BrowserVisibility.waitUntilElementIsNotVisible(this.usernameTooltip);
    }
    /**
     * @return {?}
     */
    checkPasswordTooltipIsNotVisible() {
        BrowserVisibility.waitUntilElementIsNotVisible(this.passwordTooltip);
    }
    /**
     * @return {?}
     */
    getSignInButtonIsEnabled() {
        BrowserVisibility.waitUntilElementIsVisible(this.signInButton);
        return this.signInButton.isEnabled();
    }
    /**
     * @param {?} userModel
     * @return {?}
     */
    loginToProcessServicesUsingUserModel(userModel) {
        return tslib_1.__awaiter(this, void 0, void 0, function* () {
            this.goToLoginPage();
            yield LocalStorageUtil.clearStorage();
            yield LocalStorageUtil.setStorageItem('providers', 'BPM');
            yield LocalStorageUtil.apiReset();
            this.login(userModel.email, userModel.password);
        });
    }
    /**
     * @param {?} userModel
     * @return {?}
     */
    loginToContentServicesUsingUserModel(userModel) {
        return tslib_1.__awaiter(this, void 0, void 0, function* () {
            this.goToLoginPage();
            yield LocalStorageUtil.clearStorage();
            yield LocalStorageUtil.setStorageItem('providers', 'ECM');
            yield LocalStorageUtil.apiReset();
            this.login(userModel.getId(), userModel.getPassword());
        });
    }
    /**
     * @param {?} username
     * @param {?} password
     * @return {?}
     */
    loginToContentServices(username, password) {
        return tslib_1.__awaiter(this, void 0, void 0, function* () {
            this.goToLoginPage();
            yield LocalStorageUtil.clearStorage();
            yield LocalStorageUtil.setStorageItem('providers', 'ECM');
            yield LocalStorageUtil.apiReset();
            this.waitForElements();
            this.login(username, password);
        });
    }
    /**
     * @return {?}
     */
    clickSignInButton() {
        BrowserVisibility.waitUntilElementIsVisible(this.signInButton);
        this.signInButton.click();
    }
    /**
     * @return {?}
     */
    clickSettingsIcon() {
        BrowserVisibility.waitUntilElementIsVisible(this.settingsIcon);
        this.settingsIcon.click();
    }
    /**
     * @return {?}
     */
    showPassword() {
        BrowserVisibility.waitUntilElementIsVisible(this.showPasswordElement);
        this.showPasswordElement.click();
    }
    /**
     * @return {?}
     */
    hidePassword() {
        BrowserVisibility.waitUntilElementIsVisible(this.hidePasswordElement);
        this.hidePasswordElement.click();
    }
    /**
     * @return {?}
     */
    getShownPassword() {
        return this.txtPassword.getAttribute('value');
    }
    /**
     * @return {?}
     */
    checkPasswordIsHidden() {
        BrowserVisibility.waitUntilElementIsVisible(this.txtPassword);
    }
    /**
     * @return {?}
     */
    checkRememberIsDisplayed() {
        BrowserVisibility.waitUntilElementIsVisible(this.rememberMe);
    }
    /**
     * @return {?}
     */
    checkRememberIsNotDisplayed() {
        BrowserVisibility.waitUntilElementIsNotVisible(this.rememberMe);
    }
    /**
     * @return {?}
     */
    checkNeedHelpIsDisplayed() {
        BrowserVisibility.waitUntilElementIsVisible(this.needHelp);
    }
    /**
     * @return {?}
     */
    checkNeedHelpIsNotDisplayed() {
        BrowserVisibility.waitUntilElementIsNotVisible(this.needHelp);
    }
    /**
     * @return {?}
     */
    checkRegisterDisplayed() {
        BrowserVisibility.waitUntilElementIsVisible(this.register);
    }
    /**
     * @return {?}
     */
    checkRegisterIsNotDisplayed() {
        BrowserVisibility.waitUntilElementIsNotVisible(this.register);
    }
    /**
     * @return {?}
     */
    enableFooter() {
        this.formControllersPage.enableToggle(this.footerSwitch);
    }
    /**
     * @return {?}
     */
    disableFooter() {
        this.formControllersPage.disableToggle(this.footerSwitch);
    }
    /**
     * @return {?}
     */
    disableRememberMe() {
        this.formControllersPage.disableToggle(this.rememberMeSwitch);
    }
    /**
     * @return {?}
     */
    enableSuccessRouteSwitch() {
        this.formControllersPage.enableToggle(this.successRouteSwitch);
    }
    /**
     * @return {?}
     */
    enableLogoSwitch() {
        this.formControllersPage.enableToggle(this.logoSwitch);
    }
    /**
     * @param {?} route
     * @return {?}
     */
    enterSuccessRoute(route) {
        BrowserVisibility.waitUntilElementIsVisible(this.successRouteTxt);
        this.successRouteTxt.sendKeys('');
        this.successRouteTxt.clear();
        return this.successRouteTxt.sendKeys(route);
    }
    /**
     * @param {?} logo
     * @return {?}
     */
    enterLogo(logo) {
        BrowserVisibility.waitUntilElementIsVisible(this.logoTxt);
        this.logoTxt.sendKeys('');
        this.logoTxt.clear();
        return this.logoTxt.sendKeys(logo);
    }
    /**
     * @param {?} username
     * @param {?} password
     * @return {?}
     */
    login(username, password) {
        this.waitForElements();
        this.enterUsername(username);
        this.enterPassword(password);
        this.clickSignInButton();
        return BrowserVisibility.waitUntilElementIsVisible(this.header);
    }
}
if (false) {
    /** @type {?} */
    LoginPage.prototype.loginURL;
    /** @type {?} */
    LoginPage.prototype.formControllersPage;
    /** @type {?} */
    LoginPage.prototype.txtUsername;
    /** @type {?} */
    LoginPage.prototype.txtPassword;
    /** @type {?} */
    LoginPage.prototype.logoImg;
    /** @type {?} */
    LoginPage.prototype.successRouteTxt;
    /** @type {?} */
    LoginPage.prototype.logoTxt;
    /** @type {?} */
    LoginPage.prototype.usernameTooltip;
    /** @type {?} */
    LoginPage.prototype.passwordTooltip;
    /** @type {?} */
    LoginPage.prototype.loginTooltip;
    /** @type {?} */
    LoginPage.prototype.usernameInactive;
    /** @type {?} */
    LoginPage.prototype.passwordInactive;
    /** @type {?} */
    LoginPage.prototype.adfLogo;
    /** @type {?} */
    LoginPage.prototype.usernameHighlighted;
    /** @type {?} */
    LoginPage.prototype.passwordHighlighted;
    /** @type {?} */
    LoginPage.prototype.signInButton;
    /** @type {?} */
    LoginPage.prototype.showPasswordElement;
    /** @type {?} */
    LoginPage.prototype.hidePasswordElement;
    /** @type {?} */
    LoginPage.prototype.rememberMe;
    /** @type {?} */
    LoginPage.prototype.needHelp;
    /** @type {?} */
    LoginPage.prototype.register;
    /** @type {?} */
    LoginPage.prototype.footerSwitch;
    /** @type {?} */
    LoginPage.prototype.rememberMeSwitch;
    /** @type {?} */
    LoginPage.prototype.successRouteSwitch;
    /** @type {?} */
    LoginPage.prototype.logoSwitch;
    /** @type {?} */
    LoginPage.prototype.header;
    /** @type {?} */
    LoginPage.prototype.settingsIcon;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9naW4ucGFnZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BhbGZyZXNjby9hZGYtdGVzdGluZy8iLCJzb3VyY2VzIjpbImxpYi9jb3JlL3BhZ2VzL2xvZ2luLnBhZ2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBaUJBLE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQzdELE9BQU8sRUFBRSxPQUFPLEVBQUUsRUFBRSxFQUFFLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxZQUFZLENBQUM7QUFDOUQsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0sNkJBQTZCLENBQUM7QUFDaEUsT0FBTyxFQUFFLGdCQUFnQixFQUFFLE1BQU0sNkJBQTZCLENBQUM7QUFFL0QsTUFBTSxPQUFPLFNBQVM7SUFBdEI7UUFFSSxhQUFRLEdBQUcsT0FBTyxDQUFDLE9BQU8sR0FBRyxRQUFRLENBQUM7UUFFdEMsd0JBQW1CLEdBQUcsSUFBSSxtQkFBbUIsRUFBRSxDQUFDO1FBQ2hELGdCQUFXLEdBQUcsT0FBTyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsc0JBQXNCLENBQUMsQ0FBQyxDQUFDO1FBQ3RELGdCQUFXLEdBQUcsT0FBTyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsc0JBQXNCLENBQUMsQ0FBQyxDQUFDO1FBQ3RELFlBQU8sR0FBRyxPQUFPLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyw4QkFBOEIsQ0FBQyxDQUFDLENBQUM7UUFDMUQsb0JBQWUsR0FBRyxPQUFPLENBQ3JCLEVBQUUsQ0FBQyxHQUFHLENBQUMsK0NBQStDLENBQUMsQ0FDMUQsQ0FBQztRQUNGLFlBQU8sR0FBRyxPQUFPLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQywwQ0FBMEMsQ0FBQyxDQUFDLENBQUM7UUFDdEUsb0JBQWUsR0FBRyxPQUFPLENBQ3JCLEVBQUUsQ0FBQyxHQUFHLENBQUMsMkNBQTJDLENBQUMsQ0FDdEQsQ0FBQztR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LENBQUMsQ0FBQztRQUM3QixJQUFJLENBQUMsYUFBYSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQzdCLElBQUksQ0FBQyxpQkFBaUIsRUFBRSxDQUFDO1FBQ3pCLE9BQU8saUJBQWlCLENBQUMseUJBQXlCLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQ3BFLENBQUM7Q0FDSjs7O0lBM1FHLDZCQUFzQzs7SUFFdEMsd0NBQWdEOztJQUNoRCxnQ0FBc0Q7O0lBQ3RELGdDQUFzRDs7SUFDdEQsNEJBQTBEOztJQUMxRCxvQ0FFRTs7SUFDRiw0QkFBc0U7O0lBQ3RFLG9DQUVFOztJQUNGLG9DQUVFOztJQUNGLGlDQUF3RTs7SUFDeEUscUNBRUU7O0lBQ0YscUNBRUU7O0lBQ0YsNEJBQXdFOztJQUN4RSx3Q0FFRTs7SUFDRix3Q0FFRTs7SUFDRixpQ0FBOEM7O0lBQzlDLHdDQUVFOztJQUNGLHdDQUVFOztJQUNGLCtCQUFzRTs7SUFDdEUsNkJBQThEOztJQUM5RCw2QkFBK0Q7O0lBQy9ELGlDQUF5Qzs7SUFDekMscUNBQWdFOztJQUNoRSx1Q0FBb0U7O0lBQ3BFLCtCQUErQzs7SUFDL0MsMkJBQXNDOztJQUN0QyxpQ0FLRSIsInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEFsZnJlc2NvIFNvZnR3YXJlLCBMdGQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IEZvcm1Db250cm9sbGVyc1BhZ2UgfSBmcm9tICcuL2Zvcm0tY29udHJvbGxlci5wYWdlJztcbmltcG9ydCB7IGJyb3dzZXIsIGJ5LCBlbGVtZW50LCBwcm90cmFjdG9yIH0gZnJvbSAncHJvdHJhY3Rvcic7XG5pbXBvcnQgeyBCcm93c2VyVmlzaWJpbGl0eSB9IGZyb20gJy4uL3V0aWxzL2Jyb3dzZXItdmlzaWJpbGl0eSc7XG5pbXBvcnQgeyBMb2NhbFN0b3JhZ2VVdGlsIH0gZnJvbSAnLi4vdXRpbHMvbG9jYWwtc3RvcmFnZS51dGlsJztcblxuZXhwb3J0IGNsYXNzIExvZ2luUGFnZSB7XG5cbiAgICBsb2dpblVSTCA9IGJyb3dzZXIuYmFzZVVybCArICcvbG9naW4nO1xuXG4gICAgZm9ybUNvbnRyb2xsZXJzUGFnZSA9IG5ldyBGb3JtQ29udHJvbGxlcnNQYWdlKCk7XG4gICAgdHh0VXNlcm5hbWUgPSBlbGVtZW50KGJ5LmNzcygnaW5wdXRbaWQ9XCJ1c2VybmFtZVwiXScpKTtcbiAgICB0eHRQYXNzd29yZCA9IGVsZW1lbnQoYnkuY3NzKCdpbnB1dFtpZD1cInBhc3N3b3JkXCJdJykpO1xuICAgIGxvZ29JbWcgPSBlbGVtZW50KGJ5LmNzcygnaW1nW2lkPVwiYWRmLWxvZ2luLWltZy1sb2dvXCJdJykpO1xuICAgIHN1Y2Nlc3NSb3V0ZVR4dCA9IGVsZW1lbnQoXG4gICAgICAgIGJ5LmNzcygnaW5wdXRbZGF0YS1hdXRvbWF0aW9uLWlkPVwiYWRmLXN1Y2Nlc3Mtcm91dGVcIl0nKVxuICAgICk7XG4gICAgbG9nb1R4dCA9IGVsZW1lbnQoYnkuY3NzKCdpbnB1dFtkYXRhLWF1dG9tYXRpb24taWQ9XCJhZGYtdXJsLWxvZ29cIl0nKSk7XG4gICAgdXNlcm5hbWVUb29sdGlwID0gZWxlbWVudChcbiAgICAgICAgYnkuY3NzKCdzcGFuW2RhdGEtYXV0b21hdGlvbi1pZD1cInVzZXJuYW1lLWVycm9yXCJdJylcbiAgICApO1xuICAgIHBhc3N3b3JkVG9vbHRpcCA9IGVsZW1lbnQoXG4gICAgICAgIGJ5LmNzcygnc3BhbltkYXRhLWF1dG9tYXRpb24taWQ9XCJwYXNzd29yZC1yZXF1aXJlZFwiXScpXG4gICAgKTtcbiAgICBsb2dpblRvb2x0aXAgPSBlbGVtZW50KGJ5LmNzcygnc3BhbltjbGFzcz1cImFkZi1sb2dpbi1lcnJvci1tZXNzYWdlXCJdJykpO1xuICAgIHVzZXJuYW1lSW5hY3RpdmUgPSBlbGVtZW50KFxuICAgICAgICBieS5jc3MoJ2lucHV0W2lkPVwidXNlcm5hbWVcIl1bYXJpYS1pbnZhbGlkPVwiZmFsc2VcIl0nKVxuICAgICk7XG4gICAgcGFzc3dvcmRJbmFjdGl2ZSA9IGVsZW1lbnQoXG4gICAgICAgIGJ5LmNzcygnaW5wdXRbaWQ9XCJwYXNzd29yZFwiXVthcmlhLWludmFsaWQ9XCJmYWxzZVwiXScpXG4gICAgKTtcbiAgICBhZGZMb2dvID0gZWxlbWVudChieS5jc3MoJ2ltZ1tjbGFzcz1cImFkZi1pbWctbG9nbyBuZy1zdGFyLWluc2VydGVkXCJdJykpO1xuICAgIHVzZXJuYW1lSGlnaGxpZ2h0ZWQgPSBlbGVtZW50KFxuICAgICAgICBieS5jc3MoJ2lucHV0W2lkPVwidXNlcm5hbWVcIl1bYXJpYS1pbnZhbGlkPVwidHJ1ZVwiXScpXG4gICAgKTtcbiAgICBwYXNzd29yZEhpZ2hsaWdodGVkID0gZWxlbWVudChcbiAgICAgICAgYnkuY3NzKCdpbnB1dFtpZD1cInBhc3N3b3JkXCJdW2FyaWEtaW52YWxpZD1cInRydWVcIl0nKVxuICAgICk7XG4gICAgc2lnbkluQnV0dG9uID0gZWxlbWVudChieS5pZCgnbG9naW4tYnV0dG9uJykpO1xuICAgIHNob3dQYXNzd29yZEVsZW1lbnQgPSBlbGVtZW50KFxuICAgICAgICBieS5jc3MoJ21hdC1pY29uW2RhdGEtYXV0b21hdGlvbi1pZD1cInNob3dfcGFzc3dvcmRcIl0nKVxuICAgICk7XG4gICAgaGlkZVBhc3N3b3JkRWxlbWVudCA9IGVsZW1lbnQoXG4gICAgICAgIGJ5LmNzcygnbWF0LWljb25bZGF0YS1hdXRvbWF0aW9uLWlkPVwiaGlkZV9wYXNzd29yZFwiXScpXG4gICAgKTtcbiAgICByZW1lbWJlck1lID0gZWxlbWVudChieS5jc3MoJ21hdC1jaGVja2JveFtpZD1cImFkZi1sb2dpbi1yZW1lbWJlclwiXScpKTtcbiAgICBuZWVkSGVscCA9IGVsZW1lbnQoYnkuY3NzKCdkaXZbaWQ9XCJhZGYtbG9naW4tYWN0aW9uLWxlZnRcIl0nKSk7XG4gICAgcmVnaXN0ZXIgPSBlbGVtZW50KGJ5LmNzcygnZGl2W2lkPVwiYWRmLWxvZ2luLWFjdGlvbi1yaWdodFwiXScpKTtcbiAgICBmb290ZXJTd2l0Y2ggPSBlbGVtZW50KGJ5LmlkKCdzd2l0Y2g0JykpO1xuICAgIHJlbWVtYmVyTWVTd2l0Y2ggPSBlbGVtZW50KGJ5LmlkKCdhZGYtdG9nZ2xlLXNob3ctcmVtZW1iZXJtZScpKTtcbiAgICBzdWNjZXNzUm91dGVTd2l0Y2ggPSBlbGVtZW50KGJ5LmlkKCdhZGYtdG9nZ2xlLXNob3ctc3VjY2Vzc1JvdXRlJykpO1xuICAgIGxvZ29Td2l0Y2ggPSBlbGVtZW50KGJ5LmlkKCdhZGYtdG9nZ2xlLWxvZ28nKSk7XG4gICAgaGVhZGVyID0gZWxlbWVudChieS5pZCgnYWRmLWhlYWRlcicpKTtcbiAgICBzZXR0aW5nc0ljb24gPSBlbGVtZW50KFxuICAgICAgICBieS5jc3NDb250YWluaW5nVGV4dChcbiAgICAgICAgICAgICdhW2RhdGEtYXV0b21hdGlvbi1pZD1cInNldHRpbmdzXCJdIG1hdC1pY29uJyxcbiAgICAgICAgICAgICdzZXR0aW5ncydcbiAgICAgICAgKVxuICAgICk7XG5cbiAgICBnb1RvTG9naW5QYWdlKCkge1xuICAgICAgICBicm93c2VyLndhaXRGb3JBbmd1bGFyRW5hYmxlZCh0cnVlKTtcbiAgICAgICAgYnJvd3Nlci5kcml2ZXIuZ2V0KHRoaXMubG9naW5VUkwpO1xuICAgICAgICB0aGlzLndhaXRGb3JFbGVtZW50cygpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICB3YWl0Rm9yRWxlbWVudHMoKSB7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc1Zpc2libGUodGhpcy50eHRVc2VybmFtZSk7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc1Zpc2libGUodGhpcy50eHRQYXNzd29yZCk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIGVudGVyVXNlcm5hbWUodXNlcm5hbWUpIHtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzVmlzaWJsZSh0aGlzLnR4dFVzZXJuYW1lKTtcbiAgICAgICAgdGhpcy50eHRVc2VybmFtZS5zZW5kS2V5cygnJyk7XG4gICAgICAgIHRoaXMudHh0VXNlcm5hbWUuY2xlYXIoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMudHh0VXNlcm5hbWUuc2VuZEtleXModXNlcm5hbWUpO1xuICAgIH1cblxuICAgIGVudGVyUGFzc3dvcmQocGFzc3dvcmQpIHtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzVmlzaWJsZSh0aGlzLnR4dFBhc3N3b3JkKTtcbiAgICAgICAgdGhpcy50eHRQYXNzd29yZC5jbGVhcigpO1xuICAgICAgICByZXR1cm4gdGhpcy50eHRQYXNzd29yZC5zZW5kS2V5cyhwYXNzd29yZCk7XG4gICAgfVxuXG4gICAgY2xlYXJVc2VybmFtZSgpIHtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzVmlzaWJsZSh0aGlzLnR4dFVzZXJuYW1lKTtcbiAgICAgICAgdGhpcy50eHRVc2VybmFtZS5jbGljaygpO1xuICAgICAgICB0aGlzLnR4dFVzZXJuYW1lLmdldEF0dHJpYnV0ZSgndmFsdWUnKS50aGVuKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IHZhbHVlLmxlbmd0aDsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgICAgICB0aGlzLnR4dFVzZXJuYW1lLnNlbmRLZXlzKHByb3RyYWN0b3IuS2V5LkJBQ0tfU1BBQ0UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgY2xlYXJQYXNzd29yZCgpIHtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzVmlzaWJsZSh0aGlzLnR4dFBhc3N3b3JkKTtcbiAgICAgICAgdGhpcy50eHRQYXNzd29yZC5nZXRBdHRyaWJ1dGUoJ3ZhbHVlJykudGhlbigodmFsdWUpID0+IHtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSB2YWx1ZS5sZW5ndGg7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICAgICAgdGhpcy50eHRQYXNzd29yZC5zZW5kS2V5cyhwcm90cmFjdG9yLktleS5CQUNLX1NQQUNFKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZ2V0VXNlcm5hbWVUb29sdGlwKCkge1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNWaXNpYmxlKHRoaXMudXNlcm5hbWVUb29sdGlwKTtcbiAgICAgICAgcmV0dXJuIHRoaXMudXNlcm5hbWVUb29sdGlwLmdldFRleHQoKTtcbiAgICB9XG5cbiAgICBnZXRQYXNzd29yZFRvb2x0aXAoKSB7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc1Zpc2libGUodGhpcy5wYXNzd29yZFRvb2x0aXApO1xuICAgICAgICByZXR1cm4gdGhpcy5wYXNzd29yZFRvb2x0aXAuZ2V0VGV4dCgpO1xuICAgIH1cblxuICAgIGdldExvZ2luRXJyb3IoKSB7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc1Zpc2libGUodGhpcy5sb2dpblRvb2x0aXApO1xuICAgICAgICByZXR1cm4gdGhpcy5sb2dpblRvb2x0aXAuZ2V0VGV4dCgpO1xuICAgIH1cblxuICAgIGNoZWNrTG9naW5JbWdVUkwoKSB7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc1Zpc2libGUodGhpcy5sb2dvSW1nKTtcbiAgICAgICAgcmV0dXJuIHRoaXMubG9nb0ltZy5nZXRBdHRyaWJ1dGUoJ3NyYycpO1xuICAgIH1cblxuICAgIGNoZWNrVXNlcm5hbWVJbmFjdGl2ZSgpIHtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzVmlzaWJsZSh0aGlzLnVzZXJuYW1lSW5hY3RpdmUpO1xuICAgIH1cblxuICAgIGNoZWNrUGFzc3dvcmRJbmFjdGl2ZSgpIHtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzVmlzaWJsZSh0aGlzLnBhc3N3b3JkSW5hY3RpdmUpO1xuICAgIH1cblxuICAgIGNoZWNrVXNlcm5hbWVIaWdobGlnaHRlZCgpIHtcbiAgICAgICAgdGhpcy5hZGZMb2dvLmNsaWNrKCk7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc1Zpc2libGUodGhpcy51c2VybmFtZUhpZ2hsaWdodGVkKTtcbiAgICB9XG5cbiAgICBjaGVja1Bhc3N3b3JkSGlnaGxpZ2h0ZWQoKSB7XG4gICAgICAgIHRoaXMuYWRmTG9nby5jbGljaygpO1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNWaXNpYmxlKHRoaXMucGFzc3dvcmRIaWdobGlnaHRlZCk7XG4gICAgfVxuXG4gICAgY2hlY2tVc2VybmFtZVRvb2x0aXBJc05vdFZpc2libGUoKSB7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc05vdFZpc2libGUodGhpcy51c2VybmFtZVRvb2x0aXApO1xuICAgIH1cblxuICAgIGNoZWNrUGFzc3dvcmRUb29sdGlwSXNOb3RWaXNpYmxlKCkge1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNOb3RWaXNpYmxlKHRoaXMucGFzc3dvcmRUb29sdGlwKTtcbiAgICB9XG5cbiAgICBnZXRTaWduSW5CdXR0b25Jc0VuYWJsZWQoKSB7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc1Zpc2libGUodGhpcy5zaWduSW5CdXR0b24pO1xuICAgICAgICByZXR1cm4gdGhpcy5zaWduSW5CdXR0b24uaXNFbmFibGVkKCk7XG4gICAgfVxuXG4gICAgYXN5bmMgbG9naW5Ub1Byb2Nlc3NTZXJ2aWNlc1VzaW5nVXNlck1vZGVsKHVzZXJNb2RlbCkge1xuICAgICAgICB0aGlzLmdvVG9Mb2dpblBhZ2UoKTtcbiAgICAgICAgYXdhaXQgTG9jYWxTdG9yYWdlVXRpbC5jbGVhclN0b3JhZ2UoKTtcbiAgICAgICAgYXdhaXQgTG9jYWxTdG9yYWdlVXRpbC5zZXRTdG9yYWdlSXRlbSgncHJvdmlkZXJzJywgJ0JQTScpO1xuICAgICAgICBhd2FpdCBMb2NhbFN0b3JhZ2VVdGlsLmFwaVJlc2V0KCk7XG4gICAgICAgIHRoaXMubG9naW4odXNlck1vZGVsLmVtYWlsLCB1c2VyTW9kZWwucGFzc3dvcmQpO1xuICAgIH1cblxuICAgIGFzeW5jIGxvZ2luVG9Db250ZW50U2VydmljZXNVc2luZ1VzZXJNb2RlbCh1c2VyTW9kZWwpIHtcbiAgICAgICAgdGhpcy5nb1RvTG9naW5QYWdlKCk7XG4gICAgICAgIGF3YWl0IExvY2FsU3RvcmFnZVV0aWwuY2xlYXJTdG9yYWdlKCk7XG4gICAgICAgIGF3YWl0IExvY2FsU3RvcmFnZVV0aWwuc2V0U3RvcmFnZUl0ZW0oJ3Byb3ZpZGVycycsICdFQ00nKTtcbiAgICAgICAgYXdhaXQgTG9jYWxTdG9yYWdlVXRpbC5hcGlSZXNldCgpO1xuICAgICAgICB0aGlzLmxvZ2luKHVzZXJNb2RlbC5nZXRJZCgpLCB1c2VyTW9kZWwuZ2V0UGFzc3dvcmQoKSk7XG4gICAgfVxuXG4gICAgYXN5bmMgbG9naW5Ub0NvbnRlbnRTZXJ2aWNlcyh1c2VybmFtZSwgcGFzc3dvcmQpIHtcbiAgICAgICAgdGhpcy5nb1RvTG9naW5QYWdlKCk7XG4gICAgICAgIGF3YWl0IExvY2FsU3RvcmFnZVV0aWwuY2xlYXJTdG9yYWdlKCk7XG4gICAgICAgIGF3YWl0IExvY2FsU3RvcmFnZVV0aWwuc2V0U3RvcmFnZUl0ZW0oJ3Byb3ZpZGVycycsICdFQ00nKTtcbiAgICAgICAgYXdhaXQgTG9jYWxTdG9yYWdlVXRpbC5hcGlSZXNldCgpO1xuICAgICAgICB0aGlzLndhaXRGb3JFbGVtZW50cygpO1xuICAgICAgICB0aGlzLmxvZ2luKHVzZXJuYW1lLCBwYXNzd29yZCk7XG4gICAgfVxuXG4gICAgY2xpY2tTaWduSW5CdXR0b24oKSB7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc1Zpc2libGUodGhpcy5zaWduSW5CdXR0b24pO1xuICAgICAgICB0aGlzLnNpZ25JbkJ1dHRvbi5jbGljaygpO1xuICAgIH1cblxuICAgIGNsaWNrU2V0dGluZ3NJY29uKCkge1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNWaXNpYmxlKHRoaXMuc2V0dGluZ3NJY29uKTtcbiAgICAgICAgdGhpcy5zZXR0aW5nc0ljb24uY2xpY2soKTtcbiAgICB9XG5cbiAgICBzaG93UGFzc3dvcmQoKSB7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc1Zpc2libGUodGhpcy5zaG93UGFzc3dvcmRFbGVtZW50KTtcbiAgICAgICAgdGhpcy5zaG93UGFzc3dvcmRFbGVtZW50LmNsaWNrKCk7XG4gICAgfVxuXG4gICAgaGlkZVBhc3N3b3JkKCkge1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNWaXNpYmxlKHRoaXMuaGlkZVBhc3N3b3JkRWxlbWVudCk7XG4gICAgICAgIHRoaXMuaGlkZVBhc3N3b3JkRWxlbWVudC5jbGljaygpO1xuICAgIH1cblxuICAgIGdldFNob3duUGFzc3dvcmQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnR4dFBhc3N3b3JkLmdldEF0dHJpYnV0ZSgndmFsdWUnKTtcbiAgICB9XG5cbiAgICBjaGVja1Bhc3N3b3JkSXNIaWRkZW4oKSB7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc1Zpc2libGUodGhpcy50eHRQYXNzd29yZCk7XG4gICAgfVxuXG4gICAgY2hlY2tSZW1lbWJlcklzRGlzcGxheWVkKCkge1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNWaXNpYmxlKHRoaXMucmVtZW1iZXJNZSk7XG4gICAgfVxuXG4gICAgY2hlY2tSZW1lbWJlcklzTm90RGlzcGxheWVkKCkge1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNOb3RWaXNpYmxlKHRoaXMucmVtZW1iZXJNZSk7XG4gICAgfVxuXG4gICAgY2hlY2tOZWVkSGVscElzRGlzcGxheWVkKCkge1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNWaXNpYmxlKHRoaXMubmVlZEhlbHApO1xuICAgIH1cblxuICAgIGNoZWNrTmVlZEhlbHBJc05vdERpc3BsYXllZCgpIHtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzTm90VmlzaWJsZSh0aGlzLm5lZWRIZWxwKTtcbiAgICB9XG5cbiAgICBjaGVja1JlZ2lzdGVyRGlzcGxheWVkKCkge1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNWaXNpYmxlKHRoaXMucmVnaXN0ZXIpO1xuICAgIH1cblxuICAgIGNoZWNrUmVnaXN0ZXJJc05vdERpc3BsYXllZCgpIHtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzTm90VmlzaWJsZSh0aGlzLnJlZ2lzdGVyKTtcbiAgICB9XG5cbiAgICBlbmFibGVGb290ZXIoKSB7XG4gICAgICAgIHRoaXMuZm9ybUNvbnRyb2xsZXJzUGFnZS5lbmFibGVUb2dnbGUodGhpcy5mb290ZXJTd2l0Y2gpO1xuICAgIH1cblxuICAgIGRpc2FibGVGb290ZXIoKSB7XG4gICAgICAgIHRoaXMuZm9ybUNvbnRyb2xsZXJzUGFnZS5kaXNhYmxlVG9nZ2xlKHRoaXMuZm9vdGVyU3dpdGNoKTtcbiAgICB9XG5cbiAgICBkaXNhYmxlUmVtZW1iZXJNZSgpIHtcbiAgICAgICAgdGhpcy5mb3JtQ29udHJvbGxlcnNQYWdlLmRpc2FibGVUb2dnbGUodGhpcy5yZW1lbWJlck1lU3dpdGNoKTtcbiAgICB9XG5cbiAgICBlbmFibGVTdWNjZXNzUm91dGVTd2l0Y2goKSB7XG4gICAgICAgIHRoaXMuZm9ybUNvbnRyb2xsZXJzUGFnZS5lbmFibGVUb2dnbGUodGhpcy5zdWNjZXNzUm91dGVTd2l0Y2gpO1xuICAgIH1cblxuICAgIGVuYWJsZUxvZ29Td2l0Y2goKSB7XG4gICAgICAgIHRoaXMuZm9ybUNvbnRyb2xsZXJzUGFnZS5lbmFibGVUb2dnbGUodGhpcy5sb2dvU3dpdGNoKTtcbiAgICB9XG5cbiAgICBlbnRlclN1Y2Nlc3NSb3V0ZShyb3V0ZSkge1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNWaXNpYmxlKHRoaXMuc3VjY2Vzc1JvdXRlVHh0KTtcbiAgICAgICAgdGhpcy5zdWNjZXNzUm91dGVUeHQuc2VuZEtleXMoJycpO1xuICAgICAgICB0aGlzLnN1Y2Nlc3NSb3V0ZVR4dC5jbGVhcigpO1xuICAgICAgICByZXR1cm4gdGhpcy5zdWNjZXNzUm91dGVUeHQuc2VuZEtleXMocm91dGUpO1xuICAgIH1cblxuICAgIGVudGVyTG9nbyhsb2dvKSB7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc1Zpc2libGUodGhpcy5sb2dvVHh0KTtcbiAgICAgICAgdGhpcy5sb2dvVHh0LnNlbmRLZXlzKCcnKTtcbiAgICAgICAgdGhpcy5sb2dvVHh0LmNsZWFyKCk7XG4gICAgICAgIHJldHVybiB0aGlzLmxvZ29UeHQuc2VuZEtleXMobG9nbyk7XG4gICAgfVxuXG4gICAgbG9naW4odXNlcm5hbWUsIHBhc3N3b3JkKSB7XG4gICAgICAgIHRoaXMud2FpdEZvckVsZW1lbnRzKCk7XG4gICAgICAgIHRoaXMuZW50ZXJVc2VybmFtZSh1c2VybmFtZSk7XG4gICAgICAgIHRoaXMuZW50ZXJQYXNzd29yZChwYXNzd29yZCk7XG4gICAgICAgIHRoaXMuY2xpY2tTaWduSW5CdXR0b24oKTtcbiAgICAgICAgcmV0dXJuIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc1Zpc2libGUodGhpcy5oZWFkZXIpO1xuICAgIH1cbn1cbiJdfQ==