/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
/*!
 * @license
 * Copyright 2019 Alfresco Software, Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
import { by, element, protractor } from 'protractor';
import { EditProcessFilterDialogPage } from './dialog/edit-process-filter-dialog.page';
import { BrowserVisibility } from '../../core/utils/browser-visibility';
export class EditProcessFilterCloudComponentPage {
    constructor() {
        this.customiseFilter = element(by.id('adf-edit-process-filter-title-id'));
        this.selectedOption = element.all(by.css('mat-option[class*="mat-selected"]')).first();
        this.saveButton = element(by.css('button[data-automation-id="adf-filter-action-save"]'));
        this.saveAsButton = element(by.css('button[data-automation-id="adf-filter-action-saveAs"]'));
        this.deleteButton = element(by.css('button[data-automation-id="adf-filter-action-delete"]'));
        this.editProcessFilterDialogPage = new EditProcessFilterDialogPage();
    }
    /**
     * @return {?}
     */
    editProcessFilterDialog() {
        return this.editProcessFilterDialogPage;
    }
    /**
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    clickCustomiseFilterHeader() {
        BrowserVisibility.waitUntilElementIsVisible((/** @type {?} */ (this)).customiseFilter);
        (/** @type {?} */ (this)).customiseFilter.click();
        return (/** @type {?} */ (this));
    }
    /**
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    checkCustomiseFilterHeaderIsExpanded() {
        /** @type {?} */
        const expansionPanelExtended = element.all(by.css('mat-expansion-panel-header[class*="mat-expanded"]')).first();
        BrowserVisibility.waitUntilElementIsVisible(expansionPanelExtended);
        /** @type {?} */
        const content = element.all(by.css('div[class*="mat-expansion-panel-content "][style*="visible"]')).first();
        BrowserVisibility.waitUntilElementIsVisible(content);
        return (/** @type {?} */ (this));
    }
    /**
     * @template THIS
     * @this {THIS}
     * @param {?} option
     * @return {THIS}
     */
    setStatusFilterDropDown(option) {
        (/** @type {?} */ (this)).clickOnDropDownArrow('status');
        /** @type {?} */
        const statusElement = element.all(by.cssContainingText('mat-option span', option)).first();
        BrowserVisibility.waitUntilElementIsClickable(statusElement);
        BrowserVisibility.waitUntilElementIsVisible(statusElement);
        statusElement.click();
        return (/** @type {?} */ (this));
    }
    /**
     * @return {?}
     */
    getStateFilterDropDownValue() {
        return element(by.css("mat-form-field[data-automation-id='status'] span")).getText();
    }
    /**
     * @template THIS
     * @this {THIS}
     * @param {?} option
     * @return {THIS}
     */
    setSortFilterDropDown(option) {
        (/** @type {?} */ (this)).clickOnDropDownArrow('sort');
        /** @type {?} */
        const sortElement = element.all(by.cssContainingText('mat-option span', option)).first();
        BrowserVisibility.waitUntilElementIsClickable(sortElement);
        BrowserVisibility.waitUntilElementIsVisible(sortElement);
        sortElement.click();
        return (/** @type {?} */ (this));
    }
    /**
     * @return {?}
     */
    getSortFilterDropDownValue() {
        /** @type {?} */
        const sortLocator = element.all(by.css("mat-form-field[data-automation-id='sort'] span")).first();
        BrowserVisibility.waitUntilElementIsVisible(sortLocator);
        return sortLocator.getText();
    }
    /**
     * @template THIS
     * @this {THIS}
     * @param {?} option
     * @return {THIS}
     */
    setOrderFilterDropDown(option) {
        (/** @type {?} */ (this)).clickOnDropDownArrow('order');
        /** @type {?} */
        const orderElement = element.all(by.cssContainingText('mat-option span', option)).first();
        BrowserVisibility.waitUntilElementIsClickable(orderElement);
        BrowserVisibility.waitUntilElementIsVisible(orderElement);
        orderElement.click();
        return (/** @type {?} */ (this));
    }
    /**
     * @return {?}
     */
    getOrderFilterDropDownValue() {
        return element(by.css("mat-form-field[data-automation-id='order'] span")).getText();
    }
    /**
     * @param {?} option
     * @return {?}
     */
    clickOnDropDownArrow(option) {
        /** @type {?} */
        const dropDownArrow = element.all(by.css("mat-form-field[data-automation-id='" + option + "'] div[class='mat-select-arrow-wrapper']")).first();
        BrowserVisibility.waitUntilElementIsVisible(dropDownArrow);
        BrowserVisibility.waitUntilElementIsClickable(dropDownArrow);
        dropDownArrow.click();
        BrowserVisibility.waitUntilElementIsVisible(this.selectedOption);
    }
    /**
     * @template THIS
     * @this {THIS}
     * @param {?} option
     * @return {THIS}
     */
    setAppNameDropDown(option) {
        (/** @type {?} */ (this)).clickOnDropDownArrow('appName');
        /** @type {?} */
        const appNameElement = element.all(by.cssContainingText('mat-option span', option)).first();
        BrowserVisibility.waitUntilElementIsClickable(appNameElement);
        BrowserVisibility.waitUntilElementIsVisible(appNameElement);
        appNameElement.click();
        return (/** @type {?} */ (this));
    }
    /**
     * @return {?}
     */
    checkAppNamesAreUnique() {
        return tslib_1.__awaiter(this, void 0, void 0, function* () {
            /** @type {?} */
            const appNameList = element.all(by.css('mat-option[data-automation-id="adf-cloud-edit-process-property-optionsappName"] span'));
            /** @type {?} */
            const appTextList = yield appNameList.getText();
            /** @type {?} */
            const uniqueArray = appTextList.filter((/**
             * @param {?} appName
             * @return {?}
             */
            (appName) => {
                /** @type {?} */
                const sameAppNameArray = appTextList.filter((/**
                 * @param {?} eachApp
                 * @return {?}
                 */
                (eachApp) => eachApp === appName));
                return sameAppNameArray.length === 1;
            }));
            return uniqueArray.length === appTextList.length;
        });
    }
    /**
     * @return {?}
     */
    getNumberOfAppNameOptions() {
        this.clickOnDropDownArrow('appName');
        /** @type {?} */
        const dropdownOptions = element.all(by.css('.mat-select-panel mat-option'));
        return dropdownOptions.count();
    }
    /**
     * @template THIS
     * @this {THIS}
     * @param {?} option
     * @return {THIS}
     */
    setProcessInstanceId(option) {
        return (/** @type {?} */ (this)).setProperty('processInstanceId', option);
    }
    /**
     * @return {?}
     */
    getProcessInstanceId() {
        return this.getProperty('processInstanceId');
    }
    /**
     * @param {?} property
     * @return {?}
     */
    getProperty(property) {
        /** @type {?} */
        const locator = element.all(by.css('input[data-automation-id="adf-cloud-edit-process-property-' + property + '"]')).first();
        BrowserVisibility.waitUntilElementIsVisible(locator);
        return locator.getAttribute('value');
    }
    /**
     * @template THIS
     * @this {THIS}
     * @param {?} property
     * @param {?} option
     * @return {THIS}
     */
    setProperty(property, option) {
        /** @type {?} */
        const locator = element.all(by.css('input[data-automation-id="adf-cloud-edit-process-property-' + property + '"]')).first();
        BrowserVisibility.waitUntilElementIsVisible(locator);
        locator.clear();
        locator.sendKeys(option);
        locator.sendKeys(protractor.Key.ENTER);
        return (/** @type {?} */ (this));
    }
    /**
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    checkSaveButtonIsDisplayed() {
        BrowserVisibility.waitUntilElementIsVisible((/** @type {?} */ (this)).saveButton);
        return (/** @type {?} */ (this));
    }
    /**
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    checkSaveAsButtonIsDisplayed() {
        BrowserVisibility.waitUntilElementIsVisible((/** @type {?} */ (this)).saveAsButton);
        return (/** @type {?} */ (this));
    }
    /**
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    checkDeleteButtonIsDisplayed() {
        BrowserVisibility.waitUntilElementIsVisible((/** @type {?} */ (this)).deleteButton);
        return (/** @type {?} */ (this));
    }
    /**
     * @return {?}
     */
    checkSaveButtonIsEnabled() {
        BrowserVisibility.waitUntilElementIsVisible(this.saveButton);
        return this.saveButton.isEnabled();
    }
    /**
     * @return {?}
     */
    checkSaveAsButtonIsEnabled() {
        BrowserVisibility.waitUntilElementIsVisible(this.saveAsButton);
        return this.saveAsButton.isEnabled();
    }
    /**
     * @return {?}
     */
    checkDeleteButtonIsEnabled() {
        BrowserVisibility.waitUntilElementIsVisible(this.deleteButton);
        return this.deleteButton.isEnabled();
    }
    /**
     * @return {?}
     */
    clickSaveAsButton() {
        /** @type {?} */
        const disabledButton = element(by.css(("button[data-automation-id='adf-filter-action-saveAs'][disabled]")));
        BrowserVisibility.waitUntilElementIsClickable(this.saveAsButton);
        BrowserVisibility.waitUntilElementIsVisible(this.saveAsButton);
        BrowserVisibility.waitUntilElementIsNotVisible(disabledButton);
        this.saveAsButton.click();
        return this.editProcessFilterDialogPage;
    }
    /**
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    clickDeleteButton() {
        BrowserVisibility.waitUntilElementIsVisible((/** @type {?} */ (this)).deleteButton);
        (/** @type {?} */ (this)).deleteButton.click();
        return (/** @type {?} */ (this));
    }
    /**
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    clickSaveButton() {
        /** @type {?} */
        const disabledButton = element(by.css(("button[id='adf-save-as-id'][disabled]")));
        BrowserVisibility.waitUntilElementIsClickable((/** @type {?} */ (this)).saveButton);
        BrowserVisibility.waitUntilElementIsVisible((/** @type {?} */ (this)).saveButton);
        BrowserVisibility.waitUntilElementIsNotVisible(disabledButton);
        (/** @type {?} */ (this)).saveButton.click();
        return (/** @type {?} */ (this));
    }
}
if (false) {
    /** @type {?} */
    EditProcessFilterCloudComponentPage.prototype.customiseFilter;
    /** @type {?} */
    EditProcessFilterCloudComponentPage.prototype.selectedOption;
    /** @type {?} */
    EditProcessFilterCloudComponentPage.prototype.saveButton;
    /** @type {?} */
    EditProcessFilterCloudComponentPage.prototype.saveAsButton;
    /** @type {?} */
    EditProcessFilterCloudComponentPage.prototype.deleteButton;
    /** @type {?} */
    EditProcessFilterCloudComponentPage.prototype.editProcessFilterDialogPage;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZWRpdC1wcm9jZXNzLWZpbHRlci1jbG91ZC1jb21wb25lbnQucGFnZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BhbGZyZXNjby9hZGYtdGVzdGluZy8iLCJzb3VyY2VzIjpbImxpYi9wcm9jZXNzLXNlcnZpY2VzLWNsb3VkL3BhZ2VzL2VkaXQtcHJvY2Vzcy1maWx0ZXItY2xvdWQtY29tcG9uZW50LnBhZ2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBZ0JBLE9BQU8sRUFBRSxFQUFFLEVBQUUsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLFlBQVksQ0FBQztBQUNyRCxPQUFPLEVBQUUsMkJBQTJCLEVBQUUsTUFBTSwwQ0FBMEMsQ0FBQztBQUN2RixPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxxQ0FBcUMsQ0FBQztBQUV4RSxNQUFNLE9BQU8sbUNBQW1DO0lBQWhEO1FBRUksb0JBQWUsR0FBRyxPQUFPLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxrQ0FBa0MsQ0FBQyxDQUFDLENBQUM7UUFDckUsbUJBQWMsR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsbUNBQW1DLENBQUMsQ0FBQyxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ2xGLGVBQVUsR0FBRyxPQUFPLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxxREFBcUQsQ0FBQyxDQUFDLENBQUM7UUFDcEYsaUJBQVksR0FBRyxPQUFPLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyx1REFBdUQsQ0FBQyxDQUFDLENBQUM7UUFDeEYsaUJBQVksR0FBRyxPQUFPLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyx1REFBdUQsQ0FBQyxDQUFDLENBQUM7UUFFeEYsZ0NBQTJCLEdBQUcsSUFBSSwyQkFBMkIsRUFBRSxDQUFDO0lBOEtwRSxDQUFDOzs7O0lBNUtHLHVCQUF1QjtRQUNuQixPQUFPLElBQUksQ0FBQywyQkFBMkIsQ0FBQztJQUM1QyxD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Q0FBQyxVQUFVLENBQUMsQ0FBQztRQUMvRCxpQkFBaUIsQ0FBQyx5QkFBeUIsQ0FBQyxtQkFBQSxJQUFJLEVBQUEsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUM3RCxpQkFBaUIsQ0FBQyw0QkFBNEIsQ0FBQyxjQUFjLENBQUMsQ0FBQztRQUMvRCxtQkFBQSxJQUFJLEVBQUEsQ0FBQyxVQUFVLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDeEIsT0FBTyxtQkFBQSxJQUFJLEVBQUEsQ0FBQztJQUNoQixDQUFDO0NBQ0o7OztJQXBMRyw4REFBcUU7O0lBQ3JFLDZEQUFrRjs7SUFDbEYseURBQW9GOztJQUNwRiwyREFBd0Y7O0lBQ3hGLDJEQUF3Rjs7SUFFeEYsMEVBQWdFIiwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgQWxmcmVzY28gU29mdHdhcmUsIEx0ZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmltcG9ydCB7IGJ5LCBlbGVtZW50LCBwcm90cmFjdG9yIH0gZnJvbSAncHJvdHJhY3Rvcic7XG5pbXBvcnQgeyBFZGl0UHJvY2Vzc0ZpbHRlckRpYWxvZ1BhZ2UgfSBmcm9tICcuL2RpYWxvZy9lZGl0LXByb2Nlc3MtZmlsdGVyLWRpYWxvZy5wYWdlJztcbmltcG9ydCB7IEJyb3dzZXJWaXNpYmlsaXR5IH0gZnJvbSAnLi4vLi4vY29yZS91dGlscy9icm93c2VyLXZpc2liaWxpdHknO1xuXG5leHBvcnQgY2xhc3MgRWRpdFByb2Nlc3NGaWx0ZXJDbG91ZENvbXBvbmVudFBhZ2Uge1xuXG4gICAgY3VzdG9taXNlRmlsdGVyID0gZWxlbWVudChieS5pZCgnYWRmLWVkaXQtcHJvY2Vzcy1maWx0ZXItdGl0bGUtaWQnKSk7XG4gICAgc2VsZWN0ZWRPcHRpb24gPSBlbGVtZW50LmFsbChieS5jc3MoJ21hdC1vcHRpb25bY2xhc3MqPVwibWF0LXNlbGVjdGVkXCJdJykpLmZpcnN0KCk7XG4gICAgc2F2ZUJ1dHRvbiA9IGVsZW1lbnQoYnkuY3NzKCdidXR0b25bZGF0YS1hdXRvbWF0aW9uLWlkPVwiYWRmLWZpbHRlci1hY3Rpb24tc2F2ZVwiXScpKTtcbiAgICBzYXZlQXNCdXR0b24gPSBlbGVtZW50KGJ5LmNzcygnYnV0dG9uW2RhdGEtYXV0b21hdGlvbi1pZD1cImFkZi1maWx0ZXItYWN0aW9uLXNhdmVBc1wiXScpKTtcbiAgICBkZWxldGVCdXR0b24gPSBlbGVtZW50KGJ5LmNzcygnYnV0dG9uW2RhdGEtYXV0b21hdGlvbi1pZD1cImFkZi1maWx0ZXItYWN0aW9uLWRlbGV0ZVwiXScpKTtcblxuICAgIGVkaXRQcm9jZXNzRmlsdGVyRGlhbG9nUGFnZSA9IG5ldyBFZGl0UHJvY2Vzc0ZpbHRlckRpYWxvZ1BhZ2UoKTtcblxuICAgIGVkaXRQcm9jZXNzRmlsdGVyRGlhbG9nKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5lZGl0UHJvY2Vzc0ZpbHRlckRpYWxvZ1BhZ2U7XG4gICAgfVxuXG4gICAgY2xpY2tDdXN0b21pc2VGaWx0ZXJIZWFkZXIoKSB7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc1Zpc2libGUodGhpcy5jdXN0b21pc2VGaWx0ZXIpO1xuICAgICAgICB0aGlzLmN1c3RvbWlzZUZpbHRlci5jbGljaygpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICBjaGVja0N1c3RvbWlzZUZpbHRlckhlYWRlcklzRXhwYW5kZWQoKSB7XG4gICAgICAgIGNvbnN0IGV4cGFuc2lvblBhbmVsRXh0ZW5kZWQgPSBlbGVtZW50LmFsbChieS5jc3MoJ21hdC1leHBhbnNpb24tcGFuZWwtaGVhZGVyW2NsYXNzKj1cIm1hdC1leHBhbmRlZFwiXScpKS5maXJzdCgpO1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNWaXNpYmxlKGV4cGFuc2lvblBhbmVsRXh0ZW5kZWQpO1xuICAgICAgICBjb25zdCBjb250ZW50ID0gZWxlbWVudC5hbGwoYnkuY3NzKCdkaXZbY2xhc3MqPVwibWF0LWV4cGFuc2lvbi1wYW5lbC1jb250ZW50IFwiXVtzdHlsZSo9XCJ2aXNpYmxlXCJdJykpLmZpcnN0KCk7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc1Zpc2libGUoY29udGVudCk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIHNldFN0YXR1c0ZpbHRlckRyb3BEb3duKG9wdGlvbikge1xuICAgICAgICB0aGlzLmNsaWNrT25Ecm9wRG93bkFycm93KCdzdGF0dXMnKTtcblxuICAgICAgICBjb25zdCBzdGF0dXNFbGVtZW50ID0gZWxlbWVudC5hbGwoYnkuY3NzQ29udGFpbmluZ1RleHQoJ21hdC1vcHRpb24gc3BhbicsIG9wdGlvbikpLmZpcnN0KCk7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc0NsaWNrYWJsZShzdGF0dXNFbGVtZW50KTtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzVmlzaWJsZShzdGF0dXNFbGVtZW50KTtcbiAgICAgICAgc3RhdHVzRWxlbWVudC5jbGljaygpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICBnZXRTdGF0ZUZpbHRlckRyb3BEb3duVmFsdWUoKSB7XG4gICAgICAgIHJldHVybiBlbGVtZW50KGJ5LmNzcyhcIm1hdC1mb3JtLWZpZWxkW2RhdGEtYXV0b21hdGlvbi1pZD0nc3RhdHVzJ10gc3BhblwiKSkuZ2V0VGV4dCgpO1xuICAgIH1cblxuICAgIHNldFNvcnRGaWx0ZXJEcm9wRG93bihvcHRpb24pIHtcbiAgICAgICAgdGhpcy5jbGlja09uRHJvcERvd25BcnJvdygnc29ydCcpO1xuXG4gICAgICAgIGNvbnN0IHNvcnRFbGVtZW50ID0gZWxlbWVudC5hbGwoYnkuY3NzQ29udGFpbmluZ1RleHQoJ21hdC1vcHRpb24gc3BhbicsIG9wdGlvbikpLmZpcnN0KCk7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc0NsaWNrYWJsZShzb3J0RWxlbWVudCk7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc1Zpc2libGUoc29ydEVsZW1lbnQpO1xuICAgICAgICBzb3J0RWxlbWVudC5jbGljaygpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICBnZXRTb3J0RmlsdGVyRHJvcERvd25WYWx1ZSgpIHtcbiAgICAgICAgY29uc3Qgc29ydExvY2F0b3IgPSBlbGVtZW50LmFsbChieS5jc3MoXCJtYXQtZm9ybS1maWVsZFtkYXRhLWF1dG9tYXRpb24taWQ9J3NvcnQnXSBzcGFuXCIpKS5maXJzdCgpO1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNWaXNpYmxlKHNvcnRMb2NhdG9yKTtcbiAgICAgICAgcmV0dXJuIHNvcnRMb2NhdG9yLmdldFRleHQoKTtcbiAgICB9XG5cbiAgICBzZXRPcmRlckZpbHRlckRyb3BEb3duKG9wdGlvbikge1xuICAgICAgICB0aGlzLmNsaWNrT25Ecm9wRG93bkFycm93KCdvcmRlcicpO1xuXG4gICAgICAgIGNvbnN0IG9yZGVyRWxlbWVudCA9IGVsZW1lbnQuYWxsKGJ5LmNzc0NvbnRhaW5pbmdUZXh0KCdtYXQtb3B0aW9uIHNwYW4nLCBvcHRpb24pKS5maXJzdCgpO1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNDbGlja2FibGUob3JkZXJFbGVtZW50KTtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzVmlzaWJsZShvcmRlckVsZW1lbnQpO1xuICAgICAgICBvcmRlckVsZW1lbnQuY2xpY2soKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgZ2V0T3JkZXJGaWx0ZXJEcm9wRG93blZhbHVlKCkge1xuICAgICAgICByZXR1cm4gZWxlbWVudChieS5jc3MoXCJtYXQtZm9ybS1maWVsZFtkYXRhLWF1dG9tYXRpb24taWQ9J29yZGVyJ10gc3BhblwiKSkuZ2V0VGV4dCgpO1xuICAgIH1cblxuICAgIGNsaWNrT25Ecm9wRG93bkFycm93KG9wdGlvbikge1xuICAgICAgICBjb25zdCBkcm9wRG93bkFycm93ID0gZWxlbWVudC5hbGwoYnkuY3NzKFwibWF0LWZvcm0tZmllbGRbZGF0YS1hdXRvbWF0aW9uLWlkPSdcIiArIG9wdGlvbiArIFwiJ10gZGl2W2NsYXNzPSdtYXQtc2VsZWN0LWFycm93LXdyYXBwZXInXVwiKSkuZmlyc3QoKTtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzVmlzaWJsZShkcm9wRG93bkFycm93KTtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzQ2xpY2thYmxlKGRyb3BEb3duQXJyb3cpO1xuICAgICAgICBkcm9wRG93bkFycm93LmNsaWNrKCk7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc1Zpc2libGUodGhpcy5zZWxlY3RlZE9wdGlvbik7XG4gICAgfVxuXG4gICAgc2V0QXBwTmFtZURyb3BEb3duKG9wdGlvbikge1xuICAgICAgICB0aGlzLmNsaWNrT25Ecm9wRG93bkFycm93KCdhcHBOYW1lJyk7XG5cbiAgICAgICAgY29uc3QgYXBwTmFtZUVsZW1lbnQgPSBlbGVtZW50LmFsbChieS5jc3NDb250YWluaW5nVGV4dCgnbWF0LW9wdGlvbiBzcGFuJywgb3B0aW9uKSkuZmlyc3QoKTtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzQ2xpY2thYmxlKGFwcE5hbWVFbGVtZW50KTtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzVmlzaWJsZShhcHBOYW1lRWxlbWVudCk7XG4gICAgICAgIGFwcE5hbWVFbGVtZW50LmNsaWNrKCk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIGFzeW5jIGNoZWNrQXBwTmFtZXNBcmVVbmlxdWUoKSB7XG4gICAgICAgIGNvbnN0IGFwcE5hbWVMaXN0ID0gZWxlbWVudC5hbGwoYnkuY3NzKCdtYXQtb3B0aW9uW2RhdGEtYXV0b21hdGlvbi1pZD1cImFkZi1jbG91ZC1lZGl0LXByb2Nlc3MtcHJvcGVydHktb3B0aW9uc2FwcE5hbWVcIl0gc3BhbicpKTtcbiAgICAgICAgY29uc3QgYXBwVGV4dExpc3Q6IGFueSA9IGF3YWl0IGFwcE5hbWVMaXN0LmdldFRleHQoKTtcbiAgICAgICAgY29uc3QgdW5pcXVlQXJyYXkgPSBhcHBUZXh0TGlzdC5maWx0ZXIoKGFwcE5hbWUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHNhbWVBcHBOYW1lQXJyYXkgPSBhcHBUZXh0TGlzdC5maWx0ZXIoKGVhY2hBcHApID0+IGVhY2hBcHAgPT09IGFwcE5hbWUpO1xuICAgICAgICAgICAgcmV0dXJuIHNhbWVBcHBOYW1lQXJyYXkubGVuZ3RoID09PSAxO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHVuaXF1ZUFycmF5Lmxlbmd0aCA9PT0gYXBwVGV4dExpc3QubGVuZ3RoO1xuICAgIH1cblxuICAgIGdldE51bWJlck9mQXBwTmFtZU9wdGlvbnMoKSB7XG4gICAgICAgIHRoaXMuY2xpY2tPbkRyb3BEb3duQXJyb3coJ2FwcE5hbWUnKTtcbiAgICAgICAgY29uc3QgZHJvcGRvd25PcHRpb25zID0gZWxlbWVudC5hbGwoYnkuY3NzKCcubWF0LXNlbGVjdC1wYW5lbCBtYXQtb3B0aW9uJykpO1xuICAgICAgICByZXR1cm4gZHJvcGRvd25PcHRpb25zLmNvdW50KCk7XG4gICAgfVxuXG4gICAgc2V0UHJvY2Vzc0luc3RhbmNlSWQob3B0aW9uKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNldFByb3BlcnR5KCdwcm9jZXNzSW5zdGFuY2VJZCcsIG9wdGlvbik7XG4gICAgfVxuXG4gICAgZ2V0UHJvY2Vzc0luc3RhbmNlSWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFByb3BlcnR5KCdwcm9jZXNzSW5zdGFuY2VJZCcpO1xuICAgIH1cblxuICAgIGdldFByb3BlcnR5KHByb3BlcnR5KSB7XG4gICAgICAgIGNvbnN0IGxvY2F0b3IgPSBlbGVtZW50LmFsbChieS5jc3MoJ2lucHV0W2RhdGEtYXV0b21hdGlvbi1pZD1cImFkZi1jbG91ZC1lZGl0LXByb2Nlc3MtcHJvcGVydHktJyArIHByb3BlcnR5ICsgJ1wiXScpKS5maXJzdCgpO1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNWaXNpYmxlKGxvY2F0b3IpO1xuICAgICAgICByZXR1cm4gbG9jYXRvci5nZXRBdHRyaWJ1dGUoJ3ZhbHVlJyk7XG4gICAgfVxuXG4gICAgc2V0UHJvcGVydHkocHJvcGVydHksIG9wdGlvbikge1xuICAgICAgICBjb25zdCBsb2NhdG9yID0gZWxlbWVudC5hbGwoYnkuY3NzKCdpbnB1dFtkYXRhLWF1dG9tYXRpb24taWQ9XCJhZGYtY2xvdWQtZWRpdC1wcm9jZXNzLXByb3BlcnR5LScgKyBwcm9wZXJ0eSArICdcIl0nKSkuZmlyc3QoKTtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzVmlzaWJsZShsb2NhdG9yKTtcbiAgICAgICAgbG9jYXRvci5jbGVhcigpO1xuICAgICAgICBsb2NhdG9yLnNlbmRLZXlzKG9wdGlvbik7XG4gICAgICAgIGxvY2F0b3Iuc2VuZEtleXMocHJvdHJhY3Rvci5LZXkuRU5URVIpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICBjaGVja1NhdmVCdXR0b25Jc0Rpc3BsYXllZCgpIHtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzVmlzaWJsZSh0aGlzLnNhdmVCdXR0b24pO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICBjaGVja1NhdmVBc0J1dHRvbklzRGlzcGxheWVkKCkge1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNWaXNpYmxlKHRoaXMuc2F2ZUFzQnV0dG9uKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgY2hlY2tEZWxldGVCdXR0b25Jc0Rpc3BsYXllZCgpIHtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzVmlzaWJsZSh0aGlzLmRlbGV0ZUJ1dHRvbik7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIGNoZWNrU2F2ZUJ1dHRvbklzRW5hYmxlZCgpIHtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzVmlzaWJsZSh0aGlzLnNhdmVCdXR0b24pO1xuICAgICAgICByZXR1cm4gdGhpcy5zYXZlQnV0dG9uLmlzRW5hYmxlZCgpO1xuICAgIH1cblxuICAgIGNoZWNrU2F2ZUFzQnV0dG9uSXNFbmFibGVkKCkge1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNWaXNpYmxlKHRoaXMuc2F2ZUFzQnV0dG9uKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2F2ZUFzQnV0dG9uLmlzRW5hYmxlZCgpO1xuICAgIH1cblxuICAgIGNoZWNrRGVsZXRlQnV0dG9uSXNFbmFibGVkKCkge1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNWaXNpYmxlKHRoaXMuZGVsZXRlQnV0dG9uKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGVsZXRlQnV0dG9uLmlzRW5hYmxlZCgpO1xuICAgIH1cblxuICAgIGNsaWNrU2F2ZUFzQnV0dG9uKCkge1xuICAgICAgICBjb25zdCBkaXNhYmxlZEJ1dHRvbiA9IGVsZW1lbnQoYnkuY3NzKChcImJ1dHRvbltkYXRhLWF1dG9tYXRpb24taWQ9J2FkZi1maWx0ZXItYWN0aW9uLXNhdmVBcyddW2Rpc2FibGVkXVwiKSkpO1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNDbGlja2FibGUodGhpcy5zYXZlQXNCdXR0b24pO1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNWaXNpYmxlKHRoaXMuc2F2ZUFzQnV0dG9uKTtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzTm90VmlzaWJsZShkaXNhYmxlZEJ1dHRvbik7XG4gICAgICAgIHRoaXMuc2F2ZUFzQnV0dG9uLmNsaWNrKCk7XG4gICAgICAgIHJldHVybiB0aGlzLmVkaXRQcm9jZXNzRmlsdGVyRGlhbG9nUGFnZTtcbiAgICB9XG5cbiAgICBjbGlja0RlbGV0ZUJ1dHRvbigpIHtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzVmlzaWJsZSh0aGlzLmRlbGV0ZUJ1dHRvbik7XG4gICAgICAgIHRoaXMuZGVsZXRlQnV0dG9uLmNsaWNrKCk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIGNsaWNrU2F2ZUJ1dHRvbigpIHtcbiAgICAgICAgY29uc3QgZGlzYWJsZWRCdXR0b24gPSBlbGVtZW50KGJ5LmNzcygoXCJidXR0b25baWQ9J2FkZi1zYXZlLWFzLWlkJ11bZGlzYWJsZWRdXCIpKSk7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc0NsaWNrYWJsZSh0aGlzLnNhdmVCdXR0b24pO1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNWaXNpYmxlKHRoaXMuc2F2ZUJ1dHRvbik7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc05vdFZpc2libGUoZGlzYWJsZWRCdXR0b24pO1xuICAgICAgICB0aGlzLnNhdmVCdXR0b24uY2xpY2soKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxufVxuIl19