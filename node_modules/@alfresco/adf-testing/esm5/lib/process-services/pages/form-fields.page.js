/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/*!
 * @license
 * Copyright 2019 Alfresco Software, Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
import { BrowserVisibility } from '../../core/utils/browser-visibility';
import { by, element } from 'protractor';
var FormFieldsPage = /** @class */ (function () {
    function FormFieldsPage() {
        this.formContent = element(by.css('adf-form'));
        this.refreshButton = element(by.css('div[class*="form-reload-button"] mat-icon'));
        this.saveButton = element(by.cssContainingText('mat-card-actions[class*="adf-for"] span', 'SAVE'));
        this.valueLocator = by.css('input');
        this.labelLocator = by.css('label');
        this.noFormMessage = element(by.css('span[id*="no-form-message"]'));
        this.completedTaskNoFormMessage = element(by.css('div[id*="completed-form-message"] p'));
        this.attachFormButton = element(by.id('adf-no-form-attach-form-button'));
        this.selectFormDropDownArrow = element.all(by.css('adf-attach-form div[class*="mat-select-arrow"]')).first();
        this.selectFormContent = element(by.css('div[class*="mat-select-panel"]'));
        this.completeButton = element(by.id('adf-form-complete'));
        this.errorMessage = by.css('.adf-error-text-container .adf-error-text');
    }
    /**
     * @template THIS
     * @this {THIS}
     * @param {?} locator
     * @param {?} field
     * @param {?} value
     * @return {THIS}
     */
    FormFieldsPage.prototype.setFieldValue = /**
     * @template THIS
     * @this {THIS}
     * @param {?} locator
     * @param {?} field
     * @param {?} value
     * @return {THIS}
     */
    function (locator, field, value) {
        /** @type {?} */
        var fieldElement = element(locator(field));
        BrowserVisibility.waitUntilElementIsVisible(fieldElement);
        fieldElement.clear().sendKeys(value);
        return (/** @type {?} */ (this));
    };
    /**
     * @param {?} fieldId
     * @return {?}
     */
    FormFieldsPage.prototype.checkWidgetIsVisible = /**
     * @param {?} fieldId
     * @return {?}
     */
    function (fieldId) {
        /** @type {?} */
        var fieldElement = element.all(by.css("adf-form-field div[id='field-" + fieldId + "-container']")).first();
        BrowserVisibility.waitUntilElementIsVisible(fieldElement);
    };
    /**
     * @param {?} fieldId
     * @return {?}
     */
    FormFieldsPage.prototype.checkWidgetIsHidden = /**
     * @param {?} fieldId
     * @return {?}
     */
    function (fieldId) {
        /** @type {?} */
        var hiddenElement = element(by.css("adf-form-field div[id='field-" + fieldId + "-container'][hidden]"));
        BrowserVisibility.waitUntilElementIsVisible(hiddenElement);
    };
    /**
     * @param {?} fieldId
     * @return {?}
     */
    FormFieldsPage.prototype.getWidget = /**
     * @param {?} fieldId
     * @return {?}
     */
    function (fieldId) {
        /** @type {?} */
        var widget = element(by.css("adf-form-field div[id='field-" + fieldId + "-container']"));
        BrowserVisibility.waitUntilElementIsVisible(widget);
        return widget;
    };
    /**
     * @param {?} fieldId
     * @param {?} valueLocatorParam
     * @return {?}
     */
    FormFieldsPage.prototype.getFieldValue = /**
     * @param {?} fieldId
     * @param {?} valueLocatorParam
     * @return {?}
     */
    function (fieldId, valueLocatorParam) {
        /** @type {?} */
        var value = this.getWidget(fieldId).element(valueLocatorParam || this.valueLocator);
        BrowserVisibility.waitUntilElementIsVisible(value);
        return value.getAttribute('value');
    };
    /**
     * @param {?} fieldId
     * @param {?} labelLocatorParam
     * @return {?}
     */
    FormFieldsPage.prototype.getFieldLabel = /**
     * @param {?} fieldId
     * @param {?} labelLocatorParam
     * @return {?}
     */
    function (fieldId, labelLocatorParam) {
        /** @type {?} */
        var label = this.getWidget(fieldId).all(labelLocatorParam || this.labelLocator).first();
        BrowserVisibility.waitUntilElementIsVisible(label);
        return label.getText();
    };
    /**
     * @param {?} fieldId
     * @return {?}
     */
    FormFieldsPage.prototype.getFieldErrorMessage = /**
     * @param {?} fieldId
     * @return {?}
     */
    function (fieldId) {
        /** @type {?} */
        var error = this.getWidget(fieldId).element(this.errorMessage);
        return error.getText();
    };
    /**
     * @param {?} fieldId
     * @param {?} labelLocatorParam
     * @return {?}
     */
    FormFieldsPage.prototype.getFieldText = /**
     * @param {?} fieldId
     * @param {?} labelLocatorParam
     * @return {?}
     */
    function (fieldId, labelLocatorParam) {
        /** @type {?} */
        var label = this.getWidget(fieldId).element(labelLocatorParam || this.labelLocator);
        BrowserVisibility.waitUntilElementIsVisible(label);
        return label.getText();
    };
    /**
     * @param {?} fieldId
     * @param {?=} locator
     * @return {?}
     */
    FormFieldsPage.prototype.getFieldPlaceHolder = /**
     * @param {?} fieldId
     * @param {?=} locator
     * @return {?}
     */
    function (fieldId, locator) {
        if (locator === void 0) { locator = 'input'; }
        /** @type {?} */
        var placeHolderLocator = element(by.css(locator + "#" + fieldId)).getAttribute('placeholder');
        BrowserVisibility.waitUntilElementIsVisible(placeHolderLocator);
        return placeHolderLocator;
    };
    /**
     * @template THIS
     * @this {THIS}
     * @param {?} locator
     * @param {?} field
     * @param {?} val
     * @return {THIS}
     */
    FormFieldsPage.prototype.checkFieldValue = /**
     * @template THIS
     * @this {THIS}
     * @param {?} locator
     * @param {?} field
     * @param {?} val
     * @return {THIS}
     */
    function (locator, field, val) {
        BrowserVisibility.waitUntilElementHasValue(element(locator(field)), val);
        return (/** @type {?} */ (this));
    };
    /**
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    FormFieldsPage.prototype.refreshForm = /**
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    function () {
        BrowserVisibility.waitUntilElementIsVisible((/** @type {?} */ (this)).refreshButton);
        (/** @type {?} */ (this)).refreshButton.click();
        return (/** @type {?} */ (this));
    };
    /**
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    FormFieldsPage.prototype.saveForm = /**
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    function () {
        BrowserVisibility.waitUntilElementIsVisible((/** @type {?} */ (this)).saveButton);
        BrowserVisibility.waitUntilElementIsClickable((/** @type {?} */ (this)).saveButton);
        (/** @type {?} */ (this)).saveButton.click();
        return (/** @type {?} */ (this));
    };
    /**
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    FormFieldsPage.prototype.noFormIsDisplayed = /**
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    function () {
        BrowserVisibility.waitUntilElementIsNotOnPage((/** @type {?} */ (this)).formContent);
        return (/** @type {?} */ (this));
    };
    /**
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    FormFieldsPage.prototype.checkFormIsDisplayed = /**
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    function () {
        BrowserVisibility.waitUntilElementIsVisible((/** @type {?} */ (this)).formContent);
        return (/** @type {?} */ (this));
    };
    /**
     * @return {?}
     */
    FormFieldsPage.prototype.getNoFormMessage = /**
     * @return {?}
     */
    function () {
        BrowserVisibility.waitUntilElementIsVisible(this.noFormMessage);
        return this.noFormMessage.getText();
    };
    /**
     * @return {?}
     */
    FormFieldsPage.prototype.getCompletedTaskNoFormMessage = /**
     * @return {?}
     */
    function () {
        BrowserVisibility.waitUntilElementIsVisible(this.completedTaskNoFormMessage);
        return this.completedTaskNoFormMessage.getText();
    };
    /**
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    FormFieldsPage.prototype.clickOnAttachFormButton = /**
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    function () {
        BrowserVisibility.waitUntilElementIsVisible((/** @type {?} */ (this)).attachFormButton);
        (/** @type {?} */ (this)).attachFormButton.click();
        return (/** @type {?} */ (this));
    };
    /**
     * @template THIS
     * @this {THIS}
     * @param {?} formName
     * @return {THIS}
     */
    FormFieldsPage.prototype.selectForm = /**
     * @template THIS
     * @this {THIS}
     * @param {?} formName
     * @return {THIS}
     */
    function (formName) {
        BrowserVisibility.waitUntilElementIsVisible((/** @type {?} */ (this)).selectFormDropDownArrow);
        (/** @type {?} */ (this)).selectFormDropDownArrow.click();
        BrowserVisibility.waitUntilElementIsVisible((/** @type {?} */ (this)).selectFormContent);
        (/** @type {?} */ (this)).selectFormFromDropDown(formName);
        return (/** @type {?} */ (this));
    };
    /**
     * @param {?} formName
     * @return {?}
     */
    FormFieldsPage.prototype.selectFormFromDropDown = /**
     * @param {?} formName
     * @return {?}
     */
    function (formName) {
        /** @type {?} */
        var formNameElement = element(by.cssContainingText('span', formName));
        BrowserVisibility.waitUntilElementIsVisible(formNameElement);
        formNameElement.click();
    };
    /**
     * @param {?} fieldId
     * @return {?}
     */
    FormFieldsPage.prototype.checkWidgetIsReadOnlyMode = /**
     * @param {?} fieldId
     * @return {?}
     */
    function (fieldId) {
        /** @type {?} */
        var widget = element(by.css("adf-form-field div[id='field-" + fieldId + "-container']"));
        /** @type {?} */
        var widgetReadOnly = widget.element(by.css('div[class*="adf-readonly"]'));
        BrowserVisibility.waitUntilElementIsVisible(widgetReadOnly);
        return widgetReadOnly;
    };
    /**
     * @return {?}
     */
    FormFieldsPage.prototype.completeForm = /**
     * @return {?}
     */
    function () {
        BrowserVisibility.waitUntilElementIsVisible(this.completeButton);
        return this.completeButton.click();
    };
    /**
     * @template THIS
     * @this {THIS}
     * @param {?} fieldId
     * @param {?} value
     * @return {THIS}
     */
    FormFieldsPage.prototype.setValueInInputById = /**
     * @template THIS
     * @this {THIS}
     * @param {?} fieldId
     * @param {?} value
     * @return {THIS}
     */
    function (fieldId, value) {
        /** @type {?} */
        var input = element(by.id(fieldId));
        BrowserVisibility.waitUntilElementIsVisible(input);
        input.clear().sendKeys(value);
        return (/** @type {?} */ (this));
    };
    /**
     * @return {?}
     */
    FormFieldsPage.prototype.isCompleteFormButtonDisabled = /**
     * @return {?}
     */
    function () {
        BrowserVisibility.waitUntilElementIsVisible(this.completeButton);
        return this.completeButton.getAttribute('disabled');
    };
    return FormFieldsPage;
}());
export { FormFieldsPage };
if (false) {
    /** @type {?} */
    FormFieldsPage.prototype.formContent;
    /** @type {?} */
    FormFieldsPage.prototype.refreshButton;
    /** @type {?} */
    FormFieldsPage.prototype.saveButton;
    /** @type {?} */
    FormFieldsPage.prototype.valueLocator;
    /** @type {?} */
    FormFieldsPage.prototype.labelLocator;
    /** @type {?} */
    FormFieldsPage.prototype.noFormMessage;
    /** @type {?} */
    FormFieldsPage.prototype.completedTaskNoFormMessage;
    /** @type {?} */
    FormFieldsPage.prototype.attachFormButton;
    /** @type {?} */
    FormFieldsPage.prototype.selectFormDropDownArrow;
    /** @type {?} */
    FormFieldsPage.prototype.selectFormContent;
    /** @type {?} */
    FormFieldsPage.prototype.completeButton;
    /** @type {?} */
    FormFieldsPage.prototype.errorMessage;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZm9ybS1maWVsZHMucGFnZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BhbGZyZXNjby9hZGYtdGVzdGluZy8iLCJzb3VyY2VzIjpbImxpYi9wcm9jZXNzLXNlcnZpY2VzL3BhZ2VzL2Zvcm0tZmllbGRzLnBhZ2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFpQkEsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0scUNBQXFDLENBQUM7QUFDeEUsT0FBTyxFQUFFLEVBQUUsRUFBRSxPQUFPLEVBQUUsTUFBTSxZQUFZLENBQUM7QUFFekM7SUFBQTtRQUVJLGdCQUFXLEdBQUcsT0FBTyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQztRQUMxQyxrQkFBYSxHQUFHLE9BQU8sQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLDJDQUEyQyxDQUFDLENBQUMsQ0FBQztRQUM3RSxlQUFVLEdBQUcsT0FBTyxDQUFDLEVBQUUsQ0FBQyxpQkFBaUIsQ0FBQyx5Q0FBeUMsRUFBRSxNQUFNLENBQUMsQ0FBQyxDQUFDO1FBQzlGLGlCQUFZLEdBQUcsRUFBRSxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUMvQixpQkFBWSxHQUFHLEVBQUUsQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDL0Isa0JBQWEsR0FBRyxPQUFPLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyw2QkFBNkIsQ0FBQyxDQUFDLENBQUM7UUFDL0QsK0JBQTBCLEdBQUcsT0FBTyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMscUNBQXFDLENBQUMsQ0FBQyxDQUFDO1FBQ3BGLHFCQUFnQixHQUFHLE9BQU8sQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLGdDQUFnQyxDQUFDLENBQUMsQ0FBQztRQUNwRSw0QkFBdUIsR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsZ0RBQWdELENBQUMsQ0FBQyxD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S0FBSyxHQUFRLE9BQU8sQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQzFDLGlCQUFpQixDQUFDLHlCQUF5QixDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ25ELEtBQUssQ0FBQyxLQUFLLEVBQUUsQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDOUIsT0FBTyxtQkFBQSxJQUFJLEVBQUEsQ0FBQztJQUNoQixDQUFDOzs7O0lBRUQscURBQTRCOzs7SUFBNUI7UUFDSSxpQkFBaUIsQ0FBQyx5QkFBeUIsQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUM7UUFDakUsT0FBTyxJQUFJLENBQUMsY0FBYyxDQUFDLFlBQVksQ0FBQyxVQUFVLENBQUMsQ0FBQztJQUN4RCxDQUFDO0lBQ0wscUJBQUM7QUFBRCxDQUFDLEFBcEpELElBb0pDOzs7O0lBbEpHLHFDQUEwQzs7SUFDMUMsdUNBQTZFOztJQUM3RSxvQ0FBOEY7O0lBQzlGLHNDQUErQjs7SUFDL0Isc0NBQStCOztJQUMvQix1Q0FBK0Q7O0lBQy9ELG9EQUFvRjs7SUFDcEYsMENBQW9FOztJQUNwRSxpREFBd0c7O0lBQ3hHLDJDQUFzRTs7SUFDdEUsd0NBQXFEOztJQUNyRCxzQ0FBbUUiLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOSBBbGZyZXNjbyBTb2Z0d2FyZSwgTHRkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBCcm93c2VyVmlzaWJpbGl0eSB9IGZyb20gJy4uLy4uL2NvcmUvdXRpbHMvYnJvd3Nlci12aXNpYmlsaXR5JztcbmltcG9ydCB7IGJ5LCBlbGVtZW50IH0gZnJvbSAncHJvdHJhY3Rvcic7XG5cbmV4cG9ydCBjbGFzcyBGb3JtRmllbGRzUGFnZSB7XG5cbiAgICBmb3JtQ29udGVudCA9IGVsZW1lbnQoYnkuY3NzKCdhZGYtZm9ybScpKTtcbiAgICByZWZyZXNoQnV0dG9uID0gZWxlbWVudChieS5jc3MoJ2RpdltjbGFzcyo9XCJmb3JtLXJlbG9hZC1idXR0b25cIl0gbWF0LWljb24nKSk7XG4gICAgc2F2ZUJ1dHRvbiA9IGVsZW1lbnQoYnkuY3NzQ29udGFpbmluZ1RleHQoJ21hdC1jYXJkLWFjdGlvbnNbY2xhc3MqPVwiYWRmLWZvclwiXSBzcGFuJywgJ1NBVkUnKSk7XG4gICAgdmFsdWVMb2NhdG9yID0gYnkuY3NzKCdpbnB1dCcpO1xuICAgIGxhYmVsTG9jYXRvciA9IGJ5LmNzcygnbGFiZWwnKTtcbiAgICBub0Zvcm1NZXNzYWdlID0gZWxlbWVudChieS5jc3MoJ3NwYW5baWQqPVwibm8tZm9ybS1tZXNzYWdlXCJdJykpO1xuICAgIGNvbXBsZXRlZFRhc2tOb0Zvcm1NZXNzYWdlID0gZWxlbWVudChieS5jc3MoJ2RpdltpZCo9XCJjb21wbGV0ZWQtZm9ybS1tZXNzYWdlXCJdIHAnKSk7XG4gICAgYXR0YWNoRm9ybUJ1dHRvbiA9IGVsZW1lbnQoYnkuaWQoJ2FkZi1uby1mb3JtLWF0dGFjaC1mb3JtLWJ1dHRvbicpKTtcbiAgICBzZWxlY3RGb3JtRHJvcERvd25BcnJvdyA9IGVsZW1lbnQuYWxsKGJ5LmNzcygnYWRmLWF0dGFjaC1mb3JtIGRpdltjbGFzcyo9XCJtYXQtc2VsZWN0LWFycm93XCJdJykpLmZpcnN0KCk7XG4gICAgc2VsZWN0Rm9ybUNvbnRlbnQgPSBlbGVtZW50KGJ5LmNzcygnZGl2W2NsYXNzKj1cIm1hdC1zZWxlY3QtcGFuZWxcIl0nKSk7XG4gICAgY29tcGxldGVCdXR0b24gPSBlbGVtZW50KGJ5LmlkKCdhZGYtZm9ybS1jb21wbGV0ZScpKTtcbiAgICBlcnJvck1lc3NhZ2UgPSBieS5jc3MoJy5hZGYtZXJyb3ItdGV4dC1jb250YWluZXIgLmFkZi1lcnJvci10ZXh0Jyk7XG5cbiAgICBzZXRGaWVsZFZhbHVlKGxvY2F0b3IsIGZpZWxkLCB2YWx1ZSkge1xuICAgICAgICBjb25zdCBmaWVsZEVsZW1lbnQ6IGFueSA9IGVsZW1lbnQobG9jYXRvcihmaWVsZCkpO1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNWaXNpYmxlKGZpZWxkRWxlbWVudCk7XG4gICAgICAgIGZpZWxkRWxlbWVudC5jbGVhcigpLnNlbmRLZXlzKHZhbHVlKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgY2hlY2tXaWRnZXRJc1Zpc2libGUoZmllbGRJZCkge1xuICAgICAgICBjb25zdCBmaWVsZEVsZW1lbnQgPSBlbGVtZW50LmFsbChieS5jc3MoYGFkZi1mb3JtLWZpZWxkIGRpdltpZD0nZmllbGQtJHtmaWVsZElkfS1jb250YWluZXInXWApKS5maXJzdCgpO1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNWaXNpYmxlKGZpZWxkRWxlbWVudCk7XG4gICAgfVxuXG4gICAgY2hlY2tXaWRnZXRJc0hpZGRlbihmaWVsZElkKSB7XG4gICAgICAgIGNvbnN0IGhpZGRlbkVsZW1lbnQgPSBlbGVtZW50KGJ5LmNzcyhgYWRmLWZvcm0tZmllbGQgZGl2W2lkPSdmaWVsZC0ke2ZpZWxkSWR9LWNvbnRhaW5lciddW2hpZGRlbl1gKSk7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc1Zpc2libGUoaGlkZGVuRWxlbWVudCk7XG4gICAgfVxuXG4gICAgZ2V0V2lkZ2V0KGZpZWxkSWQpIHtcbiAgICAgICAgY29uc3Qgd2lkZ2V0ID0gZWxlbWVudChieS5jc3MoYGFkZi1mb3JtLWZpZWxkIGRpdltpZD0nZmllbGQtJHtmaWVsZElkfS1jb250YWluZXInXWApKTtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzVmlzaWJsZSh3aWRnZXQpO1xuICAgICAgICByZXR1cm4gd2lkZ2V0O1xuICAgIH1cblxuICAgIGdldEZpZWxkVmFsdWUoZmllbGRJZCwgdmFsdWVMb2NhdG9yUGFyYW0pIHtcbiAgICAgICAgY29uc3QgdmFsdWUgPSB0aGlzLmdldFdpZGdldChmaWVsZElkKS5lbGVtZW50KHZhbHVlTG9jYXRvclBhcmFtIHx8IHRoaXMudmFsdWVMb2NhdG9yKTtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzVmlzaWJsZSh2YWx1ZSk7XG4gICAgICAgIHJldHVybiB2YWx1ZS5nZXRBdHRyaWJ1dGUoJ3ZhbHVlJyk7XG4gICAgfVxuXG4gICAgZ2V0RmllbGRMYWJlbChmaWVsZElkLCBsYWJlbExvY2F0b3JQYXJhbSkge1xuICAgICAgICBjb25zdCBsYWJlbCA9IHRoaXMuZ2V0V2lkZ2V0KGZpZWxkSWQpLmFsbChsYWJlbExvY2F0b3JQYXJhbSB8fCB0aGlzLmxhYmVsTG9jYXRvcikuZmlyc3QoKTtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzVmlzaWJsZShsYWJlbCk7XG4gICAgICAgIHJldHVybiBsYWJlbC5nZXRUZXh0KCk7XG4gICAgfVxuXG4gICAgZ2V0RmllbGRFcnJvck1lc3NhZ2UoZmllbGRJZCkge1xuICAgICAgICBjb25zdCBlcnJvciA9IHRoaXMuZ2V0V2lkZ2V0KGZpZWxkSWQpLmVsZW1lbnQodGhpcy5lcnJvck1lc3NhZ2UpO1xuICAgICAgICByZXR1cm4gZXJyb3IuZ2V0VGV4dCgpO1xuICAgIH1cblxuICAgIGdldEZpZWxkVGV4dChmaWVsZElkLCBsYWJlbExvY2F0b3JQYXJhbSkge1xuICAgICAgICBjb25zdCBsYWJlbCA9IHRoaXMuZ2V0V2lkZ2V0KGZpZWxkSWQpLmVsZW1lbnQobGFiZWxMb2NhdG9yUGFyYW0gfHwgdGhpcy5sYWJlbExvY2F0b3IpO1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNWaXNpYmxlKGxhYmVsKTtcbiAgICAgICAgcmV0dXJuIGxhYmVsLmdldFRleHQoKTtcbiAgICB9XG5cbiAgICBnZXRGaWVsZFBsYWNlSG9sZGVyKGZpZWxkSWQsIGxvY2F0b3IgPSAnaW5wdXQnKSB7XG4gICAgICAgIGNvbnN0IHBsYWNlSG9sZGVyTG9jYXRvciA9IGVsZW1lbnQoYnkuY3NzKGAke2xvY2F0b3J9IyR7ZmllbGRJZH1gKSkuZ2V0QXR0cmlidXRlKCdwbGFjZWhvbGRlcicpO1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNWaXNpYmxlKHBsYWNlSG9sZGVyTG9jYXRvcik7XG4gICAgICAgIHJldHVybiBwbGFjZUhvbGRlckxvY2F0b3I7XG4gICAgfVxuXG4gICAgY2hlY2tGaWVsZFZhbHVlKGxvY2F0b3IsIGZpZWxkLCB2YWwpIHtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudEhhc1ZhbHVlKGVsZW1lbnQobG9jYXRvcihmaWVsZCkpLCB2YWwpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICByZWZyZXNoRm9ybSgpIHtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzVmlzaWJsZSh0aGlzLnJlZnJlc2hCdXR0b24pO1xuICAgICAgICB0aGlzLnJlZnJlc2hCdXR0b24uY2xpY2soKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgc2F2ZUZvcm0oKSB7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc1Zpc2libGUodGhpcy5zYXZlQnV0dG9uKTtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzQ2xpY2thYmxlKHRoaXMuc2F2ZUJ1dHRvbik7XG4gICAgICAgIHRoaXMuc2F2ZUJ1dHRvbi5jbGljaygpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICBub0Zvcm1Jc0Rpc3BsYXllZCgpIHtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzTm90T25QYWdlKHRoaXMuZm9ybUNvbnRlbnQpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICBjaGVja0Zvcm1Jc0Rpc3BsYXllZCgpIHtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzVmlzaWJsZSh0aGlzLmZvcm1Db250ZW50KTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgZ2V0Tm9Gb3JtTWVzc2FnZSgpIHtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzVmlzaWJsZSh0aGlzLm5vRm9ybU1lc3NhZ2UpO1xuICAgICAgICByZXR1cm4gdGhpcy5ub0Zvcm1NZXNzYWdlLmdldFRleHQoKTtcbiAgICB9XG5cbiAgICBnZXRDb21wbGV0ZWRUYXNrTm9Gb3JtTWVzc2FnZSgpIHtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzVmlzaWJsZSh0aGlzLmNvbXBsZXRlZFRhc2tOb0Zvcm1NZXNzYWdlKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29tcGxldGVkVGFza05vRm9ybU1lc3NhZ2UuZ2V0VGV4dCgpO1xuICAgIH1cblxuICAgIGNsaWNrT25BdHRhY2hGb3JtQnV0dG9uKCkge1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNWaXNpYmxlKHRoaXMuYXR0YWNoRm9ybUJ1dHRvbik7XG4gICAgICAgIHRoaXMuYXR0YWNoRm9ybUJ1dHRvbi5jbGljaygpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICBzZWxlY3RGb3JtKGZvcm1OYW1lKSB7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc1Zpc2libGUodGhpcy5zZWxlY3RGb3JtRHJvcERvd25BcnJvdyk7XG4gICAgICAgIHRoaXMuc2VsZWN0Rm9ybURyb3BEb3duQXJyb3cuY2xpY2soKTtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzVmlzaWJsZSh0aGlzLnNlbGVjdEZvcm1Db250ZW50KTtcbiAgICAgICAgdGhpcy5zZWxlY3RGb3JtRnJvbURyb3BEb3duKGZvcm1OYW1lKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgc2VsZWN0Rm9ybUZyb21Ecm9wRG93bihmb3JtTmFtZSkge1xuICAgICAgICBjb25zdCBmb3JtTmFtZUVsZW1lbnQgPSBlbGVtZW50KGJ5LmNzc0NvbnRhaW5pbmdUZXh0KCdzcGFuJywgZm9ybU5hbWUpKTtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzVmlzaWJsZShmb3JtTmFtZUVsZW1lbnQpO1xuICAgICAgICBmb3JtTmFtZUVsZW1lbnQuY2xpY2soKTtcbiAgICB9XG5cbiAgICBjaGVja1dpZGdldElzUmVhZE9ubHlNb2RlKGZpZWxkSWQpIHtcbiAgICAgICAgY29uc3Qgd2lkZ2V0ID0gZWxlbWVudChieS5jc3MoYGFkZi1mb3JtLWZpZWxkIGRpdltpZD0nZmllbGQtJHtmaWVsZElkfS1jb250YWluZXInXWApKTtcbiAgICAgICAgY29uc3Qgd2lkZ2V0UmVhZE9ubHkgPSB3aWRnZXQuZWxlbWVudChieS5jc3MoJ2RpdltjbGFzcyo9XCJhZGYtcmVhZG9ubHlcIl0nKSk7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc1Zpc2libGUod2lkZ2V0UmVhZE9ubHkpO1xuICAgICAgICByZXR1cm4gd2lkZ2V0UmVhZE9ubHk7XG4gICAgfVxuXG4gICAgY29tcGxldGVGb3JtKCkge1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNWaXNpYmxlKHRoaXMuY29tcGxldGVCdXR0b24pO1xuICAgICAgICByZXR1cm4gdGhpcy5jb21wbGV0ZUJ1dHRvbi5jbGljaygpO1xuICAgIH1cblxuICAgIHNldFZhbHVlSW5JbnB1dEJ5SWQoZmllbGRJZCwgdmFsdWUpIHtcbiAgICAgICAgY29uc3QgaW5wdXQ6IGFueSA9IGVsZW1lbnQoYnkuaWQoZmllbGRJZCkpO1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNWaXNpYmxlKGlucHV0KTtcbiAgICAgICAgaW5wdXQuY2xlYXIoKS5zZW5kS2V5cyh2YWx1ZSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIGlzQ29tcGxldGVGb3JtQnV0dG9uRGlzYWJsZWQoKSB7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc1Zpc2libGUodGhpcy5jb21wbGV0ZUJ1dHRvbik7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbXBsZXRlQnV0dG9uLmdldEF0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcbiAgICB9XG59XG4iXX0=