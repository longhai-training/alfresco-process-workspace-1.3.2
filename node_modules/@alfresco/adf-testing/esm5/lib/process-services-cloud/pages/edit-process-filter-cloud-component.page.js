/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
/*!
 * @license
 * Copyright 2019 Alfresco Software, Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
import { by, element, protractor } from 'protractor';
import { EditProcessFilterDialogPage } from './dialog/edit-process-filter-dialog.page';
import { BrowserVisibility } from '../../core/utils/browser-visibility';
var EditProcessFilterCloudComponentPage = /** @class */ (function () {
    function EditProcessFilterCloudComponentPage() {
        this.customiseFilter = element(by.id('adf-edit-process-filter-title-id'));
        this.selectedOption = element.all(by.css('mat-option[class*="mat-selected"]')).first();
        this.saveButton = element(by.css('button[data-automation-id="adf-filter-action-save"]'));
        this.saveAsButton = element(by.css('button[data-automation-id="adf-filter-action-saveAs"]'));
        this.deleteButton = element(by.css('button[data-automation-id="adf-filter-action-delete"]'));
        this.editProcessFilterDialogPage = new EditProcessFilterDialogPage();
    }
    /**
     * @return {?}
     */
    EditProcessFilterCloudComponentPage.prototype.editProcessFilterDialog = /**
     * @return {?}
     */
    function () {
        return this.editProcessFilterDialogPage;
    };
    /**
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    EditProcessFilterCloudComponentPage.prototype.clickCustomiseFilterHeader = /**
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    function () {
        BrowserVisibility.waitUntilElementIsVisible((/** @type {?} */ (this)).customiseFilter);
        (/** @type {?} */ (this)).customiseFilter.click();
        return (/** @type {?} */ (this));
    };
    /**
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    EditProcessFilterCloudComponentPage.prototype.checkCustomiseFilterHeaderIsExpanded = /**
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    function () {
        /** @type {?} */
        var expansionPanelExtended = element.all(by.css('mat-expansion-panel-header[class*="mat-expanded"]')).first();
        BrowserVisibility.waitUntilElementIsVisible(expansionPanelExtended);
        /** @type {?} */
        var content = element.all(by.css('div[class*="mat-expansion-panel-content "][style*="visible"]')).first();
        BrowserVisibility.waitUntilElementIsVisible(content);
        return (/** @type {?} */ (this));
    };
    /**
     * @template THIS
     * @this {THIS}
     * @param {?} option
     * @return {THIS}
     */
    EditProcessFilterCloudComponentPage.prototype.setStatusFilterDropDown = /**
     * @template THIS
     * @this {THIS}
     * @param {?} option
     * @return {THIS}
     */
    function (option) {
        (/** @type {?} */ (this)).clickOnDropDownArrow('status');
        /** @type {?} */
        var statusElement = element.all(by.cssContainingText('mat-option span', option)).first();
        BrowserVisibility.waitUntilElementIsClickable(statusElement);
        BrowserVisibility.waitUntilElementIsVisible(statusElement);
        statusElement.click();
        return (/** @type {?} */ (this));
    };
    /**
     * @return {?}
     */
    EditProcessFilterCloudComponentPage.prototype.getStateFilterDropDownValue = /**
     * @return {?}
     */
    function () {
        return element(by.css("mat-form-field[data-automation-id='status'] span")).getText();
    };
    /**
     * @template THIS
     * @this {THIS}
     * @param {?} option
     * @return {THIS}
     */
    EditProcessFilterCloudComponentPage.prototype.setSortFilterDropDown = /**
     * @template THIS
     * @this {THIS}
     * @param {?} option
     * @return {THIS}
     */
    function (option) {
        (/** @type {?} */ (this)).clickOnDropDownArrow('sort');
        /** @type {?} */
        var sortElement = element.all(by.cssContainingText('mat-option span', option)).first();
        BrowserVisibility.waitUntilElementIsClickable(sortElement);
        BrowserVisibility.waitUntilElementIsVisible(sortElement);
        sortElement.click();
        return (/** @type {?} */ (this));
    };
    /**
     * @return {?}
     */
    EditProcessFilterCloudComponentPage.prototype.getSortFilterDropDownValue = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var sortLocator = element.all(by.css("mat-form-field[data-automation-id='sort'] span")).first();
        BrowserVisibility.waitUntilElementIsVisible(sortLocator);
        return sortLocator.getText();
    };
    /**
     * @template THIS
     * @this {THIS}
     * @param {?} option
     * @return {THIS}
     */
    EditProcessFilterCloudComponentPage.prototype.setOrderFilterDropDown = /**
     * @template THIS
     * @this {THIS}
     * @param {?} option
     * @return {THIS}
     */
    function (option) {
        (/** @type {?} */ (this)).clickOnDropDownArrow('order');
        /** @type {?} */
        var orderElement = element.all(by.cssContainingText('mat-option span', option)).first();
        BrowserVisibility.waitUntilElementIsClickable(orderElement);
        BrowserVisibility.waitUntilElementIsVisible(orderElement);
        orderElement.click();
        return (/** @type {?} */ (this));
    };
    /**
     * @return {?}
     */
    EditProcessFilterCloudComponentPage.prototype.getOrderFilterDropDownValue = /**
     * @return {?}
     */
    function () {
        return element(by.css("mat-form-field[data-automation-id='order'] span")).getText();
    };
    /**
     * @param {?} option
     * @return {?}
     */
    EditProcessFilterCloudComponentPage.prototype.clickOnDropDownArrow = /**
     * @param {?} option
     * @return {?}
     */
    function (option) {
        /** @type {?} */
        var dropDownArrow = element.all(by.css("mat-form-field[data-automation-id='" + option + "'] div[class='mat-select-arrow-wrapper']")).first();
        BrowserVisibility.waitUntilElementIsVisible(dropDownArrow);
        BrowserVisibility.waitUntilElementIsClickable(dropDownArrow);
        dropDownArrow.click();
        BrowserVisibility.waitUntilElementIsVisible(this.selectedOption);
    };
    /**
     * @template THIS
     * @this {THIS}
     * @param {?} option
     * @return {THIS}
     */
    EditProcessFilterCloudComponentPage.prototype.setAppNameDropDown = /**
     * @template THIS
     * @this {THIS}
     * @param {?} option
     * @return {THIS}
     */
    function (option) {
        (/** @type {?} */ (this)).clickOnDropDownArrow('appName');
        /** @type {?} */
        var appNameElement = element.all(by.cssContainingText('mat-option span', option)).first();
        BrowserVisibility.waitUntilElementIsClickable(appNameElement);
        BrowserVisibility.waitUntilElementIsVisible(appNameElement);
        appNameElement.click();
        return (/** @type {?} */ (this));
    };
    /**
     * @return {?}
     */
    EditProcessFilterCloudComponentPage.prototype.checkAppNamesAreUnique = /**
     * @return {?}
     */
    function () {
        return tslib_1.__awaiter(this, void 0, void 0, function () {
            var appNameList, appTextList, uniqueArray;
            return tslib_1.__generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        appNameList = element.all(by.css('mat-option[data-automation-id="adf-cloud-edit-process-property-optionsappName"] span'));
                        return [4 /*yield*/, appNameList.getText()];
                    case 1:
                        appTextList = _a.sent();
                        uniqueArray = appTextList.filter((/**
                         * @param {?} appName
                         * @return {?}
                         */
                        function (appName) {
                            /** @type {?} */
                            var sameAppNameArray = appTextList.filter((/**
                             * @param {?} eachApp
                             * @return {?}
                             */
                            function (eachApp) { return eachApp === appName; }));
                            return sameAppNameArray.length === 1;
                        }));
                        return [2 /*return*/, uniqueArray.length === appTextList.length];
                }
            });
        });
    };
    /**
     * @return {?}
     */
    EditProcessFilterCloudComponentPage.prototype.getNumberOfAppNameOptions = /**
     * @return {?}
     */
    function () {
        this.clickOnDropDownArrow('appName');
        /** @type {?} */
        var dropdownOptions = element.all(by.css('.mat-select-panel mat-option'));
        return dropdownOptions.count();
    };
    /**
     * @template THIS
     * @this {THIS}
     * @param {?} option
     * @return {THIS}
     */
    EditProcessFilterCloudComponentPage.prototype.setProcessInstanceId = /**
     * @template THIS
     * @this {THIS}
     * @param {?} option
     * @return {THIS}
     */
    function (option) {
        return (/** @type {?} */ (this)).setProperty('processInstanceId', option);
    };
    /**
     * @return {?}
     */
    EditProcessFilterCloudComponentPage.prototype.getProcessInstanceId = /**
     * @return {?}
     */
    function () {
        return this.getProperty('processInstanceId');
    };
    /**
     * @param {?} property
     * @return {?}
     */
    EditProcessFilterCloudComponentPage.prototype.getProperty = /**
     * @param {?} property
     * @return {?}
     */
    function (property) {
        /** @type {?} */
        var locator = element.all(by.css('input[data-automation-id="adf-cloud-edit-process-property-' + property + '"]')).first();
        BrowserVisibility.waitUntilElementIsVisible(locator);
        return locator.getAttribute('value');
    };
    /**
     * @template THIS
     * @this {THIS}
     * @param {?} property
     * @param {?} option
     * @return {THIS}
     */
    EditProcessFilterCloudComponentPage.prototype.setProperty = /**
     * @template THIS
     * @this {THIS}
     * @param {?} property
     * @param {?} option
     * @return {THIS}
     */
    function (property, option) {
        /** @type {?} */
        var locator = element.all(by.css('input[data-automation-id="adf-cloud-edit-process-property-' + property + '"]')).first();
        BrowserVisibility.waitUntilElementIsVisible(locator);
        locator.clear();
        locator.sendKeys(option);
        locator.sendKeys(protractor.Key.ENTER);
        return (/** @type {?} */ (this));
    };
    /**
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    EditProcessFilterCloudComponentPage.prototype.checkSaveButtonIsDisplayed = /**
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    function () {
        BrowserVisibility.waitUntilElementIsVisible((/** @type {?} */ (this)).saveButton);
        return (/** @type {?} */ (this));
    };
    /**
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    EditProcessFilterCloudComponentPage.prototype.checkSaveAsButtonIsDisplayed = /**
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    function () {
        BrowserVisibility.waitUntilElementIsVisible((/** @type {?} */ (this)).saveAsButton);
        return (/** @type {?} */ (this));
    };
    /**
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    EditProcessFilterCloudComponentPage.prototype.checkDeleteButtonIsDisplayed = /**
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    function () {
        BrowserVisibility.waitUntilElementIsVisible((/** @type {?} */ (this)).deleteButton);
        return (/** @type {?} */ (this));
    };
    /**
     * @return {?}
     */
    EditProcessFilterCloudComponentPage.prototype.checkSaveButtonIsEnabled = /**
     * @return {?}
     */
    function () {
        BrowserVisibility.waitUntilElementIsVisible(this.saveButton);
        return this.saveButton.isEnabled();
    };
    /**
     * @return {?}
     */
    EditProcessFilterCloudComponentPage.prototype.checkSaveAsButtonIsEnabled = /**
     * @return {?}
     */
    function () {
        BrowserVisibility.waitUntilElementIsVisible(this.saveAsButton);
        return this.saveAsButton.isEnabled();
    };
    /**
     * @return {?}
     */
    EditProcessFilterCloudComponentPage.prototype.checkDeleteButtonIsEnabled = /**
     * @return {?}
     */
    function () {
        BrowserVisibility.waitUntilElementIsVisible(this.deleteButton);
        return this.deleteButton.isEnabled();
    };
    /**
     * @return {?}
     */
    EditProcessFilterCloudComponentPage.prototype.clickSaveAsButton = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var disabledButton = element(by.css(("button[data-automation-id='adf-filter-action-saveAs'][disabled]")));
        BrowserVisibility.waitUntilElementIsClickable(this.saveAsButton);
        BrowserVisibility.waitUntilElementIsVisible(this.saveAsButton);
        BrowserVisibility.waitUntilElementIsNotVisible(disabledButton);
        this.saveAsButton.click();
        return this.editProcessFilterDialogPage;
    };
    /**
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    EditProcessFilterCloudComponentPage.prototype.clickDeleteButton = /**
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    function () {
        BrowserVisibility.waitUntilElementIsVisible((/** @type {?} */ (this)).deleteButton);
        (/** @type {?} */ (this)).deleteButton.click();
        return (/** @type {?} */ (this));
    };
    /**
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    EditProcessFilterCloudComponentPage.prototype.clickSaveButton = /**
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    function () {
        /** @type {?} */
        var disabledButton = element(by.css(("button[id='adf-save-as-id'][disabled]")));
        BrowserVisibility.waitUntilElementIsClickable((/** @type {?} */ (this)).saveButton);
        BrowserVisibility.waitUntilElementIsVisible((/** @type {?} */ (this)).saveButton);
        BrowserVisibility.waitUntilElementIsNotVisible(disabledButton);
        (/** @type {?} */ (this)).saveButton.click();
        return (/** @type {?} */ (this));
    };
    return EditProcessFilterCloudComponentPage;
}());
export { EditProcessFilterCloudComponentPage };
if (false) {
    /** @type {?} */
    EditProcessFilterCloudComponentPage.prototype.customiseFilter;
    /** @type {?} */
    EditProcessFilterCloudComponentPage.prototype.selectedOption;
    /** @type {?} */
    EditProcessFilterCloudComponentPage.prototype.saveButton;
    /** @type {?} */
    EditProcessFilterCloudComponentPage.prototype.saveAsButton;
    /** @type {?} */
    EditProcessFilterCloudComponentPage.prototype.deleteButton;
    /** @type {?} */
    EditProcessFilterCloudComponentPage.prototype.editProcessFilterDialogPage;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZWRpdC1wcm9jZXNzLWZpbHRlci1jbG91ZC1jb21wb25lbnQucGFnZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BhbGZyZXNjby9hZGYtdGVzdGluZy8iLCJzb3VyY2VzIjpbImxpYi9wcm9jZXNzLXNlcnZpY2VzLWNsb3VkL3BhZ2VzL2VkaXQtcHJvY2Vzcy1maWx0ZXItY2xvdWQtY29tcG9uZW50LnBhZ2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBZ0JBLE9BQU8sRUFBRSxFQUFFLEVBQUUsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLFlBQVksQ0FBQztBQUNyRCxPQUFPLEVBQUUsMkJBQTJCLEVBQUUsTUFBTSwwQ0FBMEMsQ0FBQztBQUN2RixPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxxQ0FBcUMsQ0FBQztBQUV4RTtJQUFBO1FBRUksb0JBQWUsR0FBRyxPQUFPLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxrQ0FBa0MsQ0FBQyxDQUFDLENBQUM7UUFDckUsbUJBQWMsR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsbUNBQW1DLENBQUMsQ0FBQyxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ2xGLGVBQVUsR0FBRyxPQUFPLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxxREFBcUQsQ0FBQyxDQUFDLENBQUM7UUFDcEYsaUJBQVksR0FBRyxPQUFPLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyx1REFBdUQsQ0FBQyxDQUFDLENBQUM7UUFDeEYsaUJBQVksR0FBRyxPQUFPLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyx1REFBdUQsQ0FBQyxDQUFDLENBQUM7UUFFeEYsZ0NBQTJCLEdBQUcsSUFBSSwyQkFBMkIsRUFBRSxDQUFDO0lBOEtwRSxDQUFDOzs7O0lBNUtHLHFFQUF1Qjs7O0lBQXZCO1FBQ0ksT0FBTyxJQUFJLENBQUMsMkJBQTJCLENBQUM7SUFDNUMsQ0FBQzs7Ozs7O0lB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QUFBLElBQUksRUFBQSxDQUFDLFlBQVksQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUMxQixPQUFPLG1CQUFBLElBQUksRUFBQSxDQUFDO0lBQ2hCLENBQUM7Ozs7OztJQUVELDZEQUFlOzs7OztJQUFmOztZQUNVLGNBQWMsR0FBRyxPQUFPLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxDQUFDLHVDQUF1QyxDQUFDLENBQUMsQ0FBQztRQUNqRixpQkFBaUIsQ0FBQywyQkFBMkIsQ0FBQyxtQkFBQSxJQUFJLEVBQUEsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUMvRCxpQkFBaUIsQ0FBQyx5QkFBeUIsQ0FBQyxtQkFBQSxJQUFJLEVBQUEsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUM3RCxpQkFBaUIsQ0FBQyw0QkFBNEIsQ0FBQyxjQUFjLENBQUMsQ0FBQztRQUMvRCxtQkFBQSxJQUFJLEVBQUEsQ0FBQyxVQUFVLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDeEIsT0FBTyxtQkFBQSxJQUFJLEVBQUEsQ0FBQztJQUNoQixDQUFDO0lBQ0wsMENBQUM7QUFBRCxDQUFDLEFBdExELElBc0xDOzs7O0lBcExHLDhEQUFxRTs7SUFDckUsNkRBQWtGOztJQUNsRix5REFBb0Y7O0lBQ3BGLDJEQUF3Rjs7SUFDeEYsMkRBQXdGOztJQUV4RiwwRUFBZ0UiLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOSBBbGZyZXNjbyBTb2Z0d2FyZSwgTHRkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuaW1wb3J0IHsgYnksIGVsZW1lbnQsIHByb3RyYWN0b3IgfSBmcm9tICdwcm90cmFjdG9yJztcbmltcG9ydCB7IEVkaXRQcm9jZXNzRmlsdGVyRGlhbG9nUGFnZSB9IGZyb20gJy4vZGlhbG9nL2VkaXQtcHJvY2Vzcy1maWx0ZXItZGlhbG9nLnBhZ2UnO1xuaW1wb3J0IHsgQnJvd3NlclZpc2liaWxpdHkgfSBmcm9tICcuLi8uLi9jb3JlL3V0aWxzL2Jyb3dzZXItdmlzaWJpbGl0eSc7XG5cbmV4cG9ydCBjbGFzcyBFZGl0UHJvY2Vzc0ZpbHRlckNsb3VkQ29tcG9uZW50UGFnZSB7XG5cbiAgICBjdXN0b21pc2VGaWx0ZXIgPSBlbGVtZW50KGJ5LmlkKCdhZGYtZWRpdC1wcm9jZXNzLWZpbHRlci10aXRsZS1pZCcpKTtcbiAgICBzZWxlY3RlZE9wdGlvbiA9IGVsZW1lbnQuYWxsKGJ5LmNzcygnbWF0LW9wdGlvbltjbGFzcyo9XCJtYXQtc2VsZWN0ZWRcIl0nKSkuZmlyc3QoKTtcbiAgICBzYXZlQnV0dG9uID0gZWxlbWVudChieS5jc3MoJ2J1dHRvbltkYXRhLWF1dG9tYXRpb24taWQ9XCJhZGYtZmlsdGVyLWFjdGlvbi1zYXZlXCJdJykpO1xuICAgIHNhdmVBc0J1dHRvbiA9IGVsZW1lbnQoYnkuY3NzKCdidXR0b25bZGF0YS1hdXRvbWF0aW9uLWlkPVwiYWRmLWZpbHRlci1hY3Rpb24tc2F2ZUFzXCJdJykpO1xuICAgIGRlbGV0ZUJ1dHRvbiA9IGVsZW1lbnQoYnkuY3NzKCdidXR0b25bZGF0YS1hdXRvbWF0aW9uLWlkPVwiYWRmLWZpbHRlci1hY3Rpb24tZGVsZXRlXCJdJykpO1xuXG4gICAgZWRpdFByb2Nlc3NGaWx0ZXJEaWFsb2dQYWdlID0gbmV3IEVkaXRQcm9jZXNzRmlsdGVyRGlhbG9nUGFnZSgpO1xuXG4gICAgZWRpdFByb2Nlc3NGaWx0ZXJEaWFsb2coKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVkaXRQcm9jZXNzRmlsdGVyRGlhbG9nUGFnZTtcbiAgICB9XG5cbiAgICBjbGlja0N1c3RvbWlzZUZpbHRlckhlYWRlcigpIHtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzVmlzaWJsZSh0aGlzLmN1c3RvbWlzZUZpbHRlcik7XG4gICAgICAgIHRoaXMuY3VzdG9taXNlRmlsdGVyLmNsaWNrKCk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIGNoZWNrQ3VzdG9taXNlRmlsdGVySGVhZGVySXNFeHBhbmRlZCgpIHtcbiAgICAgICAgY29uc3QgZXhwYW5zaW9uUGFuZWxFeHRlbmRlZCA9IGVsZW1lbnQuYWxsKGJ5LmNzcygnbWF0LWV4cGFuc2lvbi1wYW5lbC1oZWFkZXJbY2xhc3MqPVwibWF0LWV4cGFuZGVkXCJdJykpLmZpcnN0KCk7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc1Zpc2libGUoZXhwYW5zaW9uUGFuZWxFeHRlbmRlZCk7XG4gICAgICAgIGNvbnN0IGNvbnRlbnQgPSBlbGVtZW50LmFsbChieS5jc3MoJ2RpdltjbGFzcyo9XCJtYXQtZXhwYW5zaW9uLXBhbmVsLWNvbnRlbnQgXCJdW3N0eWxlKj1cInZpc2libGVcIl0nKSkuZmlyc3QoKTtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzVmlzaWJsZShjb250ZW50KTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgc2V0U3RhdHVzRmlsdGVyRHJvcERvd24ob3B0aW9uKSB7XG4gICAgICAgIHRoaXMuY2xpY2tPbkRyb3BEb3duQXJyb3coJ3N0YXR1cycpO1xuXG4gICAgICAgIGNvbnN0IHN0YXR1c0VsZW1lbnQgPSBlbGVtZW50LmFsbChieS5jc3NDb250YWluaW5nVGV4dCgnbWF0LW9wdGlvbiBzcGFuJywgb3B0aW9uKSkuZmlyc3QoKTtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzQ2xpY2thYmxlKHN0YXR1c0VsZW1lbnQpO1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNWaXNpYmxlKHN0YXR1c0VsZW1lbnQpO1xuICAgICAgICBzdGF0dXNFbGVtZW50LmNsaWNrKCk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIGdldFN0YXRlRmlsdGVyRHJvcERvd25WYWx1ZSgpIHtcbiAgICAgICAgcmV0dXJuIGVsZW1lbnQoYnkuY3NzKFwibWF0LWZvcm0tZmllbGRbZGF0YS1hdXRvbWF0aW9uLWlkPSdzdGF0dXMnXSBzcGFuXCIpKS5nZXRUZXh0KCk7XG4gICAgfVxuXG4gICAgc2V0U29ydEZpbHRlckRyb3BEb3duKG9wdGlvbikge1xuICAgICAgICB0aGlzLmNsaWNrT25Ecm9wRG93bkFycm93KCdzb3J0Jyk7XG5cbiAgICAgICAgY29uc3Qgc29ydEVsZW1lbnQgPSBlbGVtZW50LmFsbChieS5jc3NDb250YWluaW5nVGV4dCgnbWF0LW9wdGlvbiBzcGFuJywgb3B0aW9uKSkuZmlyc3QoKTtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzQ2xpY2thYmxlKHNvcnRFbGVtZW50KTtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzVmlzaWJsZShzb3J0RWxlbWVudCk7XG4gICAgICAgIHNvcnRFbGVtZW50LmNsaWNrKCk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIGdldFNvcnRGaWx0ZXJEcm9wRG93blZhbHVlKCkge1xuICAgICAgICBjb25zdCBzb3J0TG9jYXRvciA9IGVsZW1lbnQuYWxsKGJ5LmNzcyhcIm1hdC1mb3JtLWZpZWxkW2RhdGEtYXV0b21hdGlvbi1pZD0nc29ydCddIHNwYW5cIikpLmZpcnN0KCk7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc1Zpc2libGUoc29ydExvY2F0b3IpO1xuICAgICAgICByZXR1cm4gc29ydExvY2F0b3IuZ2V0VGV4dCgpO1xuICAgIH1cblxuICAgIHNldE9yZGVyRmlsdGVyRHJvcERvd24ob3B0aW9uKSB7XG4gICAgICAgIHRoaXMuY2xpY2tPbkRyb3BEb3duQXJyb3coJ29yZGVyJyk7XG5cbiAgICAgICAgY29uc3Qgb3JkZXJFbGVtZW50ID0gZWxlbWVudC5hbGwoYnkuY3NzQ29udGFpbmluZ1RleHQoJ21hdC1vcHRpb24gc3BhbicsIG9wdGlvbikpLmZpcnN0KCk7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc0NsaWNrYWJsZShvcmRlckVsZW1lbnQpO1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNWaXNpYmxlKG9yZGVyRWxlbWVudCk7XG4gICAgICAgIG9yZGVyRWxlbWVudC5jbGljaygpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICBnZXRPcmRlckZpbHRlckRyb3BEb3duVmFsdWUoKSB7XG4gICAgICAgIHJldHVybiBlbGVtZW50KGJ5LmNzcyhcIm1hdC1mb3JtLWZpZWxkW2RhdGEtYXV0b21hdGlvbi1pZD0nb3JkZXInXSBzcGFuXCIpKS5nZXRUZXh0KCk7XG4gICAgfVxuXG4gICAgY2xpY2tPbkRyb3BEb3duQXJyb3cob3B0aW9uKSB7XG4gICAgICAgIGNvbnN0IGRyb3BEb3duQXJyb3cgPSBlbGVtZW50LmFsbChieS5jc3MoXCJtYXQtZm9ybS1maWVsZFtkYXRhLWF1dG9tYXRpb24taWQ9J1wiICsgb3B0aW9uICsgXCInXSBkaXZbY2xhc3M9J21hdC1zZWxlY3QtYXJyb3ctd3JhcHBlciddXCIpKS5maXJzdCgpO1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNWaXNpYmxlKGRyb3BEb3duQXJyb3cpO1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNDbGlja2FibGUoZHJvcERvd25BcnJvdyk7XG4gICAgICAgIGRyb3BEb3duQXJyb3cuY2xpY2soKTtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzVmlzaWJsZSh0aGlzLnNlbGVjdGVkT3B0aW9uKTtcbiAgICB9XG5cbiAgICBzZXRBcHBOYW1lRHJvcERvd24ob3B0aW9uKSB7XG4gICAgICAgIHRoaXMuY2xpY2tPbkRyb3BEb3duQXJyb3coJ2FwcE5hbWUnKTtcblxuICAgICAgICBjb25zdCBhcHBOYW1lRWxlbWVudCA9IGVsZW1lbnQuYWxsKGJ5LmNzc0NvbnRhaW5pbmdUZXh0KCdtYXQtb3B0aW9uIHNwYW4nLCBvcHRpb24pKS5maXJzdCgpO1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNDbGlja2FibGUoYXBwTmFtZUVsZW1lbnQpO1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNWaXNpYmxlKGFwcE5hbWVFbGVtZW50KTtcbiAgICAgICAgYXBwTmFtZUVsZW1lbnQuY2xpY2soKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgYXN5bmMgY2hlY2tBcHBOYW1lc0FyZVVuaXF1ZSgpIHtcbiAgICAgICAgY29uc3QgYXBwTmFtZUxpc3QgPSBlbGVtZW50LmFsbChieS5jc3MoJ21hdC1vcHRpb25bZGF0YS1hdXRvbWF0aW9uLWlkPVwiYWRmLWNsb3VkLWVkaXQtcHJvY2Vzcy1wcm9wZXJ0eS1vcHRpb25zYXBwTmFtZVwiXSBzcGFuJykpO1xuICAgICAgICBjb25zdCBhcHBUZXh0TGlzdDogYW55ID0gYXdhaXQgYXBwTmFtZUxpc3QuZ2V0VGV4dCgpO1xuICAgICAgICBjb25zdCB1bmlxdWVBcnJheSA9IGFwcFRleHRMaXN0LmZpbHRlcigoYXBwTmFtZSkgPT4ge1xuICAgICAgICAgICAgY29uc3Qgc2FtZUFwcE5hbWVBcnJheSA9IGFwcFRleHRMaXN0LmZpbHRlcigoZWFjaEFwcCkgPT4gZWFjaEFwcCA9PT0gYXBwTmFtZSk7XG4gICAgICAgICAgICByZXR1cm4gc2FtZUFwcE5hbWVBcnJheS5sZW5ndGggPT09IDE7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gdW5pcXVlQXJyYXkubGVuZ3RoID09PSBhcHBUZXh0TGlzdC5sZW5ndGg7XG4gICAgfVxuXG4gICAgZ2V0TnVtYmVyT2ZBcHBOYW1lT3B0aW9ucygpIHtcbiAgICAgICAgdGhpcy5jbGlja09uRHJvcERvd25BcnJvdygnYXBwTmFtZScpO1xuICAgICAgICBjb25zdCBkcm9wZG93bk9wdGlvbnMgPSBlbGVtZW50LmFsbChieS5jc3MoJy5tYXQtc2VsZWN0LXBhbmVsIG1hdC1vcHRpb24nKSk7XG4gICAgICAgIHJldHVybiBkcm9wZG93bk9wdGlvbnMuY291bnQoKTtcbiAgICB9XG5cbiAgICBzZXRQcm9jZXNzSW5zdGFuY2VJZChvcHRpb24pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2V0UHJvcGVydHkoJ3Byb2Nlc3NJbnN0YW5jZUlkJywgb3B0aW9uKTtcbiAgICB9XG5cbiAgICBnZXRQcm9jZXNzSW5zdGFuY2VJZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0UHJvcGVydHkoJ3Byb2Nlc3NJbnN0YW5jZUlkJyk7XG4gICAgfVxuXG4gICAgZ2V0UHJvcGVydHkocHJvcGVydHkpIHtcbiAgICAgICAgY29uc3QgbG9jYXRvciA9IGVsZW1lbnQuYWxsKGJ5LmNzcygnaW5wdXRbZGF0YS1hdXRvbWF0aW9uLWlkPVwiYWRmLWNsb3VkLWVkaXQtcHJvY2Vzcy1wcm9wZXJ0eS0nICsgcHJvcGVydHkgKyAnXCJdJykpLmZpcnN0KCk7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc1Zpc2libGUobG9jYXRvcik7XG4gICAgICAgIHJldHVybiBsb2NhdG9yLmdldEF0dHJpYnV0ZSgndmFsdWUnKTtcbiAgICB9XG5cbiAgICBzZXRQcm9wZXJ0eShwcm9wZXJ0eSwgb3B0aW9uKSB7XG4gICAgICAgIGNvbnN0IGxvY2F0b3IgPSBlbGVtZW50LmFsbChieS5jc3MoJ2lucHV0W2RhdGEtYXV0b21hdGlvbi1pZD1cImFkZi1jbG91ZC1lZGl0LXByb2Nlc3MtcHJvcGVydHktJyArIHByb3BlcnR5ICsgJ1wiXScpKS5maXJzdCgpO1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNWaXNpYmxlKGxvY2F0b3IpO1xuICAgICAgICBsb2NhdG9yLmNsZWFyKCk7XG4gICAgICAgIGxvY2F0b3Iuc2VuZEtleXMob3B0aW9uKTtcbiAgICAgICAgbG9jYXRvci5zZW5kS2V5cyhwcm90cmFjdG9yLktleS5FTlRFUik7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIGNoZWNrU2F2ZUJ1dHRvbklzRGlzcGxheWVkKCkge1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNWaXNpYmxlKHRoaXMuc2F2ZUJ1dHRvbik7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIGNoZWNrU2F2ZUFzQnV0dG9uSXNEaXNwbGF5ZWQoKSB7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc1Zpc2libGUodGhpcy5zYXZlQXNCdXR0b24pO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICBjaGVja0RlbGV0ZUJ1dHRvbklzRGlzcGxheWVkKCkge1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNWaXNpYmxlKHRoaXMuZGVsZXRlQnV0dG9uKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgY2hlY2tTYXZlQnV0dG9uSXNFbmFibGVkKCkge1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNWaXNpYmxlKHRoaXMuc2F2ZUJ1dHRvbik7XG4gICAgICAgIHJldHVybiB0aGlzLnNhdmVCdXR0b24uaXNFbmFibGVkKCk7XG4gICAgfVxuXG4gICAgY2hlY2tTYXZlQXNCdXR0b25Jc0VuYWJsZWQoKSB7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc1Zpc2libGUodGhpcy5zYXZlQXNCdXR0b24pO1xuICAgICAgICByZXR1cm4gdGhpcy5zYXZlQXNCdXR0b24uaXNFbmFibGVkKCk7XG4gICAgfVxuXG4gICAgY2hlY2tEZWxldGVCdXR0b25Jc0VuYWJsZWQoKSB7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc1Zpc2libGUodGhpcy5kZWxldGVCdXR0b24pO1xuICAgICAgICByZXR1cm4gdGhpcy5kZWxldGVCdXR0b24uaXNFbmFibGVkKCk7XG4gICAgfVxuXG4gICAgY2xpY2tTYXZlQXNCdXR0b24oKSB7XG4gICAgICAgIGNvbnN0IGRpc2FibGVkQnV0dG9uID0gZWxlbWVudChieS5jc3MoKFwiYnV0dG9uW2RhdGEtYXV0b21hdGlvbi1pZD0nYWRmLWZpbHRlci1hY3Rpb24tc2F2ZUFzJ11bZGlzYWJsZWRdXCIpKSk7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc0NsaWNrYWJsZSh0aGlzLnNhdmVBc0J1dHRvbik7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc1Zpc2libGUodGhpcy5zYXZlQXNCdXR0b24pO1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNOb3RWaXNpYmxlKGRpc2FibGVkQnV0dG9uKTtcbiAgICAgICAgdGhpcy5zYXZlQXNCdXR0b24uY2xpY2soKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZWRpdFByb2Nlc3NGaWx0ZXJEaWFsb2dQYWdlO1xuICAgIH1cblxuICAgIGNsaWNrRGVsZXRlQnV0dG9uKCkge1xuICAgICAgICBCcm93c2VyVmlzaWJpbGl0eS53YWl0VW50aWxFbGVtZW50SXNWaXNpYmxlKHRoaXMuZGVsZXRlQnV0dG9uKTtcbiAgICAgICAgdGhpcy5kZWxldGVCdXR0b24uY2xpY2soKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgY2xpY2tTYXZlQnV0dG9uKCkge1xuICAgICAgICBjb25zdCBkaXNhYmxlZEJ1dHRvbiA9IGVsZW1lbnQoYnkuY3NzKChcImJ1dHRvbltpZD0nYWRmLXNhdmUtYXMtaWQnXVtkaXNhYmxlZF1cIikpKTtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzQ2xpY2thYmxlKHRoaXMuc2F2ZUJ1dHRvbik7XG4gICAgICAgIEJyb3dzZXJWaXNpYmlsaXR5LndhaXRVbnRpbEVsZW1lbnRJc1Zpc2libGUodGhpcy5zYXZlQnV0dG9uKTtcbiAgICAgICAgQnJvd3NlclZpc2liaWxpdHkud2FpdFVudGlsRWxlbWVudElzTm90VmlzaWJsZShkaXNhYmxlZEJ1dHRvbik7XG4gICAgICAgIHRoaXMuc2F2ZUJ1dHRvbi5jbGljaygpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG59XG4iXX0=