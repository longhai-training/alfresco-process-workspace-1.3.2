/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/*!
 * @license
 * Copyright 2019 Alfresco Software, Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
import { browser, protractor } from 'protractor';
/** @type {?} */
var until = protractor.ExpectedConditions;
/** @type {?} */
var DEFAULT_TIMEOUT = global['TestConfig'] ? global['TestConfig'].main.timeout : 40000;
var BrowserVisibility = /** @class */ (function () {
    function BrowserVisibility() {
    }
    /*
     * Wait for element is visible
     */
    /*
         * Wait for element is visible
         */
    /**
     * @param {?} elementToCheck
     * @param {?=} waitTimeout
     * @return {?}
     */
    BrowserVisibility.waitUntilElementIsVisible = /*
         * Wait for element is visible
         */
    /**
     * @param {?} elementToCheck
     * @param {?=} waitTimeout
     * @return {?}
     */
    function (elementToCheck, waitTimeout) {
        if (waitTimeout === void 0) { waitTimeout = DEFAULT_TIMEOUT; }
        /** @type {?} */
        var isDisplayed = false;
        return browser.wait((/**
         * @return {?}
         */
        function () {
            browser.waitForAngularEnabled();
            elementToCheck.isDisplayed().then((/**
             * @return {?}
             */
            function () {
                isDisplayed = true;
            }), (/**
             * @return {?}
             */
            function () {
                isDisplayed = false;
            }));
            return isDisplayed;
        }), waitTimeout, 'Element is not visible ' + elementToCheck.locator());
    };
    /*
     * Wait for element to be clickable
     */
    /*
         * Wait for element to be clickable
         */
    /**
     * @param {?} elementToCheck
     * @param {?=} waitTimeout
     * @return {?}
     */
    BrowserVisibility.waitUntilElementIsClickable = /*
         * Wait for element to be clickable
         */
    /**
     * @param {?} elementToCheck
     * @param {?=} waitTimeout
     * @return {?}
     */
    function (elementToCheck, waitTimeout) {
        if (waitTimeout === void 0) { waitTimeout = DEFAULT_TIMEOUT; }
        /** @type {?} */
        var isDisplayed = false;
        return browser.wait((/**
         * @return {?}
         */
        function () {
            browser.waitForAngularEnabled();
            elementToCheck.isDisplayed().then((/**
             * @return {?}
             */
            function () {
                isDisplayed = true;
            }), (/**
             * @return {?}
             */
            function () {
                isDisplayed = false;
            }));
            return isDisplayed;
        }), waitTimeout, 'Element is not visible ' + elementToCheck.locator());
    };
    /*
   * Wait for element to not be visible
   */
    /*
       * Wait for element to not be visible
       */
    /**
     * @param {?} elementToCheck
     * @param {?=} waitTimeout
     * @return {?}
     */
    BrowserVisibility.waitUntilElementIsStale = /*
       * Wait for element to not be visible
       */
    /**
     * @param {?} elementToCheck
     * @param {?=} waitTimeout
     * @return {?}
     */
    function (elementToCheck, waitTimeout) {
        if (waitTimeout === void 0) { waitTimeout = DEFAULT_TIMEOUT; }
        return browser.wait(until.stalenessOf(elementToCheck), waitTimeout, 'Element is not in stale ' + elementToCheck.locator());
    };
    /*
     * Wait for element to not be visible
     */
    /*
         * Wait for element to not be visible
         */
    /**
     * @param {?} elementToCheck
     * @param {?=} waitTimeout
     * @return {?}
     */
    BrowserVisibility.waitUntilElementIsNotVisible = /*
         * Wait for element to not be visible
         */
    /**
     * @param {?} elementToCheck
     * @param {?=} waitTimeout
     * @return {?}
     */
    function (elementToCheck, waitTimeout) {
        if (waitTimeout === void 0) { waitTimeout = DEFAULT_TIMEOUT; }
        /** @type {?} */
        var isPresent = false;
        return browser.wait((/**
         * @return {?}
         */
        function () {
            browser.waitForAngularEnabled();
            elementToCheck.isPresent().then((/**
             * @param {?} present
             * @return {?}
             */
            function (present) {
                isPresent = !present;
            }));
            return isPresent;
        }), waitTimeout, 'Element is Visible and it should not' + elementToCheck.locator());
    };
    /*
     * Wait for element to have value
     */
    /*
         * Wait for element to have value
         */
    /**
     * @param {?} elementToCheck
     * @param {?} elementValue
     * @param {?=} waitTimeout
     * @return {?}
     */
    BrowserVisibility.waitUntilElementHasValue = /*
         * Wait for element to have value
         */
    /**
     * @param {?} elementToCheck
     * @param {?} elementValue
     * @param {?=} waitTimeout
     * @return {?}
     */
    function (elementToCheck, elementValue, waitTimeout) {
        if (waitTimeout === void 0) { waitTimeout = DEFAULT_TIMEOUT; }
        browser.waitForAngularEnabled();
        browser.wait(until.textToBePresentInElementValue(elementToCheck, elementValue), waitTimeout, 'Element doesn\'t have a value ' + elementToCheck.locator());
    };
    /**
     * @param {?} elementToCheck
     * @param {?=} waitTimeout
     * @return {?}
     */
    BrowserVisibility.waitUntilElementIsOnPage = /**
     * @param {?} elementToCheck
     * @param {?=} waitTimeout
     * @return {?}
     */
    function (elementToCheck, waitTimeout) {
        if (waitTimeout === void 0) { waitTimeout = DEFAULT_TIMEOUT; }
        return browser.wait(browser.wait(until.visibilityOf(elementToCheck)), waitTimeout);
    };
    /*
     * Wait for element to not be visible
     */
    /*
         * Wait for element to not be visible
         */
    /**
     * @param {?} elementToCheck
     * @param {?=} waitTimeout
     * @return {?}
     */
    BrowserVisibility.waitUntilElementIsNotOnPage = /*
         * Wait for element to not be visible
         */
    /**
     * @param {?} elementToCheck
     * @param {?=} waitTimeout
     * @return {?}
     */
    function (elementToCheck, waitTimeout) {
        if (waitTimeout === void 0) { waitTimeout = DEFAULT_TIMEOUT; }
        return browser.wait(until.not(until.visibilityOf(elementToCheck)), waitTimeout, 'Element is not in the page ' + elementToCheck.locator());
    };
    /**
     * @param {?} elementToCheck
     * @param {?=} waitTimeout
     * @return {?}
     */
    BrowserVisibility.waitUntilElementIsPresent = /**
     * @param {?} elementToCheck
     * @param {?=} waitTimeout
     * @return {?}
     */
    function (elementToCheck, waitTimeout) {
        if (waitTimeout === void 0) { waitTimeout = DEFAULT_TIMEOUT; }
        browser.waitForAngularEnabled();
        return browser.wait(until.presenceOf(elementToCheck), waitTimeout, 'Element is not present ' + elementToCheck.locator());
    };
    /**
     * @param {?} elementToCheck
     * @param {?=} waitTimeout
     * @return {?}
     */
    BrowserVisibility.waitUntilElementIsNotPresent = /**
     * @param {?} elementToCheck
     * @param {?=} waitTimeout
     * @return {?}
     */
    function (elementToCheck, waitTimeout) {
        if (waitTimeout === void 0) { waitTimeout = DEFAULT_TIMEOUT; }
        return browser.wait(until.not(until.presenceOf(elementToCheck)), waitTimeout, 'Element is not in the page ' + elementToCheck.locator());
    };
    return BrowserVisibility;
}());
export { BrowserVisibility };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnJvd3Nlci12aXNpYmlsaXR5LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGFsZnJlc2NvL2FkZi10ZXN0aW5nLyIsInNvdXJjZXMiOlsibGliL2NvcmUvdXRpbHMvYnJvd3Nlci12aXNpYmlsaXR5LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBaUJBLE9BQU8sRUFBRSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sWUFBWSxDQUFDOztJQUUzQyxLQUFLLEdBQUcsVUFBVSxDQUFDLGtCQUFrQjs7SUFDckMsZUFBZSxHQUFHLE1BQU0sQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLFlBQVksQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEtBQUs7QUFFeEY7SUFBQTtJQWdHQSxDQUFDO0lBOUZHOztPQUVHOzs7Ozs7Ozs7SUFDSSwyQ0FBeUI7Ozs7Ozs7O0lBQWhDLFVBQWlDLGNBQWMsRUFBRSxXQUFxQztRQUFyQyw0QkFBQSxFQUFBLDZCQUFxQzs7WUFDOUUsV0FBVyxHQUFHLEtBQUs7UUFDdkIsT0FBTyxPQUFPLENBQUMsSUFBSTs7O1FBQUM7WUFDaEIsT0FBTyxDQUFDLHFCQUFxQixFQUFFLENBQUM7WUFFaEMsY0FBYyxDQUFDLFdBQVcsRUFBRSxDQUFDLElBQUk7OztZQUM3QjtnQkFDSSxXQUFXLEdBQUcsSUFBSSxDQUFDO1lBQ3ZCLENBQUM7OztZQUNEO2dCQUNJLFdBQVcsR0FBRyxLQUFLLENBQUM7WUFDeEIsQ0FBQyxFQUNKLENBQUM7WUFDRixPQUFPLFdBQVcsQ0FBQztRQUN2QixDQUFDLEdBQUUsV0FBVyxFQUFFLHlCQUF5QixHQUFHLGNBQWMsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFDO0lBQzFFLENBQUM7SUFFRDs7T0FFRzs7Ozs7Ozs7O0lBQ0ksNkNBQTJCOzs7Ozs7OztJQUFsQyxVQUFtQyxjQUFjLEVBQUUsV0FBcUM7UUFBckMsNEJBQUEsRUFBQSw2QkFB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RUFBRSxXQUFXLEVBQUUseUJBQXlCLEdBQUcsY0FBYyxDQUFDLE9BQU8sRUFBRSxDQUFDLENBQUM7SUFDN0gsQ0FBQzs7Ozs7O0lBRU0sOENBQTRCOzs7OztJQUFuQyxVQUFvQyxjQUFjLEVBQUUsV0FBcUM7UUFBckMsNEJBQUEsRUFBQSw2QkFBcUM7UUFDckYsT0FBTyxPQUFPLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLFVBQVUsQ0FBQyxjQUFjLENBQUMsQ0FBQyxFQUFFLFdBQVcsRUFBRSw2QkFBNkIsR0FBRyxjQUFjLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQztJQUM1SSxDQUFDO0lBRUwsd0JBQUM7QUFBRCxDQUFDLEFBaEdELElBZ0dDIiwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgQWxmcmVzY28gU29mdHdhcmUsIEx0ZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHsgYnJvd3NlciwgcHJvdHJhY3RvciB9IGZyb20gJ3Byb3RyYWN0b3InO1xuXG5jb25zdCB1bnRpbCA9IHByb3RyYWN0b3IuRXhwZWN0ZWRDb25kaXRpb25zO1xuY29uc3QgREVGQVVMVF9USU1FT1VUID0gZ2xvYmFsWydUZXN0Q29uZmlnJ10gPyBnbG9iYWxbJ1Rlc3RDb25maWcnXS5tYWluLnRpbWVvdXQgOiA0MDAwMDtcblxuZXhwb3J0IGNsYXNzIEJyb3dzZXJWaXNpYmlsaXR5IHtcblxuICAgIC8qXG4gICAgICogV2FpdCBmb3IgZWxlbWVudCBpcyB2aXNpYmxlXG4gICAgICovXG4gICAgc3RhdGljIHdhaXRVbnRpbEVsZW1lbnRJc1Zpc2libGUoZWxlbWVudFRvQ2hlY2ssIHdhaXRUaW1lb3V0OiBudW1iZXIgPSBERUZBVUxUX1RJTUVPVVQpIHtcbiAgICAgICAgbGV0IGlzRGlzcGxheWVkID0gZmFsc2U7XG4gICAgICAgIHJldHVybiBicm93c2VyLndhaXQoKCkgPT4ge1xuICAgICAgICAgICAgYnJvd3Nlci53YWl0Rm9yQW5ndWxhckVuYWJsZWQoKTtcblxuICAgICAgICAgICAgZWxlbWVudFRvQ2hlY2suaXNEaXNwbGF5ZWQoKS50aGVuKFxuICAgICAgICAgICAgICAgICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaXNEaXNwbGF5ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpc0Rpc3BsYXllZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICByZXR1cm4gaXNEaXNwbGF5ZWQ7XG4gICAgICAgIH0sIHdhaXRUaW1lb3V0LCAnRWxlbWVudCBpcyBub3QgdmlzaWJsZSAnICsgZWxlbWVudFRvQ2hlY2subG9jYXRvcigpKTtcbiAgICB9XG5cbiAgICAvKlxuICAgICAqIFdhaXQgZm9yIGVsZW1lbnQgdG8gYmUgY2xpY2thYmxlXG4gICAgICovXG4gICAgc3RhdGljIHdhaXRVbnRpbEVsZW1lbnRJc0NsaWNrYWJsZShlbGVtZW50VG9DaGVjaywgd2FpdFRpbWVvdXQ6IG51bWJlciA9IERFRkFVTFRfVElNRU9VVCkge1xuICAgICAgICBsZXQgaXNEaXNwbGF5ZWQgPSBmYWxzZTtcbiAgICAgICAgcmV0dXJuIGJyb3dzZXIud2FpdCgoKSA9PiB7XG4gICAgICAgICAgICBicm93c2VyLndhaXRGb3JBbmd1bGFyRW5hYmxlZCgpO1xuXG4gICAgICAgICAgICBlbGVtZW50VG9DaGVjay5pc0Rpc3BsYXllZCgpLnRoZW4oXG4gICAgICAgICAgICAgICAgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpc0Rpc3BsYXllZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlzRGlzcGxheWVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHJldHVybiBpc0Rpc3BsYXllZDtcbiAgICAgICAgfSwgd2FpdFRpbWVvdXQsICdFbGVtZW50IGlzIG5vdCB2aXNpYmxlICcgKyBlbGVtZW50VG9DaGVjay5sb2NhdG9yKCkpO1xuICAgIH1cblxuICAgIC8qXG4gICAqIFdhaXQgZm9yIGVsZW1lbnQgdG8gbm90IGJlIHZpc2libGVcbiAgICovXG4gICAgc3RhdGljIHdhaXRVbnRpbEVsZW1lbnRJc1N0YWxlKGVsZW1lbnRUb0NoZWNrLCB3YWl0VGltZW91dDogbnVtYmVyID0gREVGQVVMVF9USU1FT1VUKSB7XG4gICAgICAgIHJldHVybiBicm93c2VyLndhaXQodW50aWwuc3RhbGVuZXNzT2YoZWxlbWVudFRvQ2hlY2spLCB3YWl0VGltZW91dCwgJ0VsZW1lbnQgaXMgbm90IGluIHN0YWxlICcgKyBlbGVtZW50VG9DaGVjay5sb2NhdG9yKCkpO1xuICAgIH1cblxuICAgIC8qXG4gICAgICogV2FpdCBmb3IgZWxlbWVudCB0byBub3QgYmUgdmlzaWJsZVxuICAgICAqL1xuICAgIHN0YXRpYyB3YWl0VW50aWxFbGVtZW50SXNOb3RWaXNpYmxlKGVsZW1lbnRUb0NoZWNrLCB3YWl0VGltZW91dDogbnVtYmVyID0gREVGQVVMVF9USU1FT1VUKSB7XG4gICAgICAgIGxldCBpc1ByZXNlbnQgPSBmYWxzZTtcbiAgICAgICAgcmV0dXJuIGJyb3dzZXIud2FpdCgoKSA9PiB7XG4gICAgICAgICAgICBicm93c2VyLndhaXRGb3JBbmd1bGFyRW5hYmxlZCgpO1xuXG4gICAgICAgICAgICBlbGVtZW50VG9DaGVjay5pc1ByZXNlbnQoKS50aGVuKFxuICAgICAgICAgICAgICAgIChwcmVzZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlzUHJlc2VudCA9ICFwcmVzZW50O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICByZXR1cm4gaXNQcmVzZW50O1xuICAgICAgICB9LCB3YWl0VGltZW91dCwgJ0VsZW1lbnQgaXMgVmlzaWJsZSBhbmQgaXQgc2hvdWxkIG5vdCcgKyBlbGVtZW50VG9DaGVjay5sb2NhdG9yKCkpO1xuICAgIH1cblxuICAgIC8qXG4gICAgICogV2FpdCBmb3IgZWxlbWVudCB0byBoYXZlIHZhbHVlXG4gICAgICovXG4gICAgc3RhdGljIHdhaXRVbnRpbEVsZW1lbnRIYXNWYWx1ZShlbGVtZW50VG9DaGVjaywgZWxlbWVudFZhbHVlLCB3YWl0VGltZW91dDogbnVtYmVyID0gREVGQVVMVF9USU1FT1VUKSB7XG4gICAgICAgIGJyb3dzZXIud2FpdEZvckFuZ3VsYXJFbmFibGVkKCk7XG5cbiAgICAgICAgYnJvd3Nlci53YWl0KHVudGlsLnRleHRUb0JlUHJlc2VudEluRWxlbWVudFZhbHVlKGVsZW1lbnRUb0NoZWNrLCBlbGVtZW50VmFsdWUpLCB3YWl0VGltZW91dCwgJ0VsZW1lbnQgZG9lc25cXCd0IGhhdmUgYSB2YWx1ZSAnICsgZWxlbWVudFRvQ2hlY2subG9jYXRvcigpKTtcbiAgICB9XG5cbiAgICBzdGF0aWMgd2FpdFVudGlsRWxlbWVudElzT25QYWdlKGVsZW1lbnRUb0NoZWNrLCB3YWl0VGltZW91dDogbnVtYmVyID0gREVGQVVMVF9USU1FT1VUKSB7XG4gICAgICAgIHJldHVybiBicm93c2VyLndhaXQoYnJvd3Nlci53YWl0KHVudGlsLnZpc2liaWxpdHlPZihlbGVtZW50VG9DaGVjaykpLCB3YWl0VGltZW91dCk7XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiBXYWl0IGZvciBlbGVtZW50IHRvIG5vdCBiZSB2aXNpYmxlXG4gICAgICovXG4gICAgc3RhdGljIHdhaXRVbnRpbEVsZW1lbnRJc05vdE9uUGFnZShlbGVtZW50VG9DaGVjaywgd2FpdFRpbWVvdXQ6IG51bWJlciA9IERFRkFVTFRfVElNRU9VVCkge1xuICAgICAgICByZXR1cm4gYnJvd3Nlci53YWl0KHVudGlsLm5vdCh1bnRpbC52aXNpYmlsaXR5T2YoZWxlbWVudFRvQ2hlY2spKSwgd2FpdFRpbWVvdXQsICdFbGVtZW50IGlzIG5vdCBpbiB0aGUgcGFnZSAnICsgZWxlbWVudFRvQ2hlY2subG9jYXRvcigpKTtcbiAgICB9XG5cbiAgICBzdGF0aWMgd2FpdFVudGlsRWxlbWVudElzUHJlc2VudChlbGVtZW50VG9DaGVjaywgd2FpdFRpbWVvdXQ6IG51bWJlciA9IERFRkFVTFRfVElNRU9VVCkge1xuICAgICAgICBicm93c2VyLndhaXRGb3JBbmd1bGFyRW5hYmxlZCgpO1xuXG4gICAgICAgIHJldHVybiBicm93c2VyLndhaXQodW50aWwucHJlc2VuY2VPZihlbGVtZW50VG9DaGVjayksIHdhaXRUaW1lb3V0LCAnRWxlbWVudCBpcyBub3QgcHJlc2VudCAnICsgZWxlbWVudFRvQ2hlY2subG9jYXRvcigpKTtcbiAgICB9XG5cbiAgICBzdGF0aWMgd2FpdFVudGlsRWxlbWVudElzTm90UHJlc2VudChlbGVtZW50VG9DaGVjaywgd2FpdFRpbWVvdXQ6IG51bWJlciA9IERFRkFVTFRfVElNRU9VVCkge1xuICAgICAgICByZXR1cm4gYnJvd3Nlci53YWl0KHVudGlsLm5vdCh1bnRpbC5wcmVzZW5jZU9mKGVsZW1lbnRUb0NoZWNrKSksIHdhaXRUaW1lb3V0LCAnRWxlbWVudCBpcyBub3QgaW4gdGhlIHBhZ2UgJyArIGVsZW1lbnRUb0NoZWNrLmxvY2F0b3IoKSk7XG4gICAgfVxuXG59XG4iXX0=