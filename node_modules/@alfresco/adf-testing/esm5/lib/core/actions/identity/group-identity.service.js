/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
/*!
 * @license
 * Copyright 2019 Alfresco Software, Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
import { StringUtil } from '../../utils/string.util';
var GroupIdentityService = /** @class */ (function () {
    function GroupIdentityService(api) {
        this.api = api;
    }
    /**
     * @param {?=} groupName
     * @return {?}
     */
    GroupIdentityService.prototype.createIdentityGroup = /**
     * @param {?=} groupName
     * @return {?}
     */
    function (groupName) {
        if (groupName === void 0) { groupName = StringUtil.generateRandomString(5); }
        return tslib_1.__awaiter(this, void 0, void 0, function () {
            var group;
            return tslib_1.__generator(this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.createGroup(groupName)];
                    case 1:
                        _a.sent();
                        return [4 /*yield*/, this.getGroupInfoByGroupName(groupName)];
                    case 2:
                        group = _a.sent();
                        return [2 /*return*/, group];
                }
            });
        });
    };
    /**
     * @param {?} groupId
     * @return {?}
     */
    GroupIdentityService.prototype.deleteIdentityGroup = /**
     * @param {?} groupId
     * @return {?}
     */
    function (groupId) {
        return tslib_1.__awaiter(this, void 0, void 0, function () {
            return tslib_1.__generator(this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.deleteGroup(groupId)];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    /**
     * @param {?} groupName
     * @return {?}
     */
    GroupIdentityService.prototype.createGroup = /**
     * @param {?} groupName
     * @return {?}
     */
    function (groupName) {
        return tslib_1.__awaiter(this, void 0, void 0, function () {
            var path, method, queryParams, postBody, data;
            return tslib_1.__generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        path = '/groups';
                        method = 'POST';
                        queryParams = {};
                        postBody = {
                            'name': groupName + 'TestGroup'
                        };
                        return [4 /*yield*/, this.api.performIdentityOperation(path, method, queryParams, postBody)];
                    case 1:
                        data = _a.sent();
                        return [2 /*return*/, data];
                }
            });
        });
    };
    /**
     * @param {?} groupId
     * @return {?}
     */
    GroupIdentityService.prototype.deleteGroup = /**
     * @param {?} groupId
     * @return {?}
     */
    function (groupId) {
        return tslib_1.__awaiter(this, void 0, void 0, function () {
            var path, method, queryParams, postBody, data;
            return tslib_1.__generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        path = "/groups/" + groupId;
                        method = 'DELETE';
                        queryParams = {};
                        postBody = {};
                        return [4 /*yield*/, this.api.performIdentityOperation(path, method, queryParams, postBody)];
                    case 1:
                        data = _a.sent();
                        return [2 /*return*/, data];
                }
            });
        });
    };
    /**
     * @param {?} groupName
     * @return {?}
     */
    GroupIdentityService.prototype.getGroupInfoByGroupName = /**
     * @param {?} groupName
     * @return {?}
     */
    function (groupName) {
        return tslib_1.__awaiter(this, void 0, void 0, function () {
            var path, method, queryParams, postBody, data;
            return tslib_1.__generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        path = "/groups";
                        method = 'GET';
                        queryParams = { 'search': groupName };
                        postBody = {};
                        return [4 /*yield*/, this.api.performIdentityOperation(path, method, queryParams, postBody)];
                    case 1:
                        data = _a.sent();
                        return [2 /*return*/, data[0]];
                }
            });
        });
    };
    /**
     * @param {?} groupId
     * @param {?} roleId
     * @param {?} roleName
     * @return {?}
     */
    GroupIdentityService.prototype.assignRole = /**
     * @param {?} groupId
     * @param {?} roleId
     * @param {?} roleName
     * @return {?}
     */
    function (groupId, roleId, roleName) {
        return tslib_1.__awaiter(this, void 0, void 0, function () {
            var path, method, queryParams, postBody, data;
            return tslib_1.__generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        path = "/groups/" + groupId + "/role-mappings/realm";
                        method = 'POST';
                        queryParams = {};
                        postBody = [{ 'id': roleId, 'name': roleName }];
                        return [4 /*yield*/, this.api.performIdentityOperation(path, method, queryParams, postBody)];
                    case 1:
                        data = _a.sent();
                        return [2 /*return*/, data];
                }
            });
        });
    };
    /**
     * Add client roles.
     * @param groupId ID of the target group
     * @param clientId ID of the client
     * @param roleId ID of the clientRole
     * @param roleName of the clientRole
     */
    /**
     * Add client roles.
     * @param {?} groupId ID of the target group
     * @param {?} clientId ID of the client
     * @param {?} roleId ID of the clientRole
     * @param {?} roleName of the clientRole
     * @return {?}
     */
    GroupIdentityService.prototype.addClientRole = /**
     * Add client roles.
     * @param {?} groupId ID of the target group
     * @param {?} clientId ID of the client
     * @param {?} roleId ID of the clientRole
     * @param {?} roleName of the clientRole
     * @return {?}
     */
    function (groupId, clientId, roleId, roleName) {
        return tslib_1.__awaiter(this, void 0, void 0, function () {
            var path, method, queryParams, postBody, data;
            return tslib_1.__generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        path = "/groups/" + groupId + "/role-mappings/clients/" + clientId;
                        method = 'POST';
                        queryParams = {};
                        postBody = [{
                                'id': roleId,
                                'name': roleName,
                                'composite': false,
                                'clientRole': true,
                                'containerId': clientId
                            }];
                        return [4 /*yield*/, this.api.performIdentityOperation(path, method, queryParams, postBody)];
                    case 1:
                        data = _a.sent();
                        return [2 /*return*/, data];
                }
            });
        });
    };
    /**
     * Gets the client ID using the app name.
     * @param applicationName Name of the app
     * @returns client ID string
     */
    /**
     * Gets the client ID using the app name.
     * @param {?} applicationName Name of the app
     * @return {?} client ID string
     */
    GroupIdentityService.prototype.getClientIdByApplicationName = /**
     * Gets the client ID using the app name.
     * @param {?} applicationName Name of the app
     * @return {?} client ID string
     */
    function (applicationName) {
        return tslib_1.__awaiter(this, void 0, void 0, function () {
            var path, method, queryParams, postBody, data;
            return tslib_1.__generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        path = "/clients";
                        method = 'GET';
                        queryParams = { clientId: applicationName };
                        postBody = {};
                        return [4 /*yield*/, this.api.performIdentityOperation(path, method, queryParams, postBody)];
                    case 1:
                        data = _a.sent();
                        return [2 /*return*/, data[0].id];
                }
            });
        });
    };
    return GroupIdentityService;
}());
export { GroupIdentityService };
if (false) {
    /** @type {?} */
    GroupIdentityService.prototype.api;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ3JvdXAtaWRlbnRpdHkuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BhbGZyZXNjby9hZGYtdGVzdGluZy8iLCJzb3VyY2VzIjpbImxpYi9jb3JlL2FjdGlvbnMvaWRlbnRpdHkvZ3JvdXAtaWRlbnRpdHkuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFrQkEsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLHlCQUF5QixDQUFDO0FBRXJEO0lBSUksOEJBQVksR0FBZTtRQUN2QixJQUFJLENBQUMsR0FBRyxHQUFHLEdBQUcsQ0FBQztJQUNuQixDQUFDOzs7OztJQUVLLGtEQUFtQjs7OztJQUF6QixVQUEwQixTQUE4QztRQUE5QywwQkFBQSxFQUFBLFlBQVksVUFBVSxDQUFDLG9CQUFvQixDQUFDLENBQUMsQ0FBQzs7Ozs7NEJBQ3BFLHFCQUFNLElBQUksQ0FBQyxXQUFXLENBQUMsU0FBUyxDQUFDLEVBQUE7O3dCQUFqQyxTQUFpQyxDQUFDO3dCQUNwQixxQkFBTSxJQUFJLENBQUMsdUJBQXVCLENBQUMsU0FBUyxDQUFDLEVBQUE7O3dCQUFyRCxLQUFLLEdBQUcsU0FBNkM7d0JBQzNELHNCQUFPLEtBQUssRUFBQzs7OztLQUNoQjs7Ozs7SUFFSyxrREFBbUI7Ozs7SUFBekIsVUFBMEIsT0FBTzs7Ozs0QkFDN0IscUJBQU0sSUFBSSxDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUMsRUFBQTs7d0JBQS9CLFNBQStCLENBQUM7Ozs7O0tBQ25DOzs7OztJQUVLLDBDQUFXOzs7O0lBQWpCLFVBQWtCLFNBQVM7Ozs7Ozt3QkFDakIsSUFBSSxHQUFHLFNBQVM7d0JBQ2hCLE1BQU0sR0FBRyxNQUFNO3dCQUNmLFdBQVcsR0FBRyxFQUFFO3dCQUFFLFFBQVEsR0FBRzs0QkFDL0IsTUFBTSxFQUFFLFNBQVMsR0FBRyxXQUFXO3lCQUNsQzt3QkFDWSxxQkFBTSxJQUFJLENBQUMsR0FBRyxDQUFDLHdCQUF3QixDQUFD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LENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFDOzs7O0tBQ3JCO0lBRUwsMkJBQUM7QUFBRCxDQUFDLEFBMUZELElBMEZDOzs7O0lBeEZHLG1DQUFnQiIsInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEFsZnJlc2NvIFNvZnR3YXJlLCBMdGQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IEFwaVNlcnZpY2UgfSBmcm9tICcuLi9hcGkuc2VydmljZSc7XG5pbXBvcnQgeyBTdHJpbmdVdGlsIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3RyaW5nLnV0aWwnO1xuXG5leHBvcnQgY2xhc3MgR3JvdXBJZGVudGl0eVNlcnZpY2Uge1xuXG4gICAgYXBpOiBBcGlTZXJ2aWNlO1xuXG4gICAgY29uc3RydWN0b3IoYXBpOiBBcGlTZXJ2aWNlKSB7XG4gICAgICAgIHRoaXMuYXBpID0gYXBpO1xuICAgIH1cblxuICAgIGFzeW5jIGNyZWF0ZUlkZW50aXR5R3JvdXAoZ3JvdXBOYW1lID0gU3RyaW5nVXRpbC5nZW5lcmF0ZVJhbmRvbVN0cmluZyg1KSkge1xuICAgICAgICBhd2FpdCB0aGlzLmNyZWF0ZUdyb3VwKGdyb3VwTmFtZSk7XG4gICAgICAgIGNvbnN0IGdyb3VwID0gYXdhaXQgdGhpcy5nZXRHcm91cEluZm9CeUdyb3VwTmFtZShncm91cE5hbWUpO1xuICAgICAgICByZXR1cm4gZ3JvdXA7XG4gICAgfVxuXG4gICAgYXN5bmMgZGVsZXRlSWRlbnRpdHlHcm91cChncm91cElkKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuZGVsZXRlR3JvdXAoZ3JvdXBJZCk7XG4gICAgfVxuXG4gICAgYXN5bmMgY3JlYXRlR3JvdXAoZ3JvdXBOYW1lKSB7XG4gICAgICAgIGNvbnN0IHBhdGggPSAnL2dyb3Vwcyc7XG4gICAgICAgIGNvbnN0IG1ldGhvZCA9ICdQT1NUJztcbiAgICAgICAgY29uc3QgcXVlcnlQYXJhbXMgPSB7fSwgcG9zdEJvZHkgPSB7XG4gICAgICAgICAgICAnbmFtZSc6IGdyb3VwTmFtZSArICdUZXN0R3JvdXAnXG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCB0aGlzLmFwaS5wZXJmb3JtSWRlbnRpdHlPcGVyYXRpb24ocGF0aCwgbWV0aG9kLCBxdWVyeVBhcmFtcywgcG9zdEJvZHkpO1xuICAgICAgICByZXR1cm4gZGF0YTtcbiAgICB9XG5cbiAgICBhc3luYyBkZWxldGVHcm91cChncm91cElkKSB7XG4gICAgICAgIGNvbnN0IHBhdGggPSBgL2dyb3Vwcy8ke2dyb3VwSWR9YDtcbiAgICAgICAgY29uc3QgbWV0aG9kID0gJ0RFTEVURSc7XG4gICAgICAgIGNvbnN0IHF1ZXJ5UGFyYW1zID0ge30sIHBvc3RCb2R5ID0ge1xuICAgICAgICB9O1xuICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5hcGkucGVyZm9ybUlkZW50aXR5T3BlcmF0aW9uKHBhdGgsIG1ldGhvZCwgcXVlcnlQYXJhbXMsIHBvc3RCb2R5KTtcbiAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfVxuXG4gICAgYXN5bmMgZ2V0R3JvdXBJbmZvQnlHcm91cE5hbWUoZ3JvdXBOYW1lKSB7XG4gICAgICAgIGNvbnN0IHBhdGggPSBgL2dyb3Vwc2A7XG4gICAgICAgIGNvbnN0IG1ldGhvZCA9ICdHRVQnO1xuICAgICAgICBjb25zdCBxdWVyeVBhcmFtcyA9IHsgJ3NlYXJjaCcgOiBncm91cE5hbWUgfSwgcG9zdEJvZHkgPSB7fTtcblxuICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5hcGkucGVyZm9ybUlkZW50aXR5T3BlcmF0aW9uKHBhdGgsIG1ldGhvZCwgcXVlcnlQYXJhbXMsIHBvc3RCb2R5KTtcbiAgICAgICAgcmV0dXJuIGRhdGFbMF07XG4gICAgfVxuXG4gICAgYXN5bmMgYXNzaWduUm9sZShncm91cElkLCByb2xlSWQsIHJvbGVOYW1lKSB7XG4gICAgICAgIGNvbnN0IHBhdGggPSBgL2dyb3Vwcy8ke2dyb3VwSWR9L3JvbGUtbWFwcGluZ3MvcmVhbG1gO1xuICAgICAgICBjb25zdCBtZXRob2QgPSAnUE9TVCc7XG4gICAgICAgIGNvbnN0IHF1ZXJ5UGFyYW1zID0ge30sXG4gICAgICAgICAgICBwb3N0Qm9keSA9IFt7J2lkJzogcm9sZUlkLCAnbmFtZSc6IHJvbGVOYW1lfV07XG5cbiAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHRoaXMuYXBpLnBlcmZvcm1JZGVudGl0eU9wZXJhdGlvbihwYXRoLCBtZXRob2QsIHF1ZXJ5UGFyYW1zLCBwb3N0Qm9keSk7XG4gICAgICAgIHJldHVybiBkYXRhO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFkZCBjbGllbnQgcm9sZXMuXG4gICAgICogQHBhcmFtIGdyb3VwSWQgSUQgb2YgdGhlIHRhcmdldCBncm91cFxuICAgICAqIEBwYXJhbSBjbGllbnRJZCBJRCBvZiB0aGUgY2xpZW50XG4gICAgICogQHBhcmFtIHJvbGVJZCBJRCBvZiB0aGUgY2xpZW50Um9sZVxuICAgICAqIEBwYXJhbSByb2xlTmFtZSBvZiB0aGUgY2xpZW50Um9sZVxuICAgICAqL1xuICAgIGFzeW5jIGFkZENsaWVudFJvbGUoZ3JvdXBJZDogc3RyaW5nLCBjbGllbnRJZDogc3RyaW5nLCByb2xlSWQ6IHN0cmluZywgcm9sZU5hbWU6IHN0cmluZykge1xuICAgICAgICBjb25zdCBwYXRoID0gYC9ncm91cHMvJHtncm91cElkfS9yb2xlLW1hcHBpbmdzL2NsaWVudHMvJHtjbGllbnRJZH1gO1xuICAgICAgICBjb25zdCBtZXRob2QgPSAnUE9TVCcsIHF1ZXJ5UGFyYW1zID0ge30sXG4gICAgICAgICAgICBwb3N0Qm9keSA9IFt7XG4gICAgICAgICAgICAgICAgJ2lkJzogcm9sZUlkLFxuICAgICAgICAgICAgICAgICduYW1lJzogcm9sZU5hbWUsXG4gICAgICAgICAgICAgICAgJ2NvbXBvc2l0ZSc6IGZhbHNlLFxuICAgICAgICAgICAgICAgICdjbGllbnRSb2xlJzogdHJ1ZSxcbiAgICAgICAgICAgICAgICAnY29udGFpbmVySWQnOiBjbGllbnRJZFxuICAgICAgICAgICAgfV07XG4gICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCB0aGlzLmFwaS5wZXJmb3JtSWRlbnRpdHlPcGVyYXRpb24ocGF0aCwgbWV0aG9kLCBxdWVyeVBhcmFtcywgcG9zdEJvZHkpO1xuICAgICAgICByZXR1cm4gZGF0YTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBjbGllbnQgSUQgdXNpbmcgdGhlIGFwcCBuYW1lLlxuICAgICAqIEBwYXJhbSBhcHBsaWNhdGlvbk5hbWUgTmFtZSBvZiB0aGUgYXBwXG4gICAgICogQHJldHVybnMgY2xpZW50IElEIHN0cmluZ1xuICAgICAqL1xuICAgIGFzeW5jIGdldENsaWVudElkQnlBcHBsaWNhdGlvbk5hbWUoYXBwbGljYXRpb25OYW1lOiBzdHJpbmcpIHtcbiAgICAgICAgY29uc3QgcGF0aCA9IGAvY2xpZW50c2A7XG4gICAgICAgIGNvbnN0IG1ldGhvZCA9ICdHRVQnLCBxdWVyeVBhcmFtcyA9IHtjbGllbnRJZDogYXBwbGljYXRpb25OYW1lfSwgcG9zdEJvZHkgPSB7fTtcblxuICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5hcGkucGVyZm9ybUlkZW50aXR5T3BlcmF0aW9uKHBhdGgsIG1ldGhvZCwgcXVlcnlQYXJhbXMsIHBvc3RCb2R5KTtcbiAgICAgICAgcmV0dXJuIGRhdGFbMF0uaWQ7XG4gICAgfVxuXG59XG4iXX0=